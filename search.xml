<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[MATLAB Chapter-1 æ•°å­¦å»ºæ¨¡å¸¸è§„æ–¹æ³•]]></title>
    <url>%2F2019%2F07%2F31%2FMATLAB-Chapter-1-%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E5%B8%B8%E8%A7%84%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[æ–¹æ³•åç§°ï¼šå¸¸è§„æ–¹æ³• åœ¨æ•°å­¦å»ºæ¨¡ä¸­çš„åº”ç”¨åœºåˆï¼šæ•°æ®é¢„å¤„ç†ã€ç»˜åˆ¶å›¾å½¢ã€æ•°æ®é¢„æµ‹ MATLABä¸Žæ•°æ®æ–‡ä»¶çš„äº¤äº’ MATLABä¸ŽExcelçš„äº¤äº’ ä»ŽExcelè¯»å…¥æ•°æ®åˆ°MATLABä¸­ï¼š 1&gt;&gt; a = xlsread(&apos;filename.xlsx&apos;, 2, &apos;A1:B5&apos;) å…¶ä¸­ï¼Œxlsreadå‡½æ•°å¯å®žçŽ°åœ¨MATLABä¸­è¯»å…¥Excelæ•°æ®ï¼›'filename.xlsx'è¡¨ç¤ºè¯»å…¥æ•°æ®åˆ°Excelæ‰€åœ¨çš„è·¯å¾„ä»¥åŠExcelæ–‡ä»¶åç§°ï¼›2è¡¨ç¤ºä½äºŽsheet2ï¼›'A1:B5'è¡¨ç¤ºéœ€è¦è¯»å…¥æ•°æ®çš„èŒƒå›´ã€‚ å…¶æ¬¡ï¼Œæ˜¯ä»ŽMATLABå¾€Excelä¸­å†™å…¥æ•°æ®ï¼š 1&gt;&gt; xlsread(&apos;filename.xlsx&apos;, a, 3, &apos;B1:C5&apos;) å…¶ä¸­ï¼Œ'filename.xlsx'è¡¨ç¤ºå†™å…¥Excelå·¥ä½œç°¿æ‰€åœ¨çš„ä½ç½®ï¼Œå¦‚æžœæŒ‡å®šä½ç½®ä¸å­˜åœ¨æŒ‡å®šçš„Excelæ–‡ä»¶ï¼ŒMATLABä¼šè‡ªåŠ¨åˆ›å»ºå·¥ä½œç°¿ï¼›aè¡¨ç¤ºå¾…å†™å…¥çš„æ•°æ®ï¼›3è¡¨ç¤ºsheet3ï¼›'B1:C5'è¡¨ç¤ºå†™å…¥Excelä¸­çš„å…·ä½“ä½ç½®ã€‚ ä¸è¦åœ¨MATLABæ­£åœ¨è¯»å†™æ“ä½œçš„æ—¶å€™æ‰“å¼€Excelå·¥ä½œç°¿ï¼Œè¿™æ ·æœ‰å¯èƒ½ä½¿ç¨‹åºç»ˆæ­¢è¿è¡Œã€‚xlsreadå‡½æ•°å’Œxlswriteå‡½æ•°éžå¸¸å®žç”¨ï¼Œæ¯”å¦‚åœ¨æ•°å­¦å»ºæ¨¡ä¸­ç»å¸¸ä¼šç”¨åˆ°å¤§é‡æ•°æ®ï¼Œå¦‚æžœè¿™äº›æ•°æ®å…¨éƒ¨è´´åœ¨ç¨‹åºä¸­æ˜¾å¾—ä¸ç¾Žè§‚ä¹Ÿå½±å“å¯è¯»æ€§ï¼Œè€Œå­˜å‚¨åœ¨Excelå·¥ä½œç°¿ä¸­å°±æ˜¯ä¸€ä¸ªæžå¥½çš„åŠžæ³•ã€‚ MATLABä¸ŽTXTäº¤äº’ è¯»å…¥TXTæ–‡ä»¶ å¯ä»¥ä½¿ç”¨loadå‡½æ•°è¯»å…¥TXTæ–‡æœ¬æ–‡ä»¶å†…å®¹ï¼š 1load(&apos;*.txt&apos;) ä¾‹å¦‚ï¼Œåˆ©ç”¨loadå‡½æ•°å®Œæˆä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼š 123&gt;&gt; a = linspace(1, 30, 8);&gt;&gt; save exper.txt a -ascii;&gt;&gt; b = load(&apos;exper.txt&apos;) å…¶ä¸­ï¼Œsave exper.txt a -asciiç”¨æ¥æŠŠå˜é‡aä»¥ASCIIç å­˜å‚¨åœ¨exper.txtæ–‡ä»¶ä¸­ï¼Œå¦‚æžœä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºã€‚å¦‚æžœTXTæ–‡ä»¶ä¸­å­˜å‚¨äº†ä¸åŒç±»åž‹çš„å­—ç¬¦æˆ–è€…æ•°æ®ï¼Œåˆ†ç±»è¯»å–æ•°æ®å°±éœ€è¦ä½¿ç”¨textreadå‡½æ•°äº†ï¼Œtextreadå‡½æ•°è¯»å–ä¿¡æ¯çš„å¥½å¤„å°±æ˜¯å¯ä»¥åšåˆ°æŽ§åˆ¶è¾“å‡ºæ›´ç²¾å‡†ä»¥åŠä¸éœ€è¦ä½¿ç”¨fopenå‘½ä»¤æ‰“å¼€æ–‡ä»¶å°±å¯ä»¥ç›´æŽ¥è¯»å–ã€‚ 1[A, B, C, â€¦] = textread(&apos;filename&apos;, &apos;format&apos;, N, &apos;headerlines&apos;, M) å…¶ä¸­ï¼Œfilenameè¡¨ç¤ºéœ€è¦è¯»å…¥çš„txtæ–‡ä»¶åç§°ï¼›formatè¡¨ç¤ºè¯»å‡ºå˜é‡çš„å­—æ®µæ ¼å¼ï¼›Nè¡¨ç¤ºè¯»å–çš„æ¬¡æ•°ï¼Œæ¯ä¸€æ¬¡è¯»å–ä¸€è¡Œï¼›headerlinesè¡¨ç¤ºä»Žç¬¬M+1è¡Œå¼€å§‹è¯»å…¥ã€‚ä¾‹å¦‚ï¼š 1&gt;&gt; [name, type, x, y, answer] = textread(&apos;filename&apos;, &apos;%s Type %d %f %n %s&apos;, 2, &apos;headerlines&apos;, 1) å†™å…¥TXTæ–‡ä»¶å†…å®¹ fprintå‡½æ•°èƒ½æŠŠMATLABé‡Œçš„ä¿¡æ¯å†™å…¥åˆ°TXTä¸­ï¼Œå¯ä»¥æŽ§åˆ¶å†™å…¥åˆ°ç²¾åº¦ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ%6.2fè¡¨ç¤ºå†™å…¥TXTçš„æ•°æ®æ˜¯æµ®ç‚¹åž‹çš„ï¼Œè¾“å‡ºçš„å®½åº¦æ˜¯6ï¼Œç²¾ç¡®åˆ°å°æ•°ç‚¹2ä½ã€‚ 1234&gt;&gt; file_h = fopen(&apos;filename&apos;, &apos;w&apos;);&gt;&gt; fprint(file_h, &apos;%6.2f %12.8f&apos;, 3.14, 2.718);&gt;&gt; fprint(file_h, &apos;\n %6f %12f&apos;, 3.14, -2.718);&gt;&gt; fclose(file_h) å¦‚æžœåœ¨æŒ‡å®šä½ç½®æ‰¾ä¸åˆ°æŒ‡å®šæ–‡ä»¶ï¼ŒMATLABä¼šè‡ªåŠ¨åˆ›å»ºã€‚ æ•°æ®æ‹Ÿåˆæ–¹æ³• æ›²çº¿æ‹Ÿåˆä¹Ÿå«æ›²çº¿é€¼è¿‘ï¼Œä¸Žæ’å€¼å‡½æ•°æœ‰äº›åŒºåˆ«ï¼Œå…¶åªè¦æ±‚æ‹Ÿåˆçš„æ›²çº¿èƒ½åˆç†åœ°åæ˜ æ•°æ®çš„åŸºæœ¬è¶‹åŠ¿ï¼Œå¹¶ä¸è¦æ±‚æ›²çº¿ä¸€å®šé€šè¿‡æ•°æ®ç‚¹ã€‚æ›²çº¿æ‹Ÿåˆæœ‰å‡ ç§ä¸åŒçš„åˆ¤åˆ«å‡†åˆ™ï¼Œå¦‚ä½¿åå·®çš„ç»å¯¹å€¼ä¹‹å’Œæœ€å°ã€ä½¿åå·®çš„æœ€å¤§ç»å¯¹å€¼æœ€å°å’Œä½¿åå·®çš„å¹³æ–¹å’Œæœ€å°ï¼ˆæœ€å°äºŒä¹˜æ³•ï¼‰ã€‚å¸¸ç”¨çš„æ–¹æ³•æ˜¯æœ€å°äºŒä¹˜æ³•ã€‚ å¤šé¡¹å¼æ‹Ÿåˆ å°†æ•°æ®ç‚¹æŒ‰å¤šé¡¹å¼çš„å½¢å¼è¿›è¡Œæ‹Ÿåˆï¼Œä½¿ç”¨æœ€å°äºŒä¹˜æ³•ï¼Œå¯ä»¥ç¡®å®šå¤šé¡¹å¼çš„ç³»æ•°ã€‚ å¤šé¡¹å¼æ‹ŸåˆæŒ‡ä»¤ polyfit(X, Y, N)ï¼šå¤šé¡¹å¼æ‹Ÿåˆï¼Œè¿”å›žé™å¹‚æŽ’åˆ—çš„å¤šé¡¹å¼ç³»æ•°ã€‚ polyval(P, XI)ï¼šè®¡ç®—å¤šé¡¹å¼çš„å€¼ã€‚ å…¶ä¸­ï¼ŒXã€Yæ˜¯æ•°æ®ç‚¹çš„å€¼ï¼›Næ˜¯æ‹Ÿåˆçš„æœ€é«˜æ¬¡å¹‚ï¼›Pæ˜¯è¿”å›žçš„å¤šé¡¹å¼ç³»æ•°ï¼›XIæ˜¯è¦æ±‚çš„ç‚¹çš„æ¨ªåæ ‡ã€‚ä¾‹å¦‚ï¼š 123456x = [1 2 3 4 5 6 7 8 9];y = [9 7 6 3 -1 2 5 7 20];P = polyfit(x, y, 3);xi = 0:.2:10; % å–å€¼0ï½ž10ï¼Œä¸­é—´é—´è·0.2yi = polyval(P, xi);plot(xi, yi, x, y, &apos;r*&apos;); å¾—åˆ°çš„æ‹Ÿåˆæ›²çº¿ä¸ŽåŽŸå§‹æ•°æ®çš„å¯¹ç…§å¦‚å›¾ï¼š å¹¶éžæ‹Ÿåˆæ¬¡æ•°è¶Šé«˜å°±è¶Šç²¾ç¡®ï¼Œæœ‰äº›ç‚¹æ•°æ®åå·®è¾ƒå¤§ï¼Œæ‹Ÿåˆæ¬¡æ•°é«˜ï¼Œç²¾ç¡®åº¦åè€Œä¸‹é™ã€‚ å›¾å½¢çª—å£çš„å¤šé¡¹å¼æ‹Ÿåˆ åœ¨å›¾å½¢çª—å£ä¸­å¯ä»¥ç”¨èœå•æ–¹å¼å¯¹æ•°æ®è¿›è¡Œç®€å•å¿«é€Ÿé«˜æ•ˆçš„æ‹Ÿåˆã€‚å…ˆç”»å‡ºæ•°æ®ç‚¹ï¼š 123&gt;&gt; x = [1 2 3 4 5 6 7 8 9];&gt;&gt; y = [9 7 6 3 -1 2 5 7 20];&gt;&gt; plot(x, y, &apos;r*&apos;); ç„¶åŽåœ¨å›¾å½¢çª—å£ï¼Œå•å‡»â€œå·¥å…·â€ -&gt; â€œåŸºæœ¬æ‹Ÿåˆâ€ï¼Œæ‰“å¼€å¯¹è¯æ¡†ï¼Œè¿›è¡Œæ‹Ÿåˆã€‚ æŒ‡å®šå‡½æ•°æ‹Ÿåˆ åœ¨MATLABä¸­ä¹Ÿå¯ä»¥ç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°è¿›è¡Œæ‹Ÿåˆã€‚ä¾‹å¦‚ï¼š åœ¨MATLABä¸­ç”»å‡ºæ•£ç‚¹å›¾ï¼š 123x = [0; 0.4; 1.2; 2; 2.8; 3.6; 4.4; 5.2; 6; 7.2; 8; 9.2; 10.4; 11.6; 12.4; 13.6; 14.4; 15];y = [1; 0.85; 0.29; -0.27; -0.53; -0.4; -0.12; 0.17; 0.28; 0.15; -0.03; -0.15; -0.071; 0.059; 0.08; 0.032; -0.015; -0.02];plot(x, y, &apos;r*&apos;); çŸ¥é“å…¶å¯¹åº”çš„å‡½æ•°å½¢å¼ä¸º\(f(t)=a\cos(kt)e^{wt}\)ï¼Œåˆ™å¯ä»¥ç”¨MATLABè¿›è¡Œæ‹Ÿåˆï¼š 12345678syms tx = [0; 0.4; 1.2; 2; 2.8; 3.6; 4.4; 5.2; 6; 7.2; 8; 9.2; 10.4; 11.6; 12.4; 13.6; 14.4; 15];y = [1; 0.85; 0.29; -0.27; -0.53; -0.4; -0.12; 0.17; 0.28; 0.15; -0.03; -0.15; -0.071; 0.059; 0.08; 0.032; -0.015; -0.02];f = fittype(&apos;a * cos(k * t) * exp(w * t)&apos;, &apos;independent&apos;, &apos;t&apos;, &apos;coefficients&apos;, &#123;&apos;a&apos;, &apos;k&apos;, &apos;w&apos;&#125;);cfun = fit(x, y, f) % æ˜¾ç¤ºæ‹Ÿåˆå‡½æ•°xi = 0:.1:20;yi = cfun(xi);plot(x, y, &apos;r*&apos;, xi, yi, &apos;b-&apos;); è¿è¡Œç¨‹åºï¼Œç»“æžœå¦‚ä¸‹ï¼š 123456789101112è­¦å‘Š: Start point not provided, choosing random start point. &gt; In curvefit.attention.Warning/throw (line 30) In fit&gt;iFit (line 307) In fit (line 116) In demo (line 5) cfun = General model: cfun(t) = a * cos(k * t) * exp(w * t) Coefficients (with 95% confidence bounds): a = 0.9987 (0.9835, 1.014) k = 1.001 (0.9958, 1.006) w = -0.2066 (-0.2131, -0.2002) ç¨‹åºä¸­ï¼Œfittypeæ˜¯è‡ªå®šä¹‰æ‹Ÿåˆå‡½æ•°ï¼›cfun(x, y, f)æ˜¯æ ¹æ®è‡ªå®šä¹‰çš„æ‹Ÿåˆå‡½æ•°fæ¥æ‹Ÿåˆæ•°æ®x,yã€‚æ³¨æ„ï¼šæ­¤å¤„æ•°æ®å¿…é¡»ä¸ºåˆ—å‘é‡å½¢å¼ã€‚ command windowé‡Œç»™å‡ºäº†Warningï¼Œæ˜¯ç”±a,k,wä¸‰ä¸ªå‚æ•°çš„åˆå§‹å€¼æœªç»™å‡ºå¯¼è‡´çš„ï¼Œå› æ­¤å¦‚æžœæ‹Ÿåˆç»“æžœä¸ç†æƒ³ï¼Œå¯ä»¥å¤šè¿è¡Œå‡ æ¬¡ã€‚ æ›²çº¿æ‹Ÿåˆå·¥å…·ç®± åœ¨command windowé‡Œç›´æŽ¥è¾“å…¥cftoolå‘½ä»¤æ‰“å¼€ã€‚ æ›²çº¿æ‹Ÿåˆå·¥å…·ç®±ä¸­åŒ…å«äº†å„ç§å¸¸ç”¨çš„æ•°æ®æ‹Ÿåˆæ–¹æ³•ï¼Œå¯ä»¥å¯¹å„ç§å‡½æ•°è¿›è¡Œæ‹Ÿåˆï¼Œå…·ä½“æ“ä½œæ–¹æ³•å‚è€ƒhelpã€‚ æ•°æ®æ‹Ÿåˆåº”ç”¨å®žä¾‹ äººå£é¢„æµ‹æ¨¡åž‹ ä¸‹è¡¨æ‰€åˆ—æ˜¯æŸåœ°åŒº1971-2000å¹´çš„äººå£æ•°æ®ï¼Œè¯•ç»™å‡ºè¯¥åœ°åŒºäººå£å¢žé•¿çš„æ•°å­¦æ¨¡åž‹ã€‚ å¹´ä»½ æ—¶é—´å˜é‡ t=å¹´ä»½-1970 äººå£ y/äºº å¹´ä»½ æ—¶é—´å˜é‡ t=å¹´ä»½-1970 äººå£ y/äºº 1971 1 33815 1986 16 34520 1972 2 33981 1987 17 34507 1973 3 34004 1988 18 34509 1974 4 34165 1989 19 34521 1975 5 34212 1990 20 34513 1976 6 34327 1991 21 34515 1977 7 34344 1992 22 34517 1978 8 34458 1993 23 34519 1979 9 34498 1994 24 34519 1980 10 34476 1995 25 34521 1981 11 34483 1996 26 34521 1982 12 34488 1997 27 34523 1983 13 34513 1998 28 34525 1984 14 34497 1999 29 34525 1985 15 34511 2000 30 34527 æ ¹æ®è¡¨ä¸­æ•°æ®ï¼Œä½œå‡ºæ•£ç‚¹å›¾ï¼š ç”±æ•£ç‚¹å›¾å¯ä»¥çœ‹å‡ºï¼Œäººå£éšæ—¶é—´çš„å˜åŒ–å‘ˆéžçº¿æ€§å˜åŒ–ï¼Œè€Œä¸”å­˜åœ¨ä¸€ä¸ªä¸Žæ¨ªåæ ‡å¹³è¡Œçš„æ¸è¿‘çº¿ï¼Œæ‰€ä»¥å¯ä»¥ç”¨Logisticæ›²çº¿æ¨¡åž‹è¿›è¡Œæ‹Ÿåˆã€‚ å› ä¸ºLogisticæ›²çº¿æ¨¡åž‹çš„åŸºæœ¬å½¢å¼ä¸ºï¼š \[y = \frac{1}{a+be^{-t}}\] æ‰€ä»¥ï¼Œåªè¦ä»¤\(y&#39;=\frac{1}{y},x&#39;=e^{-t}\)ï¼Œå°±å¯ä»¥å°†å…¶è½¬åŒ–ä¸ºç›´çº¿æ¨¡åž‹ï¼š \[y&#39;=a+bx&#39;\] ä¸‹é¢ï¼Œç”¨MATLABè¿›è¡Œå›žå½’åˆ†æžæ‹Ÿåˆè®¡ç®—ï¼š 12345678910111213141516171819202122232425262728293031323334353637clearclc% è¯»å…¥äººå£æ•°æ®Y = [33815 33981 34004 34165 34212 34327 34344 34458 34498 34476 34483 34488 34513 34497 34511 34520 34507 34509 34521 34513 34515 34517 34519 34519 34521 34521 34523 34525 34525 34527];% è¯»å…¥æ—¶é—´å˜é‡æ•°æ®T = [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30];% çº¿æ€§åŒ–å¤„ç†for t = 1:30, x(t) = exp(-t); y(t) = 1/Y(1, t);end% è®¡ç®—ï¼Œå¹¶è¾“å‡ºå›žå½’ç³»æ•°Bc = zeros(30, 1) + 1;X = [c, x&apos;];B = inv(X&apos; * X) * X&apos; * y&apos;for i = 1:30, % è®¡ç®—å›žå½’æ‹Ÿåˆå€¼ z(i) = B(1, 1) + B(2, 1) * x(i); % è®¡ç®—ç¦»å·® s(i) = y(i) - sum(y)/30; % è®¡ç®—è¯¯å·® w(i) = z(i) - y(i);end% è®¡ç®—ç¦»å·®å¹³æ–¹å’ŒSS = s * s&apos;;% è®¡ç®—å›žå½’è¯¯å·®å¹³æ–¹å’ŒQQ = w * w&apos;;% è®¡ç®—å›žå½’å¹³æ–¹å’ŒUU = S - Q;% è®¡ç®—ï¼Œå¹¶è¾“å‡ºFæ£€éªŒå€¼F = 28 * U/Q% è®¡ç®—éžçº¿æ€§å›žå½’æ¨¡åž‹çš„æ‹Ÿåˆå€¼for j = 1:30, Y(j) = 1/(B(1, 1) + B(2, 1) * exp(-j)); end% è¾“å‡ºéžçº¿æ€§å›žå½’æ¨¡åž‹çš„æ‹Ÿåˆæ›²çº¿ï¼ˆLogisticsæ›²çº¿ï¼‰plot(T, Y) è¿è¡Œè¯¥ç¨‹åºï¼Œè¾“å‡ºï¼š å›žå½’ç³»æ•°Bå’ŒFæ£€éªŒå€¼ï¼š 123456B = 1.0e-04 * 0.2902 0.0182F = 47.8774 Logisticæ¨¡åž‹æ‹Ÿåˆæ›²çº¿ï¼š è–„è†œæ¸—é€çŽ‡æµ‹å®š é—®é¢˜æå‡º æŸç§åŒ»ç”¨è–„è†œæœ‰å…è®¸ä¸€ç§ç‰©è´¨çš„åˆ†å­ç©¿é€å®ƒçš„åŠŸèƒ½ï¼Œåœ¨è¯•åˆ¶æ—¶éœ€æµ‹å®šè–„è†œè¢«è¿™ç§åˆ†å­ç©¿é€çš„èƒ½åŠ›ã€‚æµ‹å®šæ–¹æ³•å¦‚ä¸‹ï¼šç”¨é¢ç§¯ä¸º\(S\)çš„è–„è†œå°†å®¹å™¨åˆ†æˆä½“ç§¯åˆ†åˆ«ä¸º\(V_A,V_B\)çš„ä¸¤éƒ¨åˆ†ï¼Œåœ¨ä¸¤éƒ¨åˆ†ä¸­åˆ†åˆ«æ³¨æ»¡è¯¥ç‰©è´¨çš„ä¸¤ç§ä¸åŒæµ“åº¦çš„æº¶æ¶²ã€‚æ­¤æ—¶ï¼Œè¯¥ç‰©è´¨åˆ†å­å°±ä¼šç©¿è¿‡è–„è†œä»Žé«˜æµ“åº¦æº¶æ¶²å‘ä½Žæµ“åº¦æº¶æ¶²æ‰©æ•£ã€‚å·²çŸ¥é€šè¿‡å•ä½é¢ç§¯è–„è†œåˆ†å­æ‰©æ•£çš„é€Ÿåº¦ä¸Žè†œä¸¤ä¾§æº¶æ¶²çš„æµ“åº¦å·®æˆæ­£æ¯”ï¼Œæ¯”ä¾‹ç³»æ•°\(K\)è¡¨å¾ä»¤è–„è†œè¢«è¯¥ç‰©è´¨åˆ†å­ç©¿é€çš„èƒ½åŠ›ï¼Œç§°ä¸ºæ¸—é€çŽ‡ã€‚å®šæ—¶æµ‹é‡å®¹å™¨ä¸­è–„è†œæŸä¸€ä¾§çš„æº¶æ¶²æµ“åº¦å€¼ï¼Œå¯ä»¥ç¡®å®š\(K\)çš„æ•°å€¼ï¼Œè¯•ç”¨æ•°å­¦å»ºæ¨¡çš„æ–¹æ³•è§£å†³\(K\)å€¼çš„æ±‚è§£é—®é¢˜ã€‚ æ•°å­¦æ¨¡åž‹çš„å»ºç«‹ (1) å‡è®¾ è–„è†œä¸¤ä¾§çš„æº¶æ¶²å§‹ç»ˆéƒ½æ˜¯å‡åŒ€çš„ï¼Œå³åœ¨ä»»ä½•æ—¶åˆ»è†œä¸¤ä¾§çš„æ¯ä¸€å¤„æº¶æ¶²çš„æµ“åº¦éƒ½æ˜¯ç›¸åŒçš„ã€‚ å½“ä¸¤ä¾§æµ“åº¦ä¸ä¸€è‡´æ—¶ï¼Œç‰©è´¨çš„åˆ†å­ç©¿é€è–„è†œæ€»æ˜¯ä»Žé«˜æµ“åº¦å‘ä½Žæµ“åº¦æº¶æ¶²æ‰©æ•£ã€‚ é€šè¿‡å•ä½é¢ç§¯è†œåˆ†å­æ‰©æ•£çš„é€Ÿåº¦ä¸Žè†œä¸¤ä¾§æº¶æ¶²çš„æµ“åº¦æˆæ­£æ¯”ã€‚ è–„è†œæ˜¯åŒå‘åŒæ€§çš„ï¼Œå³ç‰©è´¨ä»Žè†œçš„ä»»ä½•ä¸€ä¾§å‘å¦ä¸€ä¾§æ¸—é€çš„æ€§èƒ½æ˜¯ç›¸åŒçš„ã€‚ (2) ç¬¦å·è¯´æ˜Ž \(C_A(t)ã€C_B(t)\)è¡¨ç¤º\(t\)æ—¶åˆ»è†œä¸¤ä¾§æº¶æ¶²çš„æµ“åº¦ã€‚ \(a_Aã€a_B\)è¡¨ç¤ºåˆå§‹æ—¶åˆ»è†œä¸¤ä¾§çš„æµ“åº¦(å•ä½:\(mg/cm^3\))ã€‚ \(K\)è¡¨ç¤ºæ¸—é€çŽ‡ã€‚ \(V_Aã€V_B\)è¡¨ç¤ºç”±è–„è†œé˜»éš”çš„å®¹å™¨ä¸¤ä¾§çš„ä½“ç§¯ã€‚ (3) æ¨¡åž‹çš„å»ºç«‹ è€ƒå¯Ÿæ—¶æ®µ\([t,t+\Delta t]\)è–„è†œä¸¤ä¾§å®¹å™¨ä¸­è¯¥ç‰©è´¨è´¨é‡çš„å˜åŒ–ã€‚ä»¥å®¹å™¨\(A\)ä¸ºä¾‹ï¼Œåœ¨è¯¥æ—¶æ®µç‰©è´¨è´¨é‡å¢žåŠ é‡ä¸ºï¼š \[V_AC_A(t+\Delta t)-V_AC_A(t)\] å¦ä¸€æ–¹é¢ç”±æ¸—é€çŽ‡çš„å®šä¹‰å¯çŸ¥ï¼Œä»ŽBä¾§æ¸—é€è‡³Aä¾§çš„è¯¥ç‰©è´¨çš„è´¨é‡ä¸ºï¼š \[SK(C_B-C_A)\Delta t\] ç”±è´¨é‡å®ˆæ’å®šå¾‹ï¼Œä¸¤è€…åº”è¯¥ç›¸ç­‰ï¼ŒäºŽæ˜¯æœ‰ï¼š \[V_AC_A(t+\Delta t)-V_AC_A(t)=SK(C_B-C_A)\Delta t\] ä¸¤è¾¹åŒé™¤\(\Delta t\)ï¼Œä»¤\(\Delta t \to 0\)ï¼Œæ•´ç†å¾—ï¼š \[\frac{dC_A}{dt}=\frac{SK}{V_A}(C_B-C_A) \tag{1} \] ä¸”æ³¨æ„åˆ°æ•´ä¸ªå®¹å™¨çš„æº¶æ¶²ä¸­å«æœ‰è¯¥ç‰©è´¨çš„è´¨é‡åº”è¯¥ä¸å˜ï¼Œå³æœ‰ä¸‹å¼æˆç«‹ï¼š \[V_AC_A(t)+V_BC_B(t)=V_Aa_A+V_Ba_B\] å› æ­¤æœ‰ï¼š \[C_A(t)=a_A+\frac{V_B}{V_A}a_B-\frac{V_B}{V_A}C_B(t)\] ä»£å…¥å¼(1)å¾—ï¼š \[\frac{dC_B}{dt}+SK(\frac{1}{V_A}+\frac{1}{V_B})C_B=SK(\frac{a_A}{V_B}+\frac{a_B}{V_A})\] å†åˆ©ç”¨åˆå§‹æ¡ä»¶\(C_B(0)=a_B\)ï¼Œè§£å‡ºï¼š \[C_B(t)=\frac{a_AV_A+a_BV_B}{V_A+V_B}+\frac{V_A(a_B-a_A)}{V_A+V_B}e^{-SK(\frac{1}{V_A}+\frac{1}{V_B})t}\] è‡³æ­¤ï¼Œé—®é¢˜å½’ç»“ä¸ºåˆ©ç”¨\(C_B\)åœ¨æ—¶åˆ»\(t_j\)çš„æµ‹é‡æ•°æ®\(C_j(j=1,2,â€¦,N)\)æ¥è¾¨è¯†å‚æ•°\(K\)å’Œ\(a_A\)ã€\(a_B\)ï¼Œå¯¹åº”çš„æ•°å­¦æ¨¡åž‹å˜ä¸ºæ±‚å‡½æ•°ï¼š \[\min E(K,a_A,a_B)=\sum_{j=1}^n(C_B(t_j)-C_j)^2\] ä»¤\(a=\frac{a_AV_A+a_BV_B}{V_A+V_B}\)ï¼Œ\(b=\frac{V_A(a_B-a_A)}{V_A+V_B}\)ï¼Œé—®é¢˜è½¬åŒ–ä¸ºæ±‚å‡½æ•°ï¼š \[E(K,a_A,a_B)=\sum_{j=1}^n[a+be^{-SK(\frac{1}{V_A}+\frac{1}{V_B})t_j}-C_j]^2\] çš„æœ€å°å€¼ç‚¹\((K,a,b)\)ã€‚ æ±‚è§£å‚æ•° ä¾‹å¦‚ï¼Œè®¾\(V_A=V_B=1000cm^3,S=10cm^2\)ï¼Œå¯¹å®¹å™¨Béƒ¨åˆ†æº¶æ¶²æµ“åº¦çš„æµ‹è¯•å¦‚ä¸‹è¡¨ï¼š \(t_j/s\) 100 200 300 400 500 600 700 800 900 1000 \(C_j/(mgÂ·cm^{-3})\) 4.54 4.99 5.35 5.65 5.90 6.10 6.26 6.39 6.50 6.59 æ­¤æ—¶æžå°åŒ–å‡½æ•°ä¸ºï¼š \[E(K,a_A,a_B)=\sum_{j=1}^{10}[a+be^{-0.02Kt_j}-C_j]^2\] ä¸‹é¢ç”¨MATLABè¿›è¡Œè®¡ç®—ï¼š ç¼–å†™Mæ–‡ä»¶(curvefun.m)ï¼š 123function f = curvefun(x, tdata) f = x(1) + x(2) * exp(-0.02 * x(3) * tdata); % å…¶ä¸­x(1)=a; x(2)=b; x(3)=kend ç¼–å†™ç¨‹åº(demo.m)ï¼š 12345678910tdata = linspace(100, 1000, 10); % çº¿æ€§ç­‰åˆ†å‘é‡cdata = 1e-05 .* [454 499 535 565 590 610 626 639 650 659];x0 = [0.2, 0.05, 0.05]; % åˆå€¼ä¼°è®¡opts = optimset(&apos;lsqcurvefit&apos;); % æ— çº¦æŸæœ€ä¼˜åŒ–(éžçº¿æ€§æ›²çº¿æ‹Ÿåˆ)opts = optimset(opts, &apos;PrecondBandWidth&apos;, 0); % å¤åˆ¶ä¸€ä¸ªå·²å­˜åœ¨çš„ï¼Œä¿®æ”¹ç‰¹å®šé¡¹x = lsqcurvefit(&apos;curvefun&apos;, x0, tdata, cdata, [], [], opts) % éžçº¿æ€§æ‹Ÿåˆå‡½æ•°f = curvefun(x, tdata)plot(tdata, cdata, &apos;o&apos;, tdata, f, &apos;r-&apos;)xlabel(&apos;æ—¶é—´/s&apos;)ylabel(&apos;æµ“åº¦&apos;) è¾“å‡ºç»“æžœï¼š 123456x = 0.0063 -0.0034 0.2542% è¡¨ç¤º a=0.0063 b=-0.0034 k=0.2542f = 0.0043 0.0051 0.0056 0.0059 0.0061 0.0062 0.0062 0.0063 0.0063 0.0063% è¡¨ç¤ºç‚¹å¯¹åº”çš„æ‹Ÿåˆå‡½æ•°å€¼ æ›²çº¿çš„æ‹Ÿåˆç»“æžœå¦‚å›¾æ‰€ç¤ºï¼Œè¿›ä¸€æ­¥å¯æ±‚å¾—\(a_A=0.01mg/cm^3,a_b=0.004mg/cm^3\)ã€‚ æ•°æ®å¯è§†åŒ– åœ°å½¢åœ°è²Œå›¾å½¢çš„ç»˜åˆ¶ ä¸‹è¡¨æ‰€åˆ—ä¸ºæŸæ¬¡åœ°è²Œæµ‹é‡æ‰€å¾—ç»“æžœï¼Œå¯¹ä¸€æ–¹å½¢åŒºåŸŸ\((x, y)\)æ–¹å‘å‡ä»Ž1ï½ž10ï¼Œé€‰æ‹©æŸäº›åœ°ç‚¹æµ‹é‡å…¶ç›¸å¯¹äºŽæŸæ°´å¹³é¢é«˜åº¦çš„æ•°æ®ï¼Œè¦æ±‚ç”¨è¿™äº›æ•°æ®å°½é‡å‡†ç¡®åœ°ç»˜åˆ¶å‡ºè¯¥åœ°åŒºçš„åœ°å½¢åœ°è²Œã€‚ 1 2 3 4 5 6 7 8 9 10 1 0.02 -0.12 -2.09 -0.58 -0.08 2 0.02 -2.38 -4.96 -0.10 3 0.10 1.00 -3.04 -0.53 0.10 4 3.52 5 -0.43 -1.98 0.77 2.17 6 -2.29 0.69 2.59 0.30 7 -0.09 -0.31 4.27 -0.01 8 5.13 7.40 1.89 0.04 9 0.10 0.58 1.75 -0.11 10 -0.01 0.3 0.01 è§£å†³æ­¤é—®é¢˜çš„å…³é”®æ˜¯è¦å°†æœªæµ‹é‡åœ°ç‚¹çš„é«˜åº¦ç”¨æ•°æ®æ’å€¼çš„æ–¹æ³•æ±‚å‡ºæ¥ï¼Œç„¶åŽå°±å¯ä»¥ç”»å‡ºåœ°è²Œå›¾äº†ã€‚ 123456789101112131415[x, y] = meshgrid(1:10); % æž„é€ æµ‹é‡ç½‘ç»œh = [0, 0.02, -0.12, 0, -2.09, 0, -0.58, -0.08, 0, 0; 0.02, 0, 0, -2.38, 0, -4.96, 0, 0, 0, -0.10; 0, 0.10, 1.00, 0, -3.04, 0, -0.53, 0, 0.10, 0; 0, 0, 0, 3.52, 0, 0, 0, 0, 0, 0; -0.43, -1.98, 0, 0, 0, 0.77, 0, 2.17, 0, 0; 0, 0, -2.29, 0, 0.69, 0, 2.59, 0, 0.30, 0; -0.09, -0.31, 0, 0, 0, 4.27, 0, 0, 0, -0.01; 0, 0, 0, 5.13, 7.40, 0, 1.89, 0, 0.04, 0; 0.10, 0, 0.58, 0, 0, 1.75, 0, -0.11, 0, 0; 0, -0.01, 0, 0, 0.3, 0, 0, 0, 0, 0.01]; % æž„é€ æ•°æ®ç‚¹ [xi, yi] = meshgrid(1:0.1:10); % æž„é€ æ’å€¼ç½‘ç»œ hi = interp2(x, y, h, xi ,yi, &apos;spline&apos;); % äºŒç»´æ’å€¼å‘½ä»¤ï¼Œspline:ä¸‰æ¬¡æ ·æ¡æ’å€¼ surf(hi); % ç”»å‡ºåœ°è²Œå›¾ xlabel(&apos;x&apos;), ylabel(&apos;y&apos;), zlabel(&apos;z&apos;); è¿è¡Œå¾—åˆ°è¯¥åœ°åŒºçš„åœ°è²Œå½¢æ€å›¾ï¼Œæ­¤å¤„ç”¨åˆ†æ®µä¸‰æ¬¡æ ·æ¡æ’å€¼ä¼šå¾—åˆ°æ›´å¥½çš„æ•ˆæžœï¼š è½¦ç¯å…‰æºæŠ•å½±åŒºåŸŸçš„ç»˜åˆ¶(CUMCM 2002A) éœ€è¦å…ˆå»ºç«‹è½¦ç¯æŠ•å½±çš„æ•°å­¦æ¨¡åž‹ï¼Œç„¶åŽå†æ ¹æ®æ¨¡åž‹ç»˜åˆ¶å‡ºæŠ•å½±æ•ˆæžœå›¾ã€‚ åˆ©ç”¨MATLABï¼Œæ ¹æ®å¾—åˆ°çš„çº¿å…‰æºé•¿åº¦ï¼Œç”¨æŠ•ç‚¹æ³•å¯ç”»å‡ºæµ‹è¯•å±ä¸Šåå°„å…‰çš„äº®åŒºã€‚ 12345678910111213141516p = 0.03;x = 25.026;for y1 = -0.002:0.0004:0.002 y0 = (-0.036:0.001:0.036)&apos; * ones(1, 73); z0 = ones(73, 1) * (-0.036:0.001:0.036); x0 = (y0 .^ 2 + z0 .^ 2) / (2 * p); xn = (p^3 + 4 * x0 * 2 * p .* x0 + p * (-4 * y1 * y0 + 3 * 2*p *x0)) ./ (2 * (p^2 + 2 * p * x0)); yn = (2 * p * x0 .* y0 + p^2 * (-y1 + y0) + y1 * (y0 .^ 2 - z0 .^ 2)) ./ (p^2 + 2 * p * x0); zn = (p^2 + 2* p * x0 + 2* y1 * y0) .* z0 ./ (p^2 + 2 * p * x0); y = y0 + (yn - y0) .* (x - x0) ./ (xn - x0); z = z0 + (zn - z0) .* (x - x0) ./ (xn - x0); plot(y, z, &apos;b.&apos;) xlabel(&apos;y(m)&apos;) ylabel(&apos;z(m)&apos;) hold onend è¿è¡Œç¨‹åºï¼Œå³å¾—åˆ°åå°„å…‰åœ¨æµ‹è¯•å±ä¸Šçš„äº®åŒºï¼š å±‚æ¬¡åˆ†æžæ³•(AHP) å±‚æ¬¡åˆ†æžæ³•çš„åº”ç”¨åœºæ™¯ å±‚æ¬¡åˆ†æžæ³•(Analytic Hierarchy Process, AHP)æ˜¯ä¸€ç§å†³ç­–æ–¹æ³•ï¼Œå®ƒæ˜¯å°†åŠå®šåž‹ã€åŠå®šé‡é—®é¢˜è½¬åŒ–ä¸ºå®šé‡é—®é¢˜çš„æœ‰æ•ˆé€”å¾„ï¼Œå®ƒå°†å„ç§å› ç´ å±‚æ¬¡åŒ–ï¼Œå¹¶é€å±‚æ¯”è¾ƒå¤šç§å…³è”å› ç´ ï¼Œä¸ºåˆ†æžå’Œé¢„æµ‹äº‹ç‰©çš„å‘å±•æä¾›å¯æ¯”è¾ƒçš„å®šé‡ä¾æ®ï¼ŒAHPç‰¹åˆ«é€‚ç”¨äºŽé‚£äº›éš¾ä»¥å®Œå…¨ç”¨å®šé‡è¿›è¡Œåˆ†æžçš„å¤æ‚é—®é¢˜ï¼Œå› æ­¤åœ¨èµ„æºåˆ†é…ã€é€‰ä¼˜æŽ’åºã€æ”¿ç­–åˆ†æžã€å†²çªæ±‚è§£ä»¥åŠå†³ç­–é¢„æŠ¥ç­‰é¢†åŸŸå¾—åˆ°å¹¿æ³›çš„åº”ç”¨ã€‚ AHPæ³•çš„æœ¬è´¨æ˜¯æ ¹æ®äººä»¬å¯¹äº‹ç‰©çš„è®¤çŸ¥ç‰¹å¾ï¼Œå°†æ„Ÿæ€§è®¤è¯†è¿›è¡Œå®šé‡åŒ–çš„è¿‡ç¨‹ã€‚äººä»¬åœ¨åˆ†æžå¤šä¸ªå› ç´ æ—¶ï¼Œå¤§è„‘å¾ˆéš¾åŒæ—¶æ¢³ç†é‚£ä¹ˆå¤šä¿¡æ¯ï¼Œè€Œå±‚æ¬¡åˆ†æžæ³•çš„ä¼˜åŠ¿å°±æ˜¯é€šè¿‡å¯¹å› ç´ å½’çº³ã€åˆ†å±‚ï¼Œå¹¶é€å±‚åˆ†æžå’Œé‡åŒ–äº‹ç‰©ï¼Œä»¥è¾¾åˆ°å¯¹å¤æ‚äº‹ç‰©çš„æ›´å‡†ç¡®è®¤è¯†ï¼Œä»Žè€Œå¸®åŠ©å†³ç­–ã€‚ åœ¨æ•°å­¦å»ºæ¨¡ä¸­ï¼Œå±‚æ¬¡åˆ†æžæ³•çš„åº”ç”¨åœºæ™¯æ¯”è¾ƒå¤šï¼Œå½’çº³èµ·æ¥ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªåœºæ™¯ï¼š è¯„ä»·ã€è¯„åˆ¤ç±»çš„é¢˜ç›®ã€‚è¿™ç±»é¢˜ç›®éƒ½å¯ä»¥ç›´æŽ¥ç”¨å±‚æ¬¡åˆ†æžæ³•æ¥è¯„ä»·ï¼Œä¾‹å¦‚å¥¥è¿ä¼šçš„è¯„ä»·ã€å½©ç¥¨æ–¹æ¡ˆçš„è¯„ä»·ã€å¯¼å¸ˆå’Œå­¦ç”Ÿçš„ç›¸äº’é€‰æ‹©ã€å»ºæ¨¡è®ºæ–‡çš„è¯„ä»·ã€åŸŽå¸‚ç©ºæ°”è´¨é‡åˆ†æžç­‰ã€‚ èµ„æºåˆ†é…å’Œå†³ç­–ç±»çš„é¢˜ç›®ã€‚è¿™ç±»é¢˜ç›®å¯ä»¥è½¬åŒ–ä¸ºè¯„ä»·ç±»çš„é¢˜ç›®ï¼Œç„¶åŽæŒ‰ç…§AHPè¿›è¡Œæ±‚è§£ï¼Œå¦‚å°†ä¸€ç¬”èµ„é‡‘è¿›è¡ŒæŠ•èµ„ï¼Œæœ‰å‡ ä¸ªå¤‡é€‰é¡¹ç›®ï¼Œé‚£ä¹ˆå¦‚ä½•è¿›è¡ŒæŠ•èµ„åˆ†é…æœ€åˆç†ã€‚è¿™é‡Œé¢˜ç›®ä¸­è¿˜æœ‰ä¸€ä¸ªå…¸åž‹çš„åº”ç”¨ï¼Œå°±æ˜¯æ–¹æ¡ˆçš„é€‰æ‹©é—®é¢˜ï¼Œæ¯”å¦‚æ—…æ¸¸æ™¯ç‚¹çš„é€‰æ‹©ã€ç”µè„‘çš„æŒ‘é€‰ã€å­¦æ ¡çš„é€‰æ‹©ã€ä¸“ä¸šçš„é€‰æ‹©ç­‰ã€‚ ä¸€äº›ä¼˜åŒ–é—®é¢˜ï¼Œå°¤å…¶æ˜¯å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜ã€‚å¯¹äºŽé€šå¸¸çš„ä¼˜åŒ–é—®é¢˜ï¼Œç›®å‰å·²æœ‰æˆç†Ÿçš„æ–¹æ³•æ±‚è§£ã€‚ç„¶è€Œè¿™äº›ä¼˜åŒ–é—®é¢˜ä¸€æ—¦å…·æœ‰å¦‚ä¸‹ç‰¹å¾ä¹‹ä¸€ï¼šé—®é¢˜ä¸­å­˜åœ¨ä¸€äº›éš¾ä»¥åº¦é‡çš„å› ç´ ï¼›é—®é¢˜çš„ç»“æž„åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºŽå†³ç­–è€…çš„ç»éªŒï¼›é—®é¢˜çš„æŸäº›å˜é‡ä¹‹é—´å­˜åœ¨ç›¸å…³æ€§ï¼›éœ€è¦åŠ å…¥å†³ç­–è€…çš„ç»éªŒã€åå¥½ç­‰å› ç´ ã€‚è¿™æ—¶å°±å¾ˆéš¾å•çº¯ä¾é æž„é€ ä¸€ä¸ªä¼˜åŒ–çš„æ•°å­¦æ¨¡åž‹æ±‚è§£ã€‚è¿™ç±»é—®é¢˜ï¼Œé€šå¸¸çš„åšæ³•æ˜¯å€ŸåŠ©AHPå°†å¤æ‚çš„é—®é¢˜è½¬åŒ–ä¸ºå…¸åž‹çš„ä¾¿äºŽæ±‚è§£çš„ä¼˜åŒ–é—®é¢˜ï¼Œæ¯”å¦‚å¤šç›®æ ‡è§„åˆ’ï¼Œå€ŸåŠ©å±‚æ¬¡åˆ†æžæ³•ï¼Œç¡®å®šå„ä¸ªç›®æ ‡çš„æƒé‡ï¼Œä»Žè€Œå°†å¤šç›®æ ‡è§„åˆ’é—®é¢˜è½¬åŒ–ä¸ºå¯ä»¥æ±‚è§£çš„å•ç›®æ ‡è§„åˆ’é—®é¢˜ã€‚ AHP MATLABç¨‹åºè®¾è®¡ å±‚æ¬¡åˆ†æžæ³•ä¸­ï¼Œéœ€è¦MATLABçš„åœ°æ–¹ä¸»è¦å°±æ˜¯å°†è¯„åˆ¤çŸ©é˜µè½¬åŒ–ä¸ºå› ç´ çš„æƒé‡çŸ©é˜µã€‚é€šå¸¸çš„åšæ³•å°±æ˜¯æ±‚è§£çŸ©é˜µçš„æœ€å¤§ç‰¹å¾æ ¹å’Œå¯¹åº”é˜µå‘é‡ã€‚åœ¨å°†è¯„åˆ¤çŸ©é˜µè½¬åŒ–ä¸ºæƒé‡å‘é‡çš„è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬éœ€è¦å…ˆåˆ¤æ–­è¯„åˆ¤çŸ©é˜µçš„ä¸€è‡´æ€§ï¼Œå› ä¸ºé€šè¿‡ä¸€è‡´æ€§æ£€éªŒçš„çŸ©é˜µï¼Œå¾—åˆ°çš„æƒé‡æ‰æ›´å¯é ã€‚ 123456789101112131415161718192021222324252627% AHPæƒé‡è®¡ç®—clcclear% æ•°æ®è¯»å…¥A = [1 2 6; 1/2 1 4; 1/6 1/4 1]; % è¯„åˆ¤çŸ©é˜µ% ä¸€è‡´æ€§æ£€éªŒ[n, n] = size(A);[v, d] = eig(A);r = d(1, 1);CI = (r - n)/(n - 1);RI = [0 0 0.58 0.90 1.12 1.24 1.32 1.41 1.45 1.49 1.52 1.54 1.56 1.58 1.59];CR = CI/RI(n);if CR &lt; 0.10 CR_Result = &apos;é€šè¿‡&apos;;else CR_Result = &apos;ä¸é€šè¿‡&apos;;end% æƒå‘é‡è®¡ç®—w = v(:, 1)/sum(v(:, 1));w = w&apos;;% ç»“æžœè¾“å‡ºdisp(&apos;è¯¥åˆ¤æ–­çŸ©é˜µæƒå‘é‡è®¡ç®—æŠ¥å‘Šï¼š&apos;);disp([&apos;ä¸€è‡´æ€§æŒ‡æ ‡ï¼š&apos; num2str(CI)]);disp([&apos;ä¸€è‡´æ€§æ¯”ä¾‹ï¼š&apos; num2str(CR)]);disp([&apos;ä¸€è‡´æ€§æ£€éªŒç»“æžœï¼š&apos; CR_Result]);disp([&apos;ç‰¹å¾å€¼ï¼š&apos; num2str(r)]);disp([&apos;æƒå‘é‡ï¼š&apos; num2str(w)]); è¿è¡Œè¯¥ç¨‹åºï¼Œå¾—åˆ°ç»“æžœï¼š 123456è¯¥åˆ¤æ–­çŸ©é˜µæƒå‘é‡è®¡ç®—æŠ¥å‘Šï¼šä¸€è‡´æ€§æŒ‡æ ‡ï¼š0.0046014ä¸€è‡´æ€§æ¯”ä¾‹ï¼š0.0079334ä¸€è‡´æ€§æ£€éªŒç»“æžœï¼šé€šè¿‡ç‰¹å¾å€¼ï¼š3.0092æƒå‘é‡ï¼š0.58763 0.32339 0.088983 åº”ç”¨è¿™æ®µç¨‹åºæ—¶ï¼Œåªè¦å°†è¯„åˆ¤çŸ©é˜µè¾“å…¥åˆ°ç¨‹åºä¸­ï¼Œå…¶ä»–åœ°æ–¹ä¸éœ€è¦ä¿®æ”¹ï¼Œå°±å¯ä»¥ç›´æŽ¥ã€x]]></content>
      <categories>
        <category>MCM</category>
      </categories>
      <tags>
        <tag>matlab</tag>
        <tag>mcm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MachineLearning Chapter-5 Dimensionality Reduction]]></title>
    <url>%2F2019%2F07%2F31%2FMachineLearning-Chapter-5-Dimensionality-Reduction%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿° æ•°æ®é™ç»´æ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸä¸­éžå¸¸é‡è¦çš„å†…å®¹ã€‚æ‰€è°“é™ç»´ï¼Œå°±æ˜¯æŒ‡é‡‡ç”¨æŸç§æ˜ å°„æ–¹æ³•ï¼Œå°†åŽŸé«˜ç»´ç©ºé—´ä¸­çš„æ•°æ®ç‚¹æ˜ å°„åˆ°ä½Žçº¬åº¦åˆ°ç©ºé—´ä¸­ã€‚é™ç»´çš„æœ¬è´¨æ˜¯å­¦ä¹ ä¸€ä¸ªæ˜ å°„å‡½æ•°\(f:x\to y\)ï¼Œå…¶ä¸­\(x\)æ˜¯åŽŸå§‹æ•°æ®ç‚¹çš„è¡¨è¾¾ï¼Œç›®å‰å¤šä½¿ç”¨å‘é‡è¡¨è¾¾å½¢å¼ã€‚\(y\)æ˜¯æ•°æ®ç‚¹æ˜ å°„åŽçš„ä½Žç»´å‘é‡è¡¨è¾¾ï¼Œé€šå¸¸\(y\)çš„ç»´åº¦å°äºŽ\(x\)çš„ç»´åº¦ã€‚æ˜ å°„å‡½æ•°\(f\)å¯èƒ½æ˜¯æ˜¾å¼çš„æˆ–éšå¼çš„ã€çº¿æ€§çš„æˆ–éžçº¿æ€§çš„ã€‚ ç›®å‰å¤§éƒ¨åˆ†é™ç»´ç®—æ³•å¤„ç†å‘é‡è¡¨è¾¾çš„æ•°æ®ï¼Œä¹Ÿæœ‰ä¸€äº›é™ç»´ç®—æ³•å¤„ç†é«˜é˜¶å¼ é‡è¡¨è¾¾çš„æ•°æ®ã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨é™ç»´åŽçš„æ•°æ®è¡¨ç¤ºæ˜¯å› ä¸ºåœ¨åŽŸå§‹çš„é«˜ç»´ç©ºé—´ä¸­ï¼ŒåŒ…å«å†—ä½™ä¿¡æ¯ä»¥åŠå™ªå£°ä¿¡æ¯ï¼Œåœ¨å®žé™…åº”ç”¨ä¾‹å¦‚å›¾åƒè¯†åˆ«ä¸­é€ æˆäº†è¯¯å·®ï¼Œé™ä½Žäº†å‡†ç¡®çŽ‡ï¼›è€Œé€šè¿‡é™ç»´ï¼Œæˆ‘ä»¬å¸Œæœ›å‡å°‘å†—ä½™ä¿¡æ¯æ‰€é€ æˆçš„è¯¯å·®ï¼Œæé«˜è¯†åˆ«çš„ç²¾åº¦ã€‚åˆæˆ–è€…å¸Œæœ›é€šè¿‡é™ç»´ç®—æ³•æ¥å¯»æ‰¾æ•°æ®å†…éƒ¨çš„æœ¬è´¨ç»“æž„ç‰¹å¾ã€‚ åœ¨å¾ˆå¤šç®—æ³•ä¸­ï¼Œé™ç»´ç®—æ³•æˆä¸ºäº†æ•°æ®é¢„å¤„ç†çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚ä¸‹é¢æåˆ°çš„PCAç®—æ³•ã€‚äº‹å®žä¸Šï¼Œæœ‰ä¸€äº›ç®—æ³•å¦‚æžœæ²¡æœ‰é™ç»´é¢„å¤„ç†ï¼Œå…¶å®žæ˜¯å¾ˆéš¾å¾—åˆ°å¾ˆå¥½æ•ˆæžœçš„ã€‚ ç®—æ³• ç»´åº¦ç¾éš¾ä¸Žé™ç»´ å¯¹äºŽkè¿‘é‚»æ³•ï¼Œæœ€å¥½è¦æ±‚æ ·æœ¬ç‚¹æ¯”è¾ƒå¯†é›†ã€‚ç†è®ºä¸Šç»™å®šæµ‹è¯•æ ·æœ¬\(\vec{x}\)ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨\(\vec{x}\)é™„è¿‘å¾ˆè¿‘çš„è·ç¦»\(\delta &gt;0\)èŒƒå›´å†…æ€»èƒ½æ‰¾åˆ°ä¸€ä¸ªè®­ç»ƒæ ·æœ¬\(\vec{z}\)ã€‚å‡è®¾\(\delta=0.001\)ï¼Œä¸”æ‰€æœ‰ç‰¹å¾çš„å–å€¼èŒƒå›´éƒ½æ˜¯\([0,1]\)ï¼š è‹¥æ ·æœ¬åªæœ‰ä¸€ä¸ªç‰¹å¾ï¼Œåˆ™éœ€è¦1000ä¸ªå‡åŒ€åˆ†å¸ƒçš„è®­ç»ƒæ ·æœ¬ã€‚æ­¤æ—¶ä»»ä½•æµ‹è¯•æ ·æœ¬åœ¨å…¶é™„è¿‘\(\delta\)è·ç¦»èŒƒå›´å†…æ€»èƒ½æ‰¾åˆ°ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ã€‚ è‹¥æ ·æœ¬åªæœ‰10ä¸ªç‰¹å¾ï¼Œåˆ™éœ€è¦\(10^{30}\)ä¸ªå‡åŒ€åˆ†å¸ƒçš„è®­ç»ƒæ ·æœ¬ã€‚æ­¤æ—¶ä»»ä½•æµ‹è¯•æ ·æœ¬åœ¨å…¶é™„è¿‘\(\delta\)è·ç¦»èŒƒå›´å†…æ€»èƒ½æ‰¾åˆ°ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ã€‚ å¦‚æžœç‰¹å¾ç»´åº¦æˆåƒä¸Šä¸‡ï¼Œåˆ™éœ€è¦çš„è®­ç»ƒæ ·æœ¬çš„æ•°é‡å‡ ä¹Žä¸å¯èƒ½æ»¡è¶³ã€‚è€Œä¸”é«˜ç»´ç©ºé—´çš„è·ç¦»è®¡ç®—ä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚åœ¨é«˜ç»´æƒ…å½¢ä¸‹å‡ºçŽ°çš„æ•°æ®æ ·æœ¬ç¨€ç–ã€è·ç¦»è®¡ç®—å›°éš¾ç­‰é—®é¢˜æ˜¯æ‰€æœ‰æœºå™¨å­¦ä¹ æ–¹æ³•å…±åŒé¢ä¸´çš„ä¸¥é‡éšœç¢ï¼Œç§°ä¸ºâ€œç»´åº¦ç¾éš¾â€(curse of dimensionality)ã€‚å¯ä»¥é€šè¿‡é™ç»´(dimension reduction)æ¥ç¼“è§£è¿™ä¸ªé—®é¢˜ã€‚ å‰é¢ç« èŠ‚ä»‹ç»çš„çº¿æ€§åˆ¤åˆ«åˆ†æž(LDA)æ˜¯ä¸€ç§ç»å…¸çš„ç›‘ç£é™ç»´ç®—æ³•ï¼Œä¸»æˆåˆ†åˆ†æžPCAæ˜¯ä¸€ç§ç»å…¸çš„æ— ç›‘ç£é™ç»´ç®—æ³•ã€‚ å¯¹äºŽé™ç»´æ•ˆæžœçš„è¯„ä¼°ï¼Œé€šå¸¸æ˜¯æ¯”è¾ƒé™ç»´å‰åŽå­¦ä¹ å™¨çš„æ€§èƒ½ã€‚å¦‚æžœæ€§èƒ½æœ‰æ‰€æé«˜ï¼Œåˆ™è®¤ä¸ºé™ç»´èµ·äº†ä½œç”¨ã€‚å¦‚æžœå°†ç»´æ•°é™è‡³äºŒç»´æˆ–è€…ä¸‰ç»´ï¼Œåˆ™å¯ä»¥é€šè¿‡å¯è§†åŒ–æŠ€æœ¯æ¥ç›´è§‚åœ°åˆ¤æ–­é™ç»´çš„æ•ˆæžœã€‚ ä¸»æˆåˆ†åˆ†æž(PCA) PCAåŽŸç† ä¸»æˆåˆ†åˆ†æž(Principal Component Analysis, PCA)æ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§é™ç»´æ–¹æ³•ã€‚ä¸ºäº†ä¾¿äºŽç»´åº¦å˜æ¢ï¼Œæœ‰å¦‚ä¸‹å‡è®¾ï¼š å‡è®¾æ ·æœ¬æ•°æ®æ˜¯\(n\)ç»´çš„ å‡è®¾åŽŸå§‹åæ ‡ç³»ä¸ºï¼šç”±æ ‡å‡†æ­£äº¤åŸºå‘é‡\(\{\vec{i}_1,\vec{i}_2,â€¦,\vec{i}_n\}\)å¼ æˆçš„ç©ºé—´ï¼Œå…¶ä¸­\({||\vec{i}_s||}=1\); \(\vec{i}_sÂ·\vec{i}_t=0\), \(sâ‰ t\) å‡è®¾ç»è¿‡çº¿æ€§å˜æ¢åŽçš„æ–°åæ ‡ç³»ä¸ºï¼šç”±æ ‡å‡†æ­£äº¤åŸºå‘é‡\(\{\vec{j}_1,\vec{j}_2,â€¦,\vec{j}_n\}\)å¼ æˆçš„ç©ºé—´ï¼Œå…¶ä¸­\({||\vec{j}_s||}=1\); \(\vec{j}_sÂ·\vec{j}_t=0\), \(sâ‰ t\) æ ¹æ®å®šä¹‰ï¼Œæœ‰ï¼š \[\vec{j}_s=(\vec{i}_1,\vec{i}_2,â€¦,\vec{i}_n)\left[ \begin{array}{}\vec{j}_s Â· \vec{i}_1 \\ \vdots \\ \vec{j}_sÂ·\vec{i}_n\end{array}\right ],s=1,2,â€¦,n\]]]></content>
      <categories>
        <category>Machine Learning</category>
      </categories>
      <tags>
        <tag>machine learning</tag>
        <tag>python</tag>
        <tag>sklearn</tag>
        <tag>dimensionality reduction</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CTF Chapter-2 CTF-SSH]]></title>
    <url>%2F2019%2F07%2F29%2FCTF-Chapter-2-CTF-SSH%2F</url>
    <content type="text"><![CDATA[CTF-SSH ç§é’¥æ³„æ¼ å®žéªŒçŽ¯å¢ƒï¼š kali linux: 192.168.50.180 é¶åœºæœºå™¨: 192.168.50.112 ç›®çš„ï¼šèŽ·å–é¶åœºæœºå™¨çš„flagå€¼ ä¿¡æ¯æŽ¢æµ‹ å¯¹äºŽåªæ˜¯ç»™å®šä¸€ä¸ªå¯¹åº”IPåœ°å€çš„é¶åœºæœºå™¨ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œæ‰«æï¼ŒæŽ¢æµ‹å¼€æ”¾çš„æœåŠ¡ã€‚ æ¸—é€å…¶å®žæ˜¯é’ˆå¯¹æœåŠ¡çš„æ¼æ´žæŽ¢æµ‹ï¼Œç„¶åŽè¿›è¡Œå¯¹åº”çš„æ•°æ®åŒ…å‘é€ï¼ŒèŽ·å–æœºå™¨çš„æœ€é«˜æƒé™ã€‚ æŒ–æŽ˜å¼€æ”¾æœåŠ¡ä¿¡æ¯ï¼š 1nmap -sV 192.168.50.112 åˆ†æžæŽ¢æµ‹ç»“æžœ æ¯ä¸€ä¸ªæœåŠ¡å¯¹åº”è®¡ç®—æœºçš„ä¸€ä¸ªç«¯å£ï¼Œç”¨æ¥è¿›è¡Œé€šä¿¡ã€‚å¸¸ç”¨ç«¯å£0ï½ž1023ç«¯å£ï¼Œåœ¨æ‰«æç»“æžœä¸­æŸ¥æ‰¾ç‰¹å¾ç«¯å£ã€‚ é’ˆå¯¹ç‰¹æ®Šç«¯å£è¿›è¡ŒæŽ¢æµ‹ï¼Œå°¤å…¶å¯¹å¼€å‘å¤§ç«¯å£çš„httpæœåŠ¡è¿›è¡ŒæŽ’æŸ¥ã€‚ æŽ¢æµ‹å¤§ç«¯å£çš„ä¿¡æ¯ å¯¹äºŽå¼€æ”¾httpæœåŠ¡çš„å¤§ç«¯å£ï¼Œå¯ä»¥é‡‡å–http://ip:port/çš„å½¢å¼è®¿é—®ã€‚ æŸ¥çœ‹æºä»£ç èŽ·å–å¯¹åº”ä¿¡æ¯ï¼›å¦‚æžœæ²¡æœ‰flagä¿¡æ¯ï¼Œä½¿ç”¨å·¥å…·æŽ¢æµ‹éšè—é¡µé¢ï¼š 1dirb http://ip:port/ é’ˆå¯¹éšè—é¡µé¢åˆ†æž ç›´æŽ¥ä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼ŒæŸ¥çœ‹æ•ˆæžœã€å¯¹åº”æºä»£ç ã€‚å¯èƒ½ä¼šèŽ·å–åˆ°flagï¼Œæˆ–è€…ä¸‹ä¸€æ­¥å¯¹åº”çš„æç¤ºã€‚ æŒ–æŽ˜sshä¿¡æ¯ï¼Œä¸æ–­è®¿é—®èŽ·å–æ›´å¤šæ³„æ¼çš„sshç§˜é’¥ä¿¡æ¯ã€‚ å‘çŽ°è¿™é‡Œæœ‰ä¸¤ä¸ªæ•æ„Ÿç›®å½•robots.txtå’Œ.sshï¼Œæ‰“å¼€robots.txtçœ‹çœ‹å†…å®¹ è¿™é‡Œæœ‰ä¸‰ä¸ªç›®å½•ï¼Œæ‰“å¼€taxesèŽ·å¾—ç¬¬ä¸€ä¸ªflag ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹æ•æ„Ÿç›®å½•.ssh æˆ‘ä»¬å‘çŽ°è®¿é—®id_rsaå’Œauthorized_keysæ–‡ä»¶å¯ä»¥è¿›è¡Œä¸‹è½½ï¼Œè¿™é‡Œå°±å­˜åœ¨äº†ç§é’¥æ³„æ¼ã€‚ å¯¹ç§é’¥è¿›è¡Œèµ‹è¯»å†™æƒé™chmod 600 æ–‡ä»¶åï¼Œls -alhæŸ¥çœ‹æƒé™ã€‚ æœ‰äº†ç§é’¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨sshå‘½ä»¤å¯¹é¶åœºæœºå™¨è¿›è¡Œè¿œç¨‹ç™»é™†ï¼Œç”¨æˆ·åå¯ä»¥åœ¨è®¤è¯å…³é”®å­—æ–‡ä»¶ä¸­å‘çŽ°ã€‚ 1ssh -i id_rsa simon@192.168.50.112 ä½†æ˜¯åœ¨ç™»å½•æ—¶è¦æ±‚æˆ‘ä»¬è¾“å…¥å¯†ç ã€‚ è§£å¯†sshå¯†é’¥ä¿¡æ¯ ä½¿ç”¨ssh2johnå°†id_rsaç§˜é’¥ä¿¡æ¯è½¬æ¢ä¸ºjohnå¯ä»¥è¯†åˆ«çš„ä¿¡æ¯ã€‚(å®‰è£…:https://github.com/koboi137/john) 12chmod 600 id_rsa/opt/john/ssh2john.py id_rsa &gt; rsacrack åˆ©ç”¨å­—å…¸è§£å¯†rsacrackä¿¡æ¯ã€‚ 1zcat /usr/share/wordlists/rockyou.txt.gz | john --pipe --rules rsacrack å¾—åˆ°å¯†ç ï¼šstarwars æˆåŠŸè¿œç¨‹ç™»å½•ï¼pwdæŸ¥çœ‹ä¸‹å½“å‰ç›®å½•ï¼ŒlsæŸ¥çœ‹ä¸‹å½“å‰ç›®å½•æ–‡ä»¶ï¼Œå‘çŽ°å¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„ã€‚è¿™æ—¶å€™æˆ‘ä»¬åº”è¯¥æƒ³åˆ°åŽ»è®¿é—®rootç›®å½•ã€‚è®¿é—®ä¹‹åŽç¡®å®žå‘çŽ°äº†flag.txtï¼Œä½†æ˜¯æˆ‘ä»¬ç¡®æ²¡æœ‰æƒé™è®¿é—®ï¼Œè¿™æ—¶å€™å°±æ˜¯å¦‚ä½•ææƒçš„é—®é¢˜äº†ã€‚ æå‡æƒé™ æŸ¥æ‰¾å…·æœ‰rootæƒé™çš„æ–‡ä»¶ï¼š 1find / -perm -4000 2&gt;dev/null è¿™æ¡å‘½ä»¤æ˜¯ä»Žæ ¹ç›®å½•å¼€å§‹æŸ¥æ‰¾ï¼Œçœ‹å“ªäº›å‘½ä»¤æ˜¯å…·æœ‰æ‰§è¡Œæƒé™çš„ã€‚å…¶ä¸­2&gt;dev/nullç”¨äºŽé˜²æ­¢é”™è¯¯ä¿¡æ¯ã€‚ å‘çŽ°æœ‰ä¸€æ¡å‘½ä»¤æ˜¯read_messageï¼Œè€Œæˆ‘ä»¬ç›®å½•ä¸‹åˆšå¥½æœ‰ä¸ªread_message.cæ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ï¼Œå‘çŽ°ç¬¬äºŒä¸ªflagå’Œä¸€æ®µcä»£ç ã€‚ ä»Žcä»£ç å¯ä»¥çœ‹å‡ºï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯è¾“å…¥ä¸€æ®µæ–‡å­—å’Œå·²çŸ¥å­—ç¬¦ä¸²simonè¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸè¾“å‡ºä¸€æ®µæ–‡å­—å’Œmessageç›®å½•ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶ã€‚æˆ‘ä»¬å¦‚æžœè¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º20çš„æ•°ç»„ï¼Œå¦‚æžœæº¢å‡ºä¼šä¸ä¼šæ‰§è¡Œã€‚ è¾“å…¥SimonåŒ¹é…cï¼Œå†åŠ å…¥åäº”ä¸ªå­—ç¬¦ï¼Œæœ€åŽå†æŽ¥/bin/shæå‡æƒé™ã€‚ æˆåŠŸææƒï¼Œç„¶åŽæˆ‘ä»¬ç”¨ææƒåŽçš„ç”¨æˆ·åŽ»è®¿é—®ä¹‹å‰çš„flag.txtï¼Œæ‹¿åˆ°ç¬¬ä¸‰ä¸ªflagã€‚]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>ssh</tag>
        <tag>kali linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CTF Chapter-1 Introduction]]></title>
    <url>%2F2019%2F07%2F29%2FCTF-Chapter-1-Introduction%2F</url>
    <content type="text"><![CDATA[ä»‹ç» CTF(Capture the Flag)æ˜¯å½“ä¸‹ä¸€ç§æµè¡Œçš„ä¿¡æ¯å®‰å…¨ç«žèµ›å½¢å¼ã€‚å…¶å¤§è‡´æµç¨‹æ˜¯ï¼Œå‚æ•°å›¢é˜Ÿä¹‹é—´é€šè¿‡è¿›è¡Œæ”»é˜²å¯¹æŠ—ã€ç¨‹åºåˆ†æžç­‰å½¢å¼ï¼ŒçŽ‡å…ˆä»Žä¸»åŠžæ–¹ç»™å‡ºçš„æ¯”èµ›çŽ¯å¢ƒä¸­å¾—åˆ°ä¸€ä¸²å…·æœ‰ä¸€å®šæ ¼å¼çš„å­—ç¬¦ä¸²æˆ–å…¶ä»–å†…å®¹ï¼Œå¹¶å°†å…¶æäº¤ç»™ä¸»åŠžæ–¹ï¼Œä»Žè€Œå¤ºå¾—åˆ†æ•°ã€‚æˆ‘ä»¬æŠŠè¿™æ ·çš„å†…å®¹ç§°ä¹‹ä¸º"Flag"ã€‚ å®žéªŒçŽ¯å¢ƒï¼š æ”»å‡»æœºï¼škali linux é¶åœºæœºå™¨ï¼šlinux ç›®çš„ï¼šèŽ·å–é¶åœºæœºå™¨ä¸Šçš„flagå€¼ã€‚ æ¯”èµ›çŽ¯å¢ƒçš„ä¸¤ç§æ–¹å¼ï¼š ç»™äºˆåœ¨åŒä¸€å±€åŸŸç½‘ä¸­çš„æ”»å‡»æœºå’Œé¶åœºæœºå™¨ï¼Œä»¥webæ–¹å¼å¯ä»¥è®¿é—®æ”»å‡»æœºï¼Œé€šè¿‡æ”»å‡»æœºæ¥æ¸—é€é¶åœºæœºå™¨ï¼ŒèŽ·å–å¯¹åº”çš„flagå€¼ã€‚ ç»™äºˆä¸€ä¸ªç½‘çº¿æŽ¥å£ï¼Œç›´æŽ¥è¿žæŽ¥ç½‘çº¿ï¼Œè¿›è¡Œæ¸—é€é¶åœºæœºå™¨ï¼ŒèŽ·å–å¯¹åº”çš„flagå€¼ã€‚ çŽ¯å¢ƒæ­å»º å®‰è£…è½¯ä»¶ï¼šVMã€Virtual box åˆ›å»ºé¶åœºæœºå™¨åŽï¼Œé¶åœºæœºå™¨è¦æ±‚ç™»é™†ï¼Œå¯æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰ç”¨æˆ·åå’Œå¯†ç ã€‚å¦‚æžœä¸è¿›è¡Œç™»é™†ï¼Œåˆå¦‚ä½•èŽ·å¾—é¶åœºæœºå™¨çš„IPåœ°å€ï¼Ÿ è¿™é‡Œæˆ‘ä»¬åœ¨kaliä¸­å…ˆä½¿ç”¨ifconfigå‘½ä»¤å–åˆ°å½“å‰IPåœ°å€ä¸º192.168.50.180ï¼Œ ç„¶åŽä½¿ç”¨netdiscoverå‘½ä»¤netdiscover -r ip/netmaskæ¥å¯¹é¶åœºæœºå™¨çš„IPè¿›è¡ŒæŽ¢æµ‹ã€‚ 1netdiscover -r 192.168.50.1/24 å¯ä»¥çœ‹åˆ°é¶åœºæœºå™¨çš„IPä¸ºï¼š192.168.50.112 åœ¨å¾—åˆ°äº†IPä¹‹åŽï¼Œæˆ‘ä»¬è¿˜éœ€è¦æµ‹è¯•è¿žé€šæ€§ï¼Œä½¿ç”¨pingå‘½ä»¤è¿›è¡Œæµ‹è¯•ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›žäº†å¯¹åº”çš„æ•°æ®åŒ…ï¼Œè¡¨æ˜Žå½“å‰æœºå™¨å’Œé¶åœºæœºå™¨æ˜¯è¿žé€šçš„ã€‚å¦‚æžœæ²¡æœ‰è¿”å›žå¯¹åº”å€¼ï¼Œé‚£ä¹ˆé¶åœºå¼€å¯äº†é˜²ç«å¢™ã€‚]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>kali linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MachineLearning Chapter-4 K-Nearest Neighbor]]></title>
    <url>%2F2019%2F07%2F28%2FMachineLearning-Chapter-4-K-Nearest-Neighbor%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿° kè¿‘é‚»æ³•(k-Nearest Neighbor, kNN)æ˜¯æœºå™¨å­¦ä¹ æ‰€æœ‰ç®—æ³•ä¸­ç†è®ºæœ€ç®€å•ï¼Œæœ€å¥½ç†è§£çš„ç®—æ³•ã€‚å®ƒæ˜¯ä¸€ç§åŸºæœ¬çš„åˆ†ç±»ä¸Žå›žå½’æ–¹æ³•ï¼Œå®ƒçš„è¾“å…¥ä¸ºå®žä¾‹çš„ç‰¹å¾å‘é‡ï¼Œé€šè¿‡è®¡ç®—æ–°æ•°æ®ä¸Žè®­ç»ƒæ•°æ®ç‰¹å¾å€¼ä¹‹é—´çš„è·ç¦»ï¼Œç„¶åŽé€‰å–\(K(Kâ‰¥1)\)ä¸ªè·ç¦»æœ€è¿‘çš„é‚»å±…è¿›è¡Œåˆ†ç±»åˆ¤æ–­(æŠ•ç¥¨æ³•)æˆ–è€…å›žå½’ã€‚å¦‚æžœ\(K=1\)ï¼Œé‚£ä¹ˆæ–°æ•°æ®è¢«ç®€å•åœ°åˆ†é…ç»™å…¶è¿‘é‚»çš„ç±»ã€‚ å¯¹äºŽåˆ†ç±»é—®é¢˜ï¼šè¾“å‡ºä¸ºå®žä¾‹çš„ç±»åˆ«ã€‚åˆ†ç±»æ—¶ï¼Œå¯¹äºŽæ–°çš„å®žä¾‹ï¼Œæ ¹æ®å…¶\(k\)ä¸ªæœ€è¿‘é‚»çš„è®­ç»ƒå®žä¾‹çš„ç±»åˆ«ï¼Œé€šè¿‡å¤šæ•°è¡¨å†³ç­‰æ–¹å¼è¿›è¡Œé¢„æµ‹ã€‚ å¯¹äºŽå›žå½’é—®é¢˜ï¼šè¾“å‡ºä¸ºå®žä¾‹çš„å€¼ã€‚å›žå½’æ—¶ï¼Œå¯¹äºŽæ–°çš„å®žä¾‹ï¼Œå–å…¶\(k\)ä¸ªæœ€è¿‘é‚»çš„è®­ç»ƒå®žä¾‹çš„å¹³å‡å€¼ä¸ºé¢„æµ‹å€¼ã€‚ kè¿‘é‚»æ³•åˆ†ç±»çš„ç›´è§‚ç†è§£ï¼šç»™å®šä¸€ä¸ªè®­ç»ƒæ•°æ®é›†ï¼Œå¯¹äºŽæ–°çš„è¾“å…¥å®žä¾‹ï¼Œåœ¨è®­ç»ƒé›†ä¸­æ‰¾åˆ°ä¸Žè¯¥å®žä¾‹æœ€é‚»è¿‘çš„\(k\)ä¸ªå®žä¾‹ã€‚è¿™\(k\)ä¸ªå®žä¾‹çš„å¤šæ•°å±žäºŽæŸä¸ªç±»åˆ«ï¼Œåˆ™è¯¥è¾“å…¥å®žä¾‹å°±åˆ’åˆ†ä¸ºè¿™ä¸ªç±»åˆ«ã€‚ kè¿‘é‚»æ³•ä¸å…·æœ‰æ˜¾å¼çš„å­¦ä¹ è¿‡ç¨‹ï¼Œå®ƒæ˜¯ç›´æŽ¥é¢„æµ‹ã€‚å®žé™…ä¸Šå®ƒæ˜¯åˆ©ç”¨è®­ç»ƒæ•°æ®é›†å¯¹ç‰¹å¾å‘é‡ç©ºé—´è¿›è¡Œåˆ’åˆ†ï¼Œå¹¶ä¸”ä½œä¸ºå…¶åˆ†ç±»çš„â€œæ¨¡åž‹â€ã€‚ ç®—æ³• KNNä¸‰è¦ç´  kè¿‘é‚»æ³•çš„ä¸‰è¦ç´ ï¼š\(k\)å€¼é€‰æ‹©ã€è·ç¦»åº¦é‡å’Œåˆ†ç±»å†³ç­–è§„åˆ™(å³å‡å€¼çš„å†³ç­–è§„åˆ™)ã€‚ kå€¼é€‰æ‹© å½“\(k=1\)æ—¶çš„kè¿‘é‚»ç®—æ³•ç§°ä¸ºæœ€è¿‘é‚»ç®—æ³•ã€‚æ­¤æ—¶å°†è®­ç»ƒé›†ä¸­ä¸Ž\(\vec{x}\)æœ€è¿‘çš„ç‚¹ç‚¹ç±»åˆ«ä½œä¸º\(\vec{x}\)çš„åˆ†ç±»ã€‚ \(k\)å€¼çš„é€‰æ‹©ä¼šå¯¹kè¿‘é‚»æ³•çš„ç»“æžœäº§ç”Ÿé‡å¤§å½±å“ã€‚ è‹¥\(k\)å€¼è¾ƒå°ï¼Œåˆ™ç›¸å½“äºŽç”¨è¾ƒå°çš„é‚»åŸŸä¸­çš„è®­ç»ƒå®žä¾‹è¿›è¡Œé¢„æµ‹ï¼Œå­¦ä¹ çš„è¿‘ä¼¼è¯¯å·®å‡å°ã€‚ ä¼˜ç‚¹ï¼šåªæœ‰ä¸Žè¾“å…¥å®žä¾‹è¾ƒè¿‘çš„è®­ç»ƒå®žä¾‹æ‰ä¼šå¯¹é¢„æµ‹èµ·ä½œç”¨ã€‚ ç¼ºç‚¹ï¼šå­¦ä¹ çš„ä¼°è®¡è¯¯å·®ä¼šå¢žå¤§ï¼Œé¢„æµ‹ç»“æžœä¼šå¯¹è¿‘é‚»çš„å®žä¾‹ç‚¹éžå¸¸æ•æ„Ÿã€‚è‹¥è¿‘é‚»çš„è®­ç»ƒå®žä¾‹ç‚¹åˆšå¥½æ˜¯å™ªå£°ï¼Œåˆ™é¢„æµ‹ä¼šå‡ºé”™ã€‚å³\(k\)å€¼çš„å‡å°æ„å‘³ç€æ¨¡åž‹æ•´ä½“å˜å¤æ‚ï¼Œæ˜“å‘ç”Ÿè¿‡æ‹Ÿåˆã€‚ è‹¥\(k\)å€¼è¾ƒå¤§ï¼Œåˆ™ç›¸å½“äºŽç”¨è¾ƒå¤§çš„é‚»åŸŸä¸­çš„è®­ç»ƒå®žä¾‹è¿›è¡Œé¢„æµ‹ã€‚ ä¼˜ç‚¹ï¼šå‡å°‘å­¦ä¹ çš„ä¼°è®¡è¯¯å·®ã€‚ ç¼ºç‚¹ï¼šå­¦ä¹ çš„è¿‘ä¼¼è¯¯å·®ä¼šå¢žå¤§ã€‚è¿™æ—¶è¾“å…¥å®žä¾‹è¾ƒè¿œçš„è®­ç»ƒå®žä¾‹ä¹Ÿä¼šå¯¹é¢„æµ‹èµ·ä½œç”¨ï¼Œä½¿é¢„æµ‹å‘ç”Ÿé”™è¯¯ï¼Œå³\(k\)å€¼å¢žå¤§æ„å‘³ç€æ¨¡åž‹çš„æ•´ä½“å˜ç®€å•ã€‚å½“\(k=N\)æ—¶ï¼Œæ— è®ºè¾“å…¥å®žä¾‹æ˜¯ä»€ä¹ˆï¼Œéƒ½å°†å®ƒé¢„æµ‹ä¸ºè®­ç»ƒå®žä¾‹ä¸­æœ€å¤šçš„ç±»ï¼ˆå³é¢„æµ‹ç»“æžœæ˜¯ä¸€ä¸ªå¸¸é‡ï¼‰ã€‚æ­¤æ—¶æ¨¡åž‹è¿‡äºŽç®€å•ï¼Œå®Œå…¨å¿½ç•¥äº†è®­ç»ƒå®žä¾‹ä¸­å¤§é‡æœ‰ç”¨çš„ä¿¡æ¯ã€‚ åº”ç”¨ä¸­ï¼Œ\(k\)å€¼ä¸€èˆ¬å–ä¸€ä¸ªè¾ƒå°çš„æ•°å€¼ã€‚é€šå¸¸é‡‡ç”¨äº¤å‰éªŒè¯æ³•æ¥é€‰å–æœ€ä¼˜çš„\(k\)å€¼ï¼Œå°±æ˜¯æ¯”è¾ƒä¸åŒ\(k\)å€¼æ—¶çš„äº¤å‰éªŒè¯å¹³å‡è¯¯å·®çŽ‡ï¼Œé€‰æ‹©è¯¯å·®çŽ‡æœ€å°çš„é‚£ä¸ª\(k\)å€¼ã€‚ è·ç¦»åº¦é‡ kNNç®—æ³•è¦æ±‚æ•°æ®çš„æ‰€æœ‰ç‰¹å¾éƒ½å¯ä»¥åšå¯æ¯”è¾ƒçš„é‡åŒ–ã€‚è‹¥åœ¨æ•°æ®ç‰¹å¾ä¸­å­˜åœ¨éžæ•°å€¼çš„ç±»åž‹ï¼Œå¿…é¡»é‡‡å–æ‰‹æ®µå°†å…¶é‡åŒ–ä¸ºæ•°å€¼ã€‚æ¯”å¦‚ï¼Œå¦‚æžœæ ·æœ¬ç‰¹å¾ä¸­åŒ…å«é¢œè‰²(çº¢ã€é»‘ã€è“)ä¸€é¡¹ï¼Œé¢œè‰²ä¹‹é—´æ˜¯æ²¡æœ‰è·ç¦»å¯è¨€çš„ï¼Œå¯é€šè¿‡å°†é¢œè‰²è½¬æ¢ä¸ºç°åº¦å€¼æ¥å®žçŽ°è·ç¦»è®¡ç®—ã€‚å¦å¤–ï¼Œæ ·æœ¬æœ‰å¤šä¸ªå‚æ•°ï¼Œæ¯ä¸€ä¸ªå‚æ•°éƒ½æœ‰è‡ªå·±çš„å®šä¹‰åŸŸå’Œå–å€¼èŒƒå›´ï¼Œå®ƒä»¬å¯¹è·ç¦»è®¡ç®—çš„å½±å“ä¹Ÿå°±ä¸ä¸€æ ·ï¼Œå¦‚å–å€¼è¾ƒå¤§çš„å½±å“åŠ›ä¼šç›–è¿‡å–å€¼è¾ƒå°çš„å‚æ•°ã€‚ä¸ºäº†å…¬å¹³ï¼Œæ ·æœ¬å‚æ•°å¿…é¡»åšä¸€äº›å½’ä¸€åŒ–å¤„ç†ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æ‰€æœ‰ç‰¹å¾çš„æ•°å€¼éƒ½é‡‡å–å½’ä¸€åŒ–å¤„ç½®ã€‚ ç‰¹å¾ç©ºé—´ä¸­ä¸¤ä¸ªå®žä¾‹ç‚¹çš„è·ç¦»æ˜¯ä¸¤ä¸ªå®žä¾‹ç‚¹ç›¸ä¼¼ç¨‹åº¦çš„åæ˜ ã€‚kè¿‘é‚»æ¨¡åž‹çš„ç‰¹å¾ç©ºé—´ä¸€èˆ¬æ˜¯\(n\)ç»´å®žæ•°å‘é‡ç©ºé—´\(R^n\)ã€‚kè¿‘é‚»æ¨¡åž‹çš„ç‰¹å¾ç©ºé—´çš„è·ç¦»ä¸€èˆ¬ä¸ºæ¬§æ°è·ç¦»ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€èˆ¬\(L_p\)è·ç¦»ï¼š \[L_p(\vec{x}_i,\vec{x}_j)=(\sum_{l=1}^n|x_i^{(l)}-x_j^{(l)}|^p)^{1/p} \\ \vec{x}_i,\vec{x}_j\in ð’³=R^n \\ \vec{x}_i=(x_i^{(1)},x_i^{(2)},â€¦,x_i^{(n)})^T \\ \vec{x}_j=(x_j^{(1)},x_j^{(2)},â€¦,x_j^{(n)})^T \\ pâ‰¥1\] å½“\(p=2\)æ—¶ï¼Œä¸ºæ¬§æ°è·ç¦»ï¼š\(L_2(\vec{x}_i,\vec{x}_j)=(\sum_{l=1}^n|x_i^{(l)}-x_j^{(l)}|^2)^{1/2}\) å½“\(p=1\)æ—¶ï¼Œä¸ºæ›¼å“ˆé¡¿è·ç¦»ï¼š\(L_1(\vec{x}_i,\vec{x}_j)=\sum_{l=1}^n|x_i^{(l)}-x_j^{(l)}|\) å½“\(p=âˆž\)æ—¶ï¼Œä¸ºå„ç»´åº¦è·ç¦»ä¸­çš„æœ€å¤§å€¼ï¼š\(L_âˆž(\vec{x}_i,\vec{x}_j)=\max_l|x_i^{(l)}-x_j^{(l)}|\) ä¸åŒçš„è·ç¦»åº¦é‡æ‰€ç¡®å®šçš„æœ€è¿‘é‚»ç‚¹æ˜¯ä¸åŒçš„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé€‰æ¬§æ°è·ç¦»ä½œä¸ºè·ç¦»åº¦é‡ï¼Œä½†è¿™åªé€‚ç”¨äºŽè¿žç»­å˜é‡ã€‚åœ¨æ–‡æœ¬åˆ†ç±»è¿™ç§éžè¿žç»­å˜é‡æƒ…å†µä¸‹ï¼Œæ±‰æ˜Žè·ç¦»å¯ä»¥ç”¨æ¥ä½œä¸ºåº¦é‡ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æžœè¿ç”¨ä¸€äº›ç‰¹æ®Šçš„ç®—æ³•æ¥è®¡ç®—åº¦é‡çš„è¯ï¼ŒKè¿‘é‚»åˆ†ç±»çš„ç²¾åº¦å¯æ˜¾è‘—æé«˜ï¼Œå¦‚è¿ç”¨å¤§è¾¹ç¼˜æœ€è¿‘é‚»æ³•æˆ–è€…è¿‘é‚»æˆåˆ†åˆ†æžæ³•ã€‚ åˆ†ç±»å†³ç­–è§„åˆ™ åˆ†ç±»å†³ç­–é€šå¸¸é‡‡ç”¨å¤šæ•°è¡¨å†³ã€‚ä¹Ÿå¯ä»¥åŸºäºŽè·ç¦»çš„è¿œè¿‘è¿›è¡ŒåŠ æƒæŠ•ç¥¨ï¼Œè·ç¦»è¶Šè¿‘çš„æ ·æœ¬æƒé‡è¶Šå¤§ã€‚ å¤šæ•°è¡¨å†³è§„åˆ™ç­‰ä»·äºŽç»éªŒé£Žé™©æœ€å°åŒ–ã€‚è®¾åˆ†ç±»çš„æŸå¤±å‡½æ•°ä¸º0-1æŸå¤±å‡½æ•°ï¼Œåˆ†ç±»å‡½æ•°ä¸º\(f\)ï¼š\(R^n\to \{c_1,c_2,â€¦,c_K\}\)ï¼Œè¯¯åˆ†ç±»æ¦‚çŽ‡ä¸ºï¼š\(P(Yâ‰ f(X))=1-P(Y=f(X))\)ã€‚ ç»™å®šå®žä¾‹\(\vec{x}\in ð’³\)ï¼Œå…¶æœ€é‚»è¿‘çš„\(k\)ä¸ªè®­ç»ƒç‚¹æž„æˆé›†åˆ\(N_k(\vec{x})\)ã€‚è®¾æ¶µç›–\(N_k(\vec{x})\)åŒºåŸŸç‚¹ç±»åˆ«ä¸º\(c_j\)ï¼ˆè¿™æ˜¯ä¸ªå¾…æ±‚çš„æœªçŸ¥é‡ï¼Œä½†å®ƒè‚¯å®šæ˜¯\(c_1,c_2,â€¦,c_K\)ä¹‹ä¸€ï¼‰ï¼Œåˆ™è¯¯åˆ†ç±»çŽ‡ä¸ºï¼š \[\frac{1}{k}\sum_{\vec{x}_i\in N_k(\vec{x})}I(y_iâ‰ c_j)=1-\frac{1}{k}\sum_{\vec{x}_i\in N_k(\vec{x})}I(y_i=c_j)\] è¯¯åˆ†ç±»çŽ‡å°±æ˜¯è®­ç»ƒæ•°æ®çš„ç»éªŒé£Žé™©ã€‚è¦ä½¿è¯¯åˆ†ç±»çŽ‡æœ€å°ï¼Œå³ç»éªŒé£Žé™©æœ€å°ï¼Œå°±è¦ä½¿å¾—\(\sum_{\vec{x}_i\in N_k(\vec{x})}I(y_i=c_j)\)æœ€å¤§ã€‚å³å¤šæ•°è¡¨å†³ï¼š \[c_j=\arg \max_{c_j}\sum_{\vec{x}_i\in N_k(\vec{x})}I(y_i=c_j)\] kè¿‘é‚»ç®—æ³• kè¿‘é‚»ç®—æ³•çš„åˆ†ç±»ç®—æ³•æè¿°å¦‚ä¸‹ï¼š è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›†\(T=\{(\vec{x}_1,y_1),(\vec{x}_2,y_2),â€¦,(\vec{x}_N,y_N)\}\), \(\vec{x}_i\in ð’³ \subseteq R^n\)ä¸ºå®žä¾‹çš„ç‰¹å¾å‘é‡ï¼Œ\(y_i\in ð’´ =\{c_1,c_2,â€¦,c_K\}\)ä¸ºå®žä¾‹çš„ç±»åˆ«ï¼Œ\(i=1,2,â€¦,N\)ã€‚ç»™å®šå®žä¾‹ç‰¹å¾å‘é‡\(\vec{x}\)ã€‚ è¾“å‡ºï¼šå®žä¾‹\(\vec{x}\)æ‰€å±žçš„ç±»åˆ«\(y\)ã€‚ æ­¥éª¤ï¼š æ ¹æ®ç»™å®šçš„è·ç¦»åº¦é‡ï¼Œåœ¨\(T\)ä¸­å¯»æ‰¾ä¸Ž\(\vec{x}\)æœ€è¿‘é‚»çš„\(k\)ä¸ªç‚¹ã€‚å®šä¹‰æ¶µç›–è¿™\(k\)ä¸ªç‚¹çš„\(\vec{x}\)çš„é‚»åŸŸè®°ä½œ\(N_k(\vec{x})\)ã€‚ ä»Ž\(N_k(\vec{x})\)ä¸­ï¼Œæ ¹æ®åˆ†ç±»å†³ç­–è§„åˆ™ï¼ˆå¦‚å¤šæ•°è¡¨å†³ï¼‰å†³å®š\(\vec{x}\)çš„ç±»åˆ«\(y\)ï¼š\[y=\arg \max_{c_j}\sum_{\vec{x}_i\in N_k(\vec{x})}I(y_i=c_j),i=1,2,â€¦,N;j=1,2,â€¦,K\]å…¶ä¸­\(I\)ä¸ºæŒ‡ç¤ºå‡½æ•°ï¼š\(I(true)=1,I(false)=0\)ã€‚ä¸Šå¼ä¸­ï¼Œå¯¹äºŽ\(y_i,i=1,2,â€¦,N\)åªæœ‰\(\vec{x}_i\in N_k(\vec{x})\)ä¸­çš„æ ·æœ¬ç‚¹æ‰è€ƒè™‘ã€‚ kè¿‘é‚»æ³•çš„å­¦ä¹ æœ‰ä¸€ä¸ªæ˜Žæ˜¾çš„ç‰¹ç‚¹ï¼šå®ƒæ²¡æœ‰æ˜¾å¼çš„è®­ç»ƒè¿‡ç¨‹ã€‚å®ƒåœ¨è®­ç»ƒé˜¶æ®µä»…ä»…å°†æ ·æœ¬ä¿å­˜èµ·æ¥ï¼Œè®­ç»ƒæ—¶é—´å¼€é”€ä¸ºé›¶ï¼Œç­‰åˆ°æ”¶åˆ°æµ‹è¯•æ ·æœ¬åŽå†è¿›è¡Œå¤„ç†ã€‚ kdæ ‘ kè¿‘é‚»æ³•ä¸­å¦‚ä½•å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œå¿«é€Ÿkè¿‘é‚»æœç´¢æ˜¯ä¸ªé—®é¢˜ã€‚æœ€ç®€å•ç²—æš´çš„åŠžæ³•æ˜¯ï¼šçº¿æ€§æ‰«æã€‚é€šè¿‡è®¡ç®—è¾“å…¥æ ·æœ¬ä¸Žæ¯ä¸ªè®­ç»ƒæ ·æœ¬çš„è·ç¦»ï¼Œæ¥æ‰¾å‡ºæœ€è¿‘é‚»çš„\(k\)ä¸ªè®­ç»ƒæ ·æœ¬ã€‚å½“è®­ç»ƒé›†å¾ˆå¤§æ—¶ï¼Œè®¡ç®—éžå¸¸è€—æ—¶ã€‚å¸¸ç”¨çš„è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨kdæ ‘ï¼Œå®ƒå¯ä»¥å¤§å¹…æé«˜\(k\)è¿‘é‚»æœç´¢çš„æ•ˆçŽ‡ã€‚ kdæ ‘æ˜¯äºŒå‰æ ‘ï¼Œè¡¨ç¤ºå¯¹\(k\)ç»´ç©ºé—´çš„ä¸€ä¸ªåˆ’åˆ†ã€‚æž„é€ å¹³è¡¡kdæ ‘çš„ç®—æ³•å¦‚ä¸‹ï¼š è¾“å…¥ï¼š\(k\)ç»´ç©ºé—´æ•°æ®é›†\(T=\{\vec{x}_1,\vec{x}_2,â€¦,\vec{x}_N\},\vec{x}_i\in ð’³ \subseteq R^k\) è¾“å‡ºï¼škdæ ‘ ç®—æ³•æ­¥éª¤ï¼š å¼€å§‹ï¼šæž„é€ æ ¹èŠ‚ç‚¹ã€‚é€‰æ‹©\(x^{(1)}\)ä¸ºè½´ï¼Œä»¥\(T\)ä¸­æ‰€æœ‰æ ·æœ¬çš„\(x^{(1)}\)åæ ‡çš„ä¸­ä½æ•°\(x^{(1)*}\)ä½œä¸ºåˆ‡åˆ†ç‚¹ï¼Œå°†æ ¹èŠ‚ç‚¹çš„è¶…çŸ©å½¢åˆ‡åˆ†æˆä¸¤ä¸ªå­åŒºåŸŸï¼ˆåˆ‡åˆ†è¶…å¹³é¢\(x^{(1)}=x^{(1)*}\)ï¼‰ã€‚æœ¬æ¬¡åˆ‡åˆ†äº§ç”Ÿæ·±åº¦ä¸º1çš„å·¦ã€å³å­èŠ‚ç‚¹ã€‚å·¦å­èŠ‚ç‚¹å¯¹åº”äºŽåæ ‡\(x^{(1)}&lt;x^{(1)*}\)çš„å­åŒºåŸŸï¼›å³å­èŠ‚ç‚¹å¯¹åº”äºŽåæ ‡\(x^{(1)}&gt;x^{(1)*}\)çš„å­åŒºåŸŸï¼›è½åœ¨åˆ‡åˆ†è¶…å¹³é¢ä¸Šçš„ç‚¹ï¼ˆ\(x^{(1)}=x^{(1)*}\)ï¼‰ä¿å­˜åœ¨æ ¹èŠ‚ç‚¹ã€‚ é‡å¤ï¼šå¯¹æ·±åº¦ä¸º\(j\)çš„å­èŠ‚ç‚¹ï¼Œé€‰æ‹©\(x^{(l)}\)ä¸ºåˆ‡åˆ†çš„åæ ‡è½´ï¼Œ\(l=j(\mod k)+1\)ã€‚æœ¬æ¬¡åˆ‡åˆ†ä¹‹åŽï¼Œæ ‘çš„æ·±åº¦ä¸º\(j+1\)ã€‚è¿™é‡Œå–æ¨¡ï¼Œè€Œä¸æ˜¯\(l=j+1\)ï¼Œæ˜¯å› ä¸ºæ ‘çš„æ·±åº¦å¯ä»¥è¶…è¿‡ç»´åº¦\(k\)ï¼Œæ­¤æ—¶åˆ‡åˆ†è½´åˆé‡å¤å›žåˆ°\(x^{(1)}\)ï¼Œè½®è½¬åæ ‡è½´è¿›è¡Œåˆ‡åˆ†ã€‚ ç»“æŸï¼šç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹çš„ä¸¤ä¸ªå­åŸŸä¸­æ²¡æœ‰æ ·æœ¬å­˜åœ¨æ—¶ï¼Œåˆ‡åˆ†åœæ­¢ã€‚æ­¤æ—¶å¾—åˆ°kdæ ‘ã€‚ ä½¿ç”¨kdæ ‘çš„ç®—æ³•ç›¸å¯¹å¤æ‚ã€‚ç”¨kdæ ‘çš„æœ€è¿‘é‚»æœç´¢ç®—æ³•(kè¿‘é‚»æœç´¢ä¾æ¬¡ç±»æŽ¨)å¦‚ä¸‹ï¼š è¾“å…¥ï¼š kdæ ‘ æ ·æœ¬\(\vec{x}\) è¾“å‡ºï¼šæ ·æœ¬\(\vec{x}\)çš„æœ€è¿‘é‚»ç‚¹ æ­¥éª¤ï¼š åœ¨kdæ ‘ä¸­æ‰¾åˆ°åŒ…å«æµ‹è¯•ç‚¹\(\vec{x}\)çš„å¶èŠ‚ç‚¹ã€‚æ–¹æ³•æ˜¯ï¼šä»Žæ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œé€’å½’å‘ä¸‹è®¿é—®kdæ ‘ï¼š è‹¥æµ‹è¯•ç‚¹\(\vec{x}\)å½“å‰ç»´åº¦çš„åæ ‡å°äºŽåˆ‡åˆ†ç‚¹çš„åæ ‡ï¼Œåˆ™æŸ¥æ‰¾å½“å‰èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ è‹¥æµ‹è¯•ç‚¹\(\vec{x}\)å½“å‰ç»´åº¦çš„åæ ‡å¤§äºŽåˆ‡åˆ†ç‚¹çš„åæ ‡ï¼Œåˆ™æŸ¥æ‰¾å½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ï¼Œåœ¨è®¿é—®è¿‡ç¨‹ä¸­è®°å½•ä¸‹è®¿é—®çš„å„èŠ‚ç‚¹çš„é¡ºåºï¼ˆä»¥ä¾¿äºŽåŽé¢çš„å›žé€€ï¼‰ ä»¥æ­¤å¶èŠ‚ç‚¹ä¸ºâ€œå½“å‰æœ€è¿‘â€\(\vec{x}_{nst}\)ã€‚çœŸå®žæœ€è¿‘ç‚¹ä¸€å®šåœ¨\(\vec{x}\)ä¸Žâ€œå½“å‰æœ€è¿‘ç‚¹â€æž„æˆçš„è¶…çƒä½“å†…ã€‚\(\vec{x}\)ä¸ºçƒå¿ƒã€‚ è®¾å½“å‰è€ƒå¯Ÿçš„èŠ‚ç‚¹ä¸º\(\vec{x}_i\)ï¼Œé€’å½’å‘ä¸Šå›žé€€ï¼Œè®¾å›žé€€å¼¹å‡ºçš„èŠ‚ç‚¹ä¸º\(\vec{x}_{inew}\)ï¼ˆæ¯æ¬¡å›žé€€éƒ½æ˜¯é€€åˆ°kdæ ‘çš„çˆ¶èŠ‚ç‚¹ï¼‰ï¼Œè€ƒå¯ŸèŠ‚ç‚¹\(\vec{x}_{inew}\)æ‰€åœ¨çš„è¶…å¹³é¢ä¸Žä»¥\(\vec{x}\)ä¸ºçƒå¿ƒã€ä»¥\(\vec{x}\)åˆ°å½“å‰æœ€è¿‘ç‚¹\(\vec{x}_{nst}\)çš„è·ç¦»ä¸ºåŠå¾„çš„è¶…çƒä½“æ˜¯å¦ç›¸äº¤ï¼š è‹¥ç›¸äº¤ è‹¥\(\vec{x}\)æ˜¯\(\vec{x}_{inew}\)çš„å·¦å­èŠ‚ç‚¹ï¼Œåˆ™è¿›å…¥\(\vec{x}_{inew}\)çš„å³å­èŠ‚ç‚¹ï¼Œç„¶åŽå…ˆè¿›è¡Œå‘ä¸‹æœç´¢ï¼Œå†ç„¶åŽå‘ä¸Šå›žé€€ã€‚ è‹¥\(\vec{x}\)æ˜¯\(\vec{x}_{inew}\)çš„å³å­èŠ‚ç‚¹ï¼Œåˆ™è¿›å…¥\(\vec{x}_{inew}\)çš„å·¦å­èŠ‚ç‚¹ï¼Œç„¶åŽå…ˆè¿›è¡Œå‘ä¸‹æœç´¢ï¼Œå†ç„¶åŽå‘ä¸Šå›žé€€ã€‚ è‹¥ä¸ç›¸äº¤ï¼Œåˆ™ç›´æŽ¥å›žé€€ å½“å›žé€€åˆ°æ ¹èŠ‚ç‚¹æ—¶ï¼Œæœç´¢ç»“æŸã€‚æœ€åŽçš„â€œå½“å‰æœ€è¿‘ç‚¹â€å³ä¸º\(\vec{x}\)çš„æœ€è¿‘é‚»ç‚¹ã€‚ kdæ ‘æœç´¢çš„å¹³å‡è®¡ç®—å¤æ‚åº¦ä¸º\(O(\log N)\)ï¼Œ\(N\)ä¸ºè®­ç»ƒé›†å¤§å°ã€‚kdæ ‘é€‚åˆ\(N\gg k\)çš„æƒ…å½¢ã€‚å½“\(N\)ä¸Žç»´åº¦\(k\)æŽ¥è¿‘æ—¶ï¼Œæœç´¢çš„æ•ˆçŽ‡æŽ¥è¿‘çº¿æ€§æ‰«æã€‚ Pythonå®žæˆ˜ é¦–å…ˆå¯¼å…¥åŒ…ï¼š 123import numpy as npimport matplotlib.pyplot as pltfrom sklearn import neighbors, datasets, model_selection ç„¶åŽåŠ è½½æ•°æ®é›†ï¼š 1234567891011def load_classification_data(): digits = datasets.load_digits() X_train = digits.data y_train = digits.target return model_selection.train_test_split(X_train, y_train, test_size=0.25, random_state=0, stratify=y_train)def create_regression_data(n): X = 5 * np.random.rand(n, 1) y = np.sin(X).ravel() y[::5] += 1 * (0.5 - np.random.rand(int(n/5))) return model_selection.train_test_split(X, y, test_size=0.25, random_state=0) å…¶ä¸­ï¼Œload_classification_dataå‡½æ•°ä½¿ç”¨çš„æ˜¯scikit-learnè‡ªå¸¦çš„æ‰‹å†™è¯†åˆ«æ•°æ®é›†DigitDatasetã€‚è¯¥æ•°æ®é›†ç”±1797å¼ æ ·æœ¬å›¾ç‰‡ç»„æˆã€‚æ¯å¼ æ ·æœ¬å›¾ç‰‡éƒ½æ˜¯ä¸€ä¸ª\(8 \times 8\)å¤§å°çš„æ‰‹å†™æ•°å­—ä½å›¾ã€‚create_regression_dataå‡½æ•°æ˜¯åœ¨sin(X)åŸºç¡€ä¸Šæ·»åŠ å™ªå£°ç”Ÿæˆçš„ã€‚ KNNåˆ†ç±»(KNeighborsClassifier) scikit-learnä¸­æä¾›äº†ä¸€ä¸ªKNeighborsClassifierç±»æ¥å®žçŽ°kè¿‘é‚»æ³•åˆ†ç±»æ¨¡åž‹ï¼Œå…¶åŽŸåž‹ä¸ºï¼š 1234sklearn.neighbors.KNeighborsClassifier(n_neighbors=5, weights=&apos;uniform&apos;, algorithm=&apos;auto&apos;, leaf_size=30, p=2, metric=&apos;minkowski&apos;, metric_params=None, n_jobs=None, **kwargs) å‚æ•°ï¼š n_neighborsï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®š\(k\)å€¼ã€‚ weightsï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…å¯è°ƒç”¨å¯¹è±¡ï¼ŒæŒ‡å®šæŠ•ç¥¨æƒé‡ç±»åž‹ã€‚ 'uniform'ï¼šæœ¬èŠ‚ç‚¹çš„æ‰€æœ‰é‚»å±…èŠ‚ç‚¹çš„æŠ•ç¥¨æƒé‡éƒ½ç›¸ç­‰ã€‚ 'distance'ï¼šæœ¬èŠ‚ç‚¹çš„æ‰€æœ‰é‚»å±…èŠ‚ç‚¹çš„æŠ•ç¥¨æƒé‡ä¸Žè·ç¦»æˆåæ¯”ã€‚ [callable]ï¼šä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ã€‚å®ƒä¼ å…¥è·ç¦»çš„æ•°ç»„ï¼Œè¿”å›žåŒæ ·å½¢çŠ¶çš„æƒé‡æ•°ç»„ã€‚ algorithmï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šè®¡ç®—æœ€è¿‘é‚»çš„ç®—æ³•ã€‚ 'ball_tree'ï¼šä½¿ç”¨BallTreeç®—æ³• 'kd_tree'ï¼šä½¿ç”¨KDTreeç®—æ³• 'brute'ï¼šä½¿ç”¨æš´åŠ›æœç´¢æ³• 'auto'ï¼šè‡ªåŠ¨å†³å®šæœ€åˆé€‚çš„ç®—æ³• leaf_sizeï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šBallTreeæˆ–è€…KDTreeå¶èŠ‚ç‚¹è§„æ¨¡ã€‚å®ƒå½±å“æ ‘çš„æž„å»ºå’ŒæŸ¥è¯¢é€Ÿåº¦ã€‚ metricï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šè·ç¦»åº¦é‡ã€‚é»˜è®¤ä¸º'minkowski'è·ç¦»ã€‚ pï¼šæ•´æ•°å€¼ï¼ŒæŒ‡å®šåœ¨'Minkowski'åº¦é‡ä¸Šçš„æŒ‡æ•°ã€‚å¦‚æžœp=1ï¼Œå¯¹åº”æ›¼å“ˆé¡¿è·ç¦»ï¼›å¦‚æžœp=2ï¼Œå¯¹åº”æ¬§æ‹‰è·ç¦»ã€‚ n_jobsï¼šå¹¶è¡Œæ€§ã€‚é»˜è®¤ä¸º-1ï¼Œè¡¨ç¤ºæ´¾å‘ä»»åŠ¡åˆ°æ‰€æœ‰è®¡ç®—æœºçš„CPUä¸Šã€‚ æ–¹æ³•ï¼š fit(X, y): è®­ç»ƒæ¨¡åž‹ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žå¾…é¢„æµ‹æ ·æœ¬çš„æ ‡è®° score(X, y): è¿”å›žåœ¨(X, y)ä¸Šé¢„æµ‹çš„å‡†ç¡®çŽ‡ predict_proba(X): è¿”å›žæ ·æœ¬ä¸ºæ¯ç§æ ‡è®°çš„æ¦‚çŽ‡ kneighbors([X, n_neighbors, return_distance]): è¿”å›žæ ·æœ¬ç‚¹çš„\(k\)è¿‘é‚»ç‚¹ã€‚å¦‚æžœreturn_distance=Trueï¼ŒåŒæ—¶è¿˜è¿”å›žåˆ°è¿™äº›è¿‘é‚»ç‚¹çš„è·ç¦»ã€‚ kneighbors_graph([X, n_neighbors, mode]): è¿”å›žæ ·æœ¬ç‚¹çš„è¿žæŽ¥å›¾ é¦–å…ˆä½¿ç”¨KNeighborsClassifierï¼š 123456def demo_KNeighborsClassifier(*data): X_train, X_test, y_train, y_test = data clf = neighbors.KNeighborsClassifier() clf.fit(X_train, y_train) print(&quot;Training score: %f&quot; % clf.score(X_train, y_train)) print(&quot;Testing score: %f&quot; % clf.score(X_test, y_test)) è°ƒç”¨ï¼š 12X_train, X_test, y_train, y_test = load_classification_data()demo_KNeighborsClassifier(X_train, X_test, y_train, y_test) ç»“æžœå¦‚ä¸‹ï¼š 12Training score: 0.991091Testing score: 0.980000 å¯ä»¥çœ‹åˆ°kè¿‘é‚»æ³•å¯¹äºŽæµ‹è¯•é›†çš„æ•°æ®é¢„æµ‹å‡†ç¡®çŽ‡é«˜è¾¾98%ï¼Œå¯¹äºŽè®­ç»ƒé›†çš„æ‹Ÿåˆå‡†ç¡®çŽ‡é«˜è¾¾99%ã€‚ ç„¶åŽè€ƒå¯Ÿ\(k\)å€¼ä»¥åŠæŠ•ç¥¨ç­–ç•¥å¯¹äºŽé¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 12345678910111213141516171819202122def demo_KNeighborsClassifier_k_w(*data): X_train, X_test, y_train, y_test = data Ks = np.linspace(1, y_train.size, num=100, endpoint=False, dtype=&apos;int&apos;) weights = [&apos;uniform&apos;, &apos;distance&apos;] fig = plt.figure() ax = fig.add_subplot(1, 1, 1) for weight in weights: training_scores = [] testing_scores = [] for K in Ks: clf = neighbors.KNeighborsClassifier(weight=weight, n_neighbors=K) clf.fit(X_train, y_train) training_scores.append(clf.score(X_train, y_train)) testing_scores.append(clf.score(X_test, y_test)) ax.plot(Ks, testing_scores, label=&quot;testing score: weight=%s&quot; % weight) ax.plot(Ks, training_scores, label=&quot;training score: weight=%s&quot; % weight) ax.legend(loc=&apos;best&apos;) ax.set_xlabel(&quot;K&quot;) ax.set_ylabel(&quot;score&quot;) ax.set_ylim(0, 1.05) ax.set_title(&quot;KNeighborsClassifier&quot;) plt.show() è¿è¡Œç»“æžœï¼š å¯ä»¥çœ‹åˆ°ä½¿ç”¨uniformæŠ•ç¥¨ç­–ç•¥çš„æƒ…å†µä¸‹ï¼ˆæŠ•ç¥¨æƒé‡éƒ½ç›¸åŒï¼‰ï¼Œåˆ†ç±»å™¨éšç€\(k\)çš„å¢žé•¿ï¼Œé¢„æµ‹æ€§èƒ½ç¨³å®šä¸‹é™ã€‚è¿™æ˜¯å› ä¸ºå½“\(k\)å¢žå¤§æ—¶ï¼Œè¾“å…¥å®žä¾‹è¾ƒè¿œçš„è®­ç»ƒå®žä¾‹ä¹Ÿä¼šå¯¹é¢„æµ‹èµ·ä½œç”¨ï¼Œä½¿é¢„æµ‹å‘ç”Ÿé”™è¯¯ã€‚ åœ¨ä½¿ç”¨distanceæŠ•ç¥¨ç­–ç•¥æƒ…å†µä¸‹ï¼ˆæŠ•ç¥¨æƒé‡ä¸Žè·ç¦»æˆåæ¯”ï¼‰ï¼Œåˆ†ç±»å™¨éšç€\(k\)çš„å¢žé•¿ï¼Œå¯¹æµ‹è¯•é›†çš„é¢„æµ‹æ€§èƒ½ç›¸å¯¹æ¯”è¾ƒç¨³å®šï¼Œè¿™æ˜¯å› ä¸ºè™½ç„¶\(k\)å¢žå¤§æ—¶ï¼Œè¾“å…¥å®žä¾‹è¾ƒè¿œçš„è®­ç»ƒå®žä¾‹ä¹Ÿä¼šå¯¹é¢„æµ‹èµ·ä½œç”¨ï¼Œä½†å› ä¸ºè·ç¦»è¾ƒè¿œï¼Œå…¶å½±å“å°å¾—å¤šï¼ˆæƒé‡å¾ˆå°ï¼‰ã€‚ ç„¶åŽè€ƒå¯Ÿ\(p\)å€¼ï¼ˆå³è·ç¦»å‡½æ•°çš„å½¢å¼ï¼‰å¯¹äºŽé¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 12345678910111213141516171819202122def demo_KNeighborsClassifier_k_p(*data): X_train, X_test, y_train, y_test = data Ks = np.linspace(1, y_train.size, endpoint=False, dtype=&apos;int&apos;) Ps = [1, 2, 10] fig = plt.figure() ax = fig.add_subplot(1, 1, 1) for P in Ps: training_scores = [] testing_scores = [] for K in Ks: clf = neighbors.KNeighborsClassifier(p=P, n_neighbors=K) clf.fit(X_train, y_train) training_scores.append(clf.score(X_train, y_train)) testing_scores.append(clf.score(X_test, y_test)) ax.plot(Ks, testing_scores, label=&quot;testing score: p=%d&quot; % P) ax.plot(Ks, training_scores, label=&quot;training score: p=%d&quot; % P) ax.legend(loc=&apos;best&apos;) ax.set_xlabel(&quot;K&quot;) ax.set_ylabel(&quot;score&quot;) ax.set_ylim(0, 1.05) ax.set_title(&quot;KNeighborsClassifier&quot;) plt.show() è¿è¡Œç»“æžœï¼š å¯ä»¥çœ‹åˆ°\(p\)å‚æ•°å¯¹äºŽåˆ†ç±»å™¨çš„é¢„æµ‹æ€§èƒ½æ²¡æœ‰ä»»ä½•å½±å“ã€‚å› ä¸º\(L_p(\vec{x}_i,\vec{x}_j)=(\sum_{l=1}^n|x_i^{(l)}-x_j^{(l)}|^p)^{1/p}\)ï¼Œå½“\(p=1\)æ—¶å¦‚æžœ\(\vec{x}_j\)æ˜¯\(\vec{x}_i\)çš„æœ€è¿‘çš„ç‚¹ï¼Œåˆ™å½“\(p\)ä¸ºå…¶ä»–å€¼æ—¶ï¼Œè¯¥ç»“è®ºä¹Ÿæˆç«‹ã€‚ KNNå›žå½’(KNeighborsRegressor) scikit-learnä¸­æä¾›äº†ä¸€ä¸ªKNeighborsRegressorç±»æ¥å®žçŽ°kè¿‘é‚»æ³•å›žå½’æ¨¡åž‹ï¼Œå…¶åŽŸåž‹ä¸ºï¼š 1234sklearn.neighbors.KNeighborsRegressor(n_neighbors=5, weights=&apos;uniform&apos;, algorithm=&apos;auto&apos;, leaf_size=30, p=2, metric=&apos;minkowski&apos;, metric_params=None, n_jobs=None, **kwargs) å‚æ•°ï¼š n_neighborsï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®š\(k\)å€¼ã€‚ weightsï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…å¯è°ƒç”¨å¯¹è±¡ï¼ŒæŒ‡å®šæŠ•ç¥¨æƒé‡ç±»åž‹ã€‚ 'uniform'ï¼šæœ¬èŠ‚ç‚¹çš„æ‰€æœ‰é‚»å±…èŠ‚ç‚¹çš„æŠ•ç¥¨æƒé‡éƒ½ç›¸ç­‰ã€‚ 'distance'ï¼šæœ¬èŠ‚ç‚¹çš„æ‰€æœ‰é‚»å±…èŠ‚ç‚¹çš„æŠ•ç¥¨æƒé‡ä¸Žè·ç¦»æˆåæ¯”ã€‚ [callable]ï¼šä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ã€‚å®ƒä¼ å…¥è·ç¦»çš„æ•°ç»„ï¼Œè¿”å›žåŒæ ·å½¢çŠ¶çš„æƒé‡æ•°ç»„ã€‚ algorithmï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šè®¡ç®—æœ€è¿‘é‚»çš„ç®—æ³•ã€‚ 'ball_tree'ï¼šä½¿ç”¨BallTreeç®—æ³• 'kd_tree'ï¼šä½¿ç”¨KDTreeç®—æ³• 'brute'ï¼šä½¿ç”¨æš´åŠ›æœç´¢æ³• 'auto'ï¼šè‡ªåŠ¨å†³å®šæœ€åˆé€‚çš„ç®—æ³• leaf_sizeï¼šä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šBallTreeæˆ–è€…KDTreeå¶èŠ‚ç‚¹è§„æ¨¡ã€‚å®ƒå½±å“æ ‘çš„æž„å»ºå’ŒæŸ¥è¯¢é€Ÿåº¦ã€‚ metricï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šè·ç¦»åº¦é‡ã€‚é»˜è®¤ä¸º'minkowski'è·ç¦»ã€‚ pï¼šæ•´æ•°å€¼ï¼ŒæŒ‡å®šåœ¨'Minkowski'åº¦é‡ä¸Šçš„æŒ‡æ•°ã€‚å¦‚æžœp=1ï¼Œå¯¹åº”æ›¼å“ˆé¡¿è·ç¦»ï¼›å¦‚æžœp=2ï¼Œå¯¹åº”æ¬§æ‹‰è·ç¦»ã€‚ n_jobsï¼šå¹¶è¡Œæ€§ã€‚é»˜è®¤ä¸º-1ï¼Œè¡¨ç¤ºæ´¾å‘ä»»åŠ¡åˆ°æ‰€æœ‰è®¡ç®—æœºçš„CPUä¸Šã€‚ æ–¹æ³•ï¼š fit(X, y): è®­ç»ƒæ¨¡åž‹ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žå¾…é¢„æµ‹æ ·æœ¬çš„æ ‡è®° score(X, y): è¿”å›žé¢„æµ‹æ€§èƒ½å¾—åˆ† è®¾é¢„æµ‹é›†ä¸º\(T_{test}\)ï¼ŒçœŸå®žå€¼ä¸º\(y_i\)ï¼ŒçœŸå®žå€¼çš„å‡å€¼ä¸º\(\overline{y}\)ï¼Œé¢„æµ‹å€¼ä¸º\(\hat{y}_i\)ï¼Œåˆ™ï¼š\[score=1-\frac{\sum_{T_{test}}(y_i-\hat{y}_i)^2}{(y_i-\overline{y})^2}\] scoreä¸è¶…è¿‡1ï¼Œä½†æ˜¯å¯èƒ½ä¸ºè´Ÿå€¼ï¼ˆé¢„æµ‹æ•ˆæžœå¤ªå·®ï¼‰ã€‚ scoreè¶Šå¤§ï¼Œé¢„æµ‹æ€§èƒ½è¶Šå¥½ã€‚ kneighbors([X, n_neighbors, return_distance]): è¿”å›žæ ·æœ¬ç‚¹çš„\(k\)è¿‘é‚»ç‚¹ã€‚å¦‚æžœreturn_distance=Trueï¼ŒåŒæ—¶è¿˜è¿”å›žåˆ°è¿™äº›è¿‘é‚»ç‚¹çš„è·ç¦»ã€‚ kneighbors_graph([X, n_neighbors, mode]): è¿”å›žæ ·æœ¬ç‚¹çš„è¿žæŽ¥å›¾ å…¶å‚æ•°æ„ä¹‰ä»¥åŠå®žä¾‹æ–¹æ³•ä¸ŽKNeighborsClassifierå‡ ä¹Žå®Œå…¨ç›¸åŒã€‚ä¸¤è€…åŒºåˆ«åœ¨äºŽå›žå½’åˆ†æžå’Œåˆ†æžå†³ç­–çš„ä¸åŒï¼š KNeighborsClassifierå°†å¾…é¢„æµ‹æ ·æœ¬ç‚¹æœ€è¿‘é‚»çš„\(k\)ä¸ªè®­ç»ƒæ ·æœ¬ç‚¹ä¸­å‡ºçŽ°æ¬¡æ•°æœ€å¤šçš„åˆ†ç±»ä½œä¸ºå¾…é¢„æµ‹æ ·æœ¬ç‚¹çš„åˆ†ç±»ã€‚ KNeighborsRegressorå°†å¾…é¢„æµ‹æ ·æœ¬ç‚¹æœ€è¿‘é‚»çš„\(k\)ä¸ªè®­ç»ƒæ ·æœ¬ç‚¹çš„å¹³å‡å€¼ä½œä¸ºå¾…é¢„æµ‹æ ·æœ¬ç‚¹çš„å€¼ã€‚ é¦–å…ˆä½¿ç”¨KNeighborsRegressorï¼š 123456def demo_KNeighborsRegressor(*data): X_train, X_test, y_train, y_test = data regr = neighbors.KNeighborsRegressor() regr.fit(X_train, y_train) print(&quot;Training score: %f&quot; % regr.score(X_train, y_train)) print(&quot;Testing score: %f&quot; % regr.score(X_test, y_test)) è°ƒç”¨å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = create_regression_data(1000)demo_KNeighborsRegressor(X_train, X_test, y_train, y_test) è¿™é‡Œæˆ‘ä»¬ç”Ÿæˆäº†1000ä¸ªæ ·æœ¬æ•°æ®ï¼Œç»“æžœå¦‚ä¸‹ï¼š 12Training score: 0.977765Testing score: 0.958196 ç„¶åŽè€ƒå¯Ÿ\(k\)å€¼ä»¥åŠæŠ•ç¥¨ç­–ç•¥å¯¹é¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 12345678910111213141516171819202122def demo_KNeighborsRegressor_k_w(*data): X_train, X_test, y_train, y_test = data Ks = np.linspace(1, y_train.size, num=100, endpoint=False, dtype=&apos;int&apos;) weights = [&apos;uniform&apos;, &apos;distance&apos;] fig = plt.figure() ax = fig.add_subplot(1, 1, 1) for weight in weights: training_scores = [] testing_scores = [] for K in Ks: regr = neighbors.KNeighborsRegressor(weights=weight, n_neighbors=K) regr.fit(X_train, y_train) training_scores.append(regr.score(X_train, y_train)) testing_scores.append(regr.score(X_test, y_test)) ax.plot(Ks, testing_scores, label=&quot;testing score: weight=%s&quot; % weight) ax.plot(Ks, training_scores, label=&quot;training score: weight=%s&quot; % weight) ax.legend(loc=&apos;best&apos;) ax.set_xlabel(&quot;K&quot;) ax.set_ylabel(&quot;score&quot;) ax.set_ylim(0, 1.05) ax.set_title(&quot;KNeighborsRegressor&quot;) plt.show() ç»“æžœå¦‚ä¸‹ï¼Œå…¶è®¨è®ºä¸ŽKNeighborsClassifierç›¸åŒã€‚ ç„¶åŽè€ƒå¯Ÿ\(p\)å€¼ï¼ˆè·ç¦»å‡½æ•°çš„å½¢å¼ï¼‰å¯¹äºŽé¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 12345678910111213141516171819202122def demo_KNeighborsRegressor_k_p(*data): X_train, X_test, y_train, y_test = data Ks = np.linspace(1, y_train.size, endpoint=False, dtype=&apos;int&apos;) Ps = [1, 2, 10] fig = plt.figure() ax = fig.add_subplot(1, 1, 1) for P in Ps: training_scores = [] testing_scores = [] for K in Ks: regr = neighbors.KNeighborsRegressor(p=P, n_neighbors=K) regr.fit(X_train, y_train) training_scores.append(regr.score(X_train, y_train)) testing_scores.append(regr.score(X_test, y_test)) ax.plot(Ks, testing_scores, label=&quot;testing score: p=%d&quot; % P) ax.plot(Ks, training_scores, label=&quot;training score: p=%d&quot; % P) ax.legend(loc=&apos;best&apos;) ax.set_xlabel(&quot;K&quot;) ax.set_ylabel(&quot;score&quot;) ax.set_ylim(0, 1.05) ax.set_title(&quot;KNeighborsRegressor&quot;) plt.show() ç»“æžœå¦‚ä¸‹ï¼Œå…¶è®¨è®ºä¸ŽKNeighborsClassifierç›¸åŒã€‚]]></content>
      <categories>
        <category>Machine Learning</category>
      </categories>
      <tags>
        <tag>machine learning</tag>
        <tag>python</tag>
        <tag>sklearn</tag>
        <tag>knn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MachineLearning Chapter-3 Bayes Classifier]]></title>
    <url>%2F2019%2F07%2F27%2FMachineLearning-Chapter-3-Bayes-Classifier%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿° è´å¶æ–¯åˆ†ç±»æ˜¯ä¸€ç§åˆ†ç±»ç®—æ³•çš„æ€»ç§°ï¼Œè¿™ç§ç®—æ³•å‡ä»¥è´å¶æ–¯å®šç†ä¸ºåŸºç¡€ï¼Œæ‰€ä»¥ç»Ÿç§°ä¸ºè´å¶æ–¯åˆ†ç±»ã€‚ è´å¶æ–¯åˆ†ç±»å™¨çš„åˆ†ç±»åŽŸç†æ˜¯é€šè¿‡æŸå¯¹è±¡çš„å…ˆéªŒæ¦‚çŽ‡ï¼Œåˆ©ç”¨è´å¶æ–¯å…¬å¼è®¡ç®—å‡ºå…¶åŽéªŒæ¦‚çŽ‡ï¼Œå³è¯¥å¯¹è±¡å±žäºŽæŸä¸€ç±»çš„æ¦‚çŽ‡ï¼Œé€‰æ‹©å…·æœ‰æœ€å¤§åŽéªŒæ¦‚çŽ‡çš„ç±»ä½œä¸ºè¯¥å¯¹è±¡æ‰€å±žçš„ç±»ã€‚ è´å¶æ–¯åˆ†ç±»å™¨çš„ä¸»è¦ç‰¹ç‚¹ï¼š å±žæ€§å¯ä»¥ç¦»æ•£ï¼Œä¹Ÿå¯ä»¥è¿žç»­ æ•°å­¦åŸºç¡€æ‰Žå®žï¼Œåˆ†ç±»æ•ˆçŽ‡ç¨³å®š å¯¹ç¼ºå¤±å’Œå™ªå£°æ•°æ®ä¸å¤ªæ•æ„Ÿ å±žæ€§å¦‚æžœä¸ç›¸å…³ï¼Œåˆ†ç±»æ•ˆæžœå¾ˆå¥½ï¼›å¦‚æžœç›¸å…³ï¼Œåˆ™ä¸ä½ŽäºŽå†³ç­–æ ‘ ç®—æ³• è´å¶æ–¯å®šç† è´å¶æ–¯å®šç†æ˜¯ç”¨æ•°å­¦çš„æ–¹æ³•æ¥è§£é‡Šç”Ÿæ´»ä¸­å¤§å®¶éƒ½çŸ¥é“çš„å¸¸è¯†ï¼Œè€Œæœºå™¨å­¦ä¹ ä½¿ç”¨çš„å„ç§ç®—æ³•ä¸­ï¼Œæœ€å¸¸è§çš„å°±æ˜¯è´å¶æ–¯å®šç†ã€‚ å…ˆéªŒæ¦‚çŽ‡æ˜¯æ ¹æ®ä»¥å¾€ç»éªŒå’Œåˆ†æžå¾—åˆ°çš„æ¦‚çŽ‡ã€‚æ¯”å¦‚ï¼šä½ åœ¨å±±æ´žé—¨å£ï¼Œè§‰å¾—å±±æ´žä¸­æœ‰ç†Šå‡ºçŽ°çš„äº‹ä»¶ä¸º\(Y\)ï¼Œç„¶åŽå¬åˆ°å±±æ´žä¸­ä¼ æ¥ä¸€é˜µç†Šå¼çš„äº‹ä»¶ä¸º\(X\)ã€‚ä¸€å¼€å§‹ä½ ä»¥ä¸ºå±±æ´žä¸­æœ‰ç†Šçš„æ¦‚çŽ‡ä¸º\(P(Y)\)ï¼Œå¬åˆ°ç†Šå¼ä¹‹åŽè®¤ä¸ºæœ‰ç†Šçš„æ¦‚çŽ‡ä¸º\(P(Y/X)\)ã€‚å¾ˆæ˜Žæ˜¾\(P(Y/X)&gt;P(Y)\)ã€‚è¿™é‡Œï¼š \(P(Y)\)ä¸ºå…ˆéªŒæ¦‚çŽ‡ï¼Œæ˜¯æ ¹æ®ä»¥å¾€çš„æ•°æ®åˆ†æžæˆ–è€…ç»éªŒå¾—åˆ°çš„æ¦‚çŽ‡ \(P(Y/X)\)ä¸ºåŽéªŒæ¦‚çŽ‡ï¼Œæ˜¯å¾—åˆ°æœ¬æ¬¡è¯•éªŒçš„ä¿¡æ¯ä»Žè€Œé‡æ–°ä¿®æ­£çš„æ¦‚çŽ‡ è®¾\(S\)ä¸ºè¯•éªŒ\(E\)çš„æ ·æœ¬ç©ºé—´ã€‚\(B_1,B_2,â€¦,B_n\)ä¸º\(E\)çš„ä¸€ç»„äº‹ä»¶ã€‚è‹¥ï¼š \(B_i\cap B_j=\phi ,iâ‰ j,i,j=1,2,â€¦,n\) \(B_1\cup B_2\cup â€¦\cup B_n=S\) åˆ™ç§°\(B_1,B_2,â€¦,B_n\)ä¸ºæ ·æœ¬ç©ºé—´\(S\)çš„ä¸€ä¸ªåˆ’åˆ†ã€‚å¦‚æžœ\(B_1,B_2,â€¦,B_n\)ä¸ºæ ·æœ¬ç©ºé—´\(S\)çš„ä¸€ä¸ªåˆ’åˆ†ï¼Œåˆ™å¯¹äºŽæ¯æ¬¡è¯•éªŒï¼Œäº‹ä»¶\(B_1,B_2,â€¦,B_n\)ä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿã€‚ å…¨æ¦‚çŽ‡å…¬å¼ï¼šè®¾è¯•éªŒ\(E\)çš„æ ·æœ¬ç©ºé—´ä¸º\(S\)ï¼Œ\(A\)ä¸º\(E\)çš„äº‹ä»¶ï¼Œ\(B_1,B_2,â€¦,B_n\)ä¸ºæ ·æœ¬ç©ºé—´\(S\)çš„ä¸€ä¸ªåˆ’åˆ†ï¼Œä¸”\(P(B_i)â‰¥0(i=1,2,â€¦,n)\)ï¼Œåˆ™æœ‰ï¼š \[P(A)=P(A/B_1)P(B_1)+P(A/B_2)P(B_2)+â€¦+P(A/B_n)P(B_n)=\sum_{j=1}^nP(A/B_j)P(B_j)\] è´å¶æ–¯å®šç†ï¼šè®¾è¯•éªŒ\(E\)çš„æ ·æœ¬ç©ºé—´ä¸º\(S\)ï¼Œ\(A\)ä¸º\(E\)çš„äº‹ä»¶ï¼Œ\(B_1,B_2,â€¦,B_n\)ä¸ºæ ·æœ¬ç©ºé—´\(S\)çš„ä¸€ä¸ªåˆ’åˆ†ï¼Œä¸”\(P(A)&gt;0\)ï¼Œ\(P(B_i)â‰¥0(i=1,2,â€¦,n)\)ï¼Œåˆ™æœ‰ï¼š \[P(B_i/A)=\frac{P(A/B_i)P(B_i)}{\sum_{j=1}^nP(A/B_j)P(B_j)}\] æœ´ç´ è´å¶æ–¯æ³• åŽŸç† è®¾æ ·æœ¬\(\vec{x}=(x^{(1)},x^{(2)},â€¦,x^{(n)})^T \in ð’³ \subseteq R^n\)ï¼Œè®¾æ ‡è®°\(y\in ð’´=\{c_1,c_2,â€¦,c_K\}\)ã€‚ä»¤\(X\)ä¸ºð’³ä¸Šçš„éšæœºå‘é‡ï¼Œ\(Y\)ä¸ºð’´ä¸Šçš„éšæœºå˜é‡ï¼Œ\(P(X,Y)\)ä¸º\(X\)å’Œ\(Y\)çš„è”åˆæ¦‚çŽ‡åˆ†å¸ƒã€‚å‡å®šè®­ç»ƒæ•°æ®é›†\(T=\{(\vec{x}_1,y_1),(\vec{x}_2,y_2),â€¦,(\vec{x}_N,y_N)\}\)ç”±\(P(X,Y)\)ç‹¬ç«‹åŒåˆ†å¸ƒäº§ç”Ÿï¼Œé‚£ä¹ˆæœ´ç´ è´å¶æ–¯æ³•å¯ä»Žè®­ç»ƒæ•°æ®é›†ä¸­å­¦ä¹ è”åˆæ¦‚çŽ‡åˆ†å¸ƒ\(P(X,Y)\)ï¼Œä¹Ÿå°±æ˜¯å­¦ä¹ ä¸‹åˆ—æ¦‚çŽ‡åˆ†å¸ƒï¼š å…ˆéªŒæ¦‚çŽ‡åˆ†å¸ƒï¼š\(P(Y=c_k),k=1,2,â€¦,K\) æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒï¼š\(P(X=\vec{x}/Y=c_k),k=1,2,â€¦,K\) æœ´ç´ è´å¶æ–¯æ³•å‡è®¾ï¼šåœ¨åˆ†ç±»ç¡®å®šçš„æ¡ä»¶ä¸‹ï¼Œç”¨äºŽåˆ†ç±»çš„ç‰¹å¾æ˜¯æ¡ä»¶ç‹¬ç«‹çš„ã€‚å³ï¼š \[P(X=\vec{x}/Y=c_k)=P(X^{(1)}=x^{(1)},X^{(2)}=x^{(2)},â€¦,X^{(n)}=x^{(n)}/Y=c_k) \\ =\prod_{j=1}^nP(X^{(j)}=x^{(j)}/Y=c_k),k=1,2,â€¦,K\] æ ¹æ®è´å¶æ–¯å®šç†ï¼š \[P(Y=c_k/X=\vec{x})=\frac{P(X=\vec{x}/Y=c_k)P(Y=c_k)}{\sum_{j=1}^KP(X=\vec{x}/Y=c_j)P(Y=c_j)}\] è€ƒè™‘åˆ†ç±»ç‰¹å¾çš„æ¡ä»¶ç‹¬ç«‹å‡è®¾æœ‰ï¼š \[P(Y=c_k/X=\vec{x})=\frac{P(Y=c_k)\prod_{i=1}^nP(X^{(i)}=x^{(i)}/Y=c_k)}{\sum_{j=1}^KP(X=\vec{x}/Y=c_j)P(Y=c_j)},k=1,2,â€¦,K\] äºŽæ˜¯æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨è¡¨ç¤ºä¸ºï¼š \[y=f(\vec{x})=\arg \max_{c_k}\frac{P(Y=c_k)\prod_{i=1}^nP(X^{(i)}=x^{(i)}/Y=c_k)}{\sum_{j=1}^KP(X=\vec{x}/Y=c_j)P(Y=c_j)}\] ç”±äºŽå¯¹æ‰€æœ‰çš„\(c_k,k=1,2,â€¦,K\)ï¼Œä¸Šå¼çš„åˆ†æ¯éƒ½ç›¸åŒï¼Œå› æ­¤ä¸Šå¼å¯é‡å†™ä¸ºï¼š \[y=f(\vec{x})=\arg \max_{c_k}P(Y=c_k)\prod_{i=1}^nP(X^{(i)}=x^{(i)}/Y=c_k)\] æœ´ç´ è´å¶æ–¯æ³•çš„å­¦ä¹  åœ¨æœ´ç´ è´å¶æ–¯æ³•ä¸­ï¼Œè¦å­¦ä¹ çš„å‚æ•°å°±æ˜¯ä»¥ä¸‹ä¸¤ç§æ¦‚çŽ‡ï¼š å…ˆéªŒæ¦‚çŽ‡\(P(Y=c_k)\) æ¡ä»¶æ¦‚çŽ‡\(P(X^{(j)}=x^{(j)}/Y=c_k)\) é€šå¸¸é‡‡ç”¨æžå¤§ä¼¼ç„¶ä¼°è®¡è¿™ä¸¤ç§æ¦‚çŽ‡ã€‚ å…ˆéªŒæ¦‚çŽ‡\(P(Y=c_k)\)çš„æžå¤§ä¼¼ç„¶ä¼°è®¡ä¸ºï¼š\[P(Y=c_k)=\frac{1}{N}\sum_{i=1}^NI(y_i=c_k),k=1,2,â€¦,K\] æ¡ä»¶æ¦‚çŽ‡\(P(X^{(j)}=a_{jl}/Y=c_k)\)çš„æžå¤§ä¼¼ç„¶ä¼°è®¡ä¸ºï¼š\[P(X^{(j)}=a_{jl}/Y=c_k)=\frac{\sum_{i=1}^NI(x_i^{(j)}=a_{jl},y_i=c_k)}{\sum_{i=1}^NI(y_i=c_k)}\\j=1,2,â€¦,n ;l=1,2,â€¦,s_j ; k=1,2,â€¦,K\]å…¶ä¸­ï¼Œ\(a_{j1},a_{j2},â€¦,a_{js_j}\)ä¸ºç¬¬\(j\)ä¸ªç‰¹å¾\(x^{(j)}\)å¯èƒ½çš„å–å€¼ã€‚ æœ´ç´ è´å¶æ–¯æ³•ç®—æ³• è¾“å…¥ï¼š è®­ç»ƒé›†\(T=\{(\vec{x}_1,y_1),(\vec{x}_2,y_2),â€¦,(\vec{x}_N,y_N)\}\), \(\vec{x}_i=(x^{(1)}_i,x^{(2)}_i,â€¦,x^{(n)}_i)^T\)ï¼Œ\(x^{(j)}_i\)ä¸ºç¬¬\(i\)ä¸ªæ ·æœ¬çš„ç¬¬\(j\)ä¸ªç‰¹å¾ï¼Œå…¶ä¸­\(x^{(j)}_i\in \{a_{j1},a_{j2},â€¦,a_{js_j}\}\)ï¼Œ\(a_{jl}\)ä¸ºç¬¬\(j\)ä¸ªç‰¹å¾å¯èƒ½å–åˆ°çš„ç¬¬\(l\)ä¸ªå€¼ï¼Œ\(j=1,2,â€¦,n\)ï¼Œ\(l=1,2,â€¦,s_j\)ï¼Œ\(y_i\in \{c_1,c_2,â€¦,c_K\}\)ã€‚ å®žä¾‹\(\vec{x}\) è¾“å‡ºï¼šå®žä¾‹\(\vec{x}\)çš„åˆ†ç±» ç®—æ³•æ­¥éª¤ï¼š è®¡ç®—å…ˆéªŒæ¦‚çŽ‡çš„ä¼°è®¡å€¼ä»¥åŠæ¡ä»¶æ¦‚çŽ‡çš„ä¼°è®¡å€¼ï¼š\[P(Y=c_k)=\frac{\sum_{i=1}^NI(y_i=c_k)}{N},k=1,2,â€¦,K \\ P(X^{(j)}=a_{jl}/Y=c_k)=\frac{\sum_{i=1}^NI(x_i^{(j)}=a_{jl},y_i=c_k)}{\sum_{i=1}^NI(y_i=c_k)} \\ j=1,2,â€¦,n; l=1,2,â€¦,s_j; k=1,2,â€¦,K\] å¯¹äºŽç»™å®šçš„å®žä¾‹\(\vec{x}=(x^{(1)},x^{(2)},â€¦,x^{(n)})^T\)ï¼Œè®¡ç®—ï¼š\[P(Y=c_k)\prod_{j=1}^nP(X^{(j)}=x^{(j)}/Y=c_k),k=1,2,â€¦,K\] è®¡ç®—å¹¶è¿”å›žå®žä¾‹\(\vec{x}\)çš„åˆ†ç±»\(y\)ï¼š\[y=\arg \max_{c_k}P(Y=c_k)\prod_{j=1}^nP(X^{(j)}=x^{(j)}/Y=c_k)\] è´å¶æ–¯ä¼°è®¡ è®¾ç¬¬\(j\)ä¸ªç‰¹å¾\(x^{(j)}\)å¯èƒ½çš„å–å€¼ä¸º\(a_{j1},a_{j2},â€¦,a_{js_j}\)ï¼Œåˆ™æ¡ä»¶æ¦‚çŽ‡\(P(X^{(j)}=a_{jl}/Y=c_k)\)çš„æžå¤§ä¼¼ç„¶ä¼°è®¡ä¸ºï¼š \[P(X^{(j)}=a_{jl}/Y=c_k)=\frac{\sum_{i=1}^NI(x_i^{(j)}=a_{jl},y_i=c_k)}{\sum_{i=1}^NI(y_i=c_k)} \\ j=1,2,â€¦,n; l=1,2,â€¦,s_j; k=1,2,â€¦,K\] ç”¨æžå¤§ä¼¼ç„¶ä¼°è®¡å¯èƒ½ä¼šå‡ºçŽ°åˆ†æ¯\(\sum_{i=1}^NI(y_i=c_k)\)ä¸º0çš„æƒ…å†µï¼Œæ­¤æ—¶å¯ä»¥é‡‡ç”¨è´å¶æ–¯ä¼°è®¡ï¼ˆæœ€å¤§åŽéªŒä¼°è®¡ï¼‰ï¼š \[P_{\lambda}(X^{(j)}=a_{jl}/Y=c_k)=\frac{\sum_{i=1}^NI(x_i^{(j)}=a_{jl},y_i=c_k)+\lambda }{\sum_{i=1}^NI(y_i=c_k)+s_j\lambda } \\ j=1,2,â€¦,n; l=1,2,â€¦,s_j; k=1,2,â€¦,K\] å®ƒç­‰ä»·äºŽåœ¨\(X^{(j)}\)çš„å„ä¸ªå–å€¼çš„é¢‘æ•°ä¸Šèµ‹äºˆä¸€ä¸ªæ­£æ•°\(\lambda\) å®ƒæ»¡è¶³æ¦‚çŽ‡åˆ†å¸ƒå‡½æ•°çš„æ¡ä»¶ï¼š \[P_{\lambda}(X^{(j)}=a_{jl}/Y=c_k)&gt;0;l=1,2,â€¦,s_j;k=1,2,â€¦,K \\ \sum_{l=1}^{s_j}P_{\lambda}(X^{(j)}=a_{jl}/Y=c_k)=1 \] æ­¤æ—¶\(P(Y=c_k)\)çš„è´å¶æ–¯ä¼°è®¡è°ƒæ•´ä¸ºï¼š \[P_{\lambda}(Y=c_k)=\frac{\sum_{i=1}^NI(y_i=c_k)+\lambda}{N+K\lambda}\] å½“\(\lambda =0\)æ—¶ï¼Œä¸ºæžå¤§ä¼¼ç„¶ä¼°è®¡ å½“\(\lambda =1\)æ—¶ï¼Œä¸ºæ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ Pythonå®žæˆ˜ åœ¨scikitä¸­æœ‰å¤šç§ä¸åŒçš„æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼Œå®ƒä»¬çš„åŒºåˆ«å°±åœ¨äºŽå‡è®¾äº†ä¸åŒçš„\(P(X^{(j)}/y=c_k)\)åˆ†å¸ƒï¼Œä¸‹é¢ä»‹ç»ä¸‰ç§å¸¸ç”¨çš„æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼š GaussianNBæ˜¯é«˜æ–¯è´å¶æ–¯åˆ†ç±»å™¨ã€‚å®ƒå‡è®¾ç‰¹å¾çš„æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒæ»¡è¶³é«˜æ–¯åˆ†å¸ƒï¼š\[P(X^{(j)}/y=c_k)=\frac{1}{\sqrt{2\pi \sigma_k^2}}\exp (-\frac{(X^{(j)}-\mu_k)^2}{2\sigma_k^2})\] MultinomialNBæ˜¯å¤šé¡¹å¼è´å¶æ–¯åˆ†ç±»å™¨ã€‚å®ƒå‡è®¾ç‰¹å¾çš„æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒæ»¡è¶³å¤šé¡¹å¼åˆ†å¸ƒï¼š\[P(X^{(j)}=a_{sj}/y=c_k)=\frac{N_{kj}+\alpha }{N_k+\alpha n}\]å…¶ä¸­ï¼Œ\(a_{sj}\)è¡¨ç¤ºç‰¹å¾\(X^{(j)}\)çš„å–å€¼ï¼Œå…¶å–å€¼ä¸ªæ•°ä¸º\(s_j\)ä¸ªï¼›\(N_k=\sum_{i=1}^NI(y_i=c_k)\)ï¼Œè¡¨ç¤ºå±žäºŽç±»åˆ«\(c_k\)çš„æ ·æœ¬çš„æ•°é‡ï¼›\(N_{kj}=\sum_{i=1}^NI(y_i=c_k,X^{(j)}=a_{sj})\)ï¼Œè¡¨ç¤ºå±žäºŽç±»åˆ«\(c_k\)ä¸”ç‰¹å¾\(X^{(j)}=a_{sj}\)çš„æ ·æœ¬çš„æ•°é‡ã€‚\(\alpha\)å°±æ˜¯å‰è¿°è´å¶æ–¯ä¼°è®¡ä¸­çš„\(\lambda\)ã€‚ BernoulliNBæ˜¯ä¼¯åŠªåˆ©è´å¶æ–¯åˆ†ç±»å™¨ã€‚å®ƒå‡è®¾ç‰¹å¾çš„æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒæ»¡è¶³äºŒé¡¹åˆ†å¸ƒï¼š\[P(X^{(j)}/y=c_k)=pX^{(j)}+(1-p)(1-X^{(j)})\]å…¶ä¸­ï¼Œè¦æ±‚ç‰¹å¾çš„å–å€¼ä¸º\(X^{(j)}\in \{0,1\}\)ï¼Œä¸”\(P(X^{(j)}=1/y=c_k)=p\)ã€‚ ä¸Žå¤šé¡¹å¼æ¨¡åž‹ä¸€æ ·ï¼Œä¼¯åŠªåˆ©æ¨¡åž‹é€‚ç”¨äºŽç¦»æ•£ç‰¹å¾çš„æƒ…å†µï¼Œæ‰€ä¸åŒçš„æ˜¯ï¼Œä¼¯åŠªåˆ©æ¨¡åž‹ä¸­æ¯ä¸ªç‰¹å¾çš„å–å€¼åªèƒ½æ˜¯1å’Œ0ã€‚ é¦–å…ˆå¯¼å…¥åŒ…ï¼š 123from sklearn import datasets, model_selection, naive_bayesimport numpy as npimport matplotlib.pyplot as plt è¿™é‡Œä½¿ç”¨çš„æ˜¯scikit-learnè‡ªå¸¦çš„æ‰‹å†™è¯†åˆ«æ•°æ®é›†Digit Datasetã€‚è¯¥æ•°æ®é›†ç”±1791å¼ æ ·æœ¬å›¾ç‰‡ç»„æˆï¼Œæ¯å¼ å›¾ç‰‡éƒ½æ˜¯ä¸€ä¸ª\(8\times 8\)å¤§å°çš„æ‰‹å†™æ•°å­—ä½å›¾ã€‚ä¸ºäº†ä¾¿äºŽå¤„ç†ï¼Œscikit-learnå°†æ ·æœ¬å›¾ç‰‡è½¬æ¢æˆ64ç»´çš„å‘é‡ã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„å‡½æ•°æ¥è§‚å¯ŸDigit Datasetæ•°æ®é›†ï¼š 12345678def show_digits(): digits = datasets.load_digits() fig = plt.figure() print(&quot;vector from images 0:&quot;, digits.data[0]) for i in range(25): ax = fig.add_subplot(5, 5, i+1) ax.imshow(digits.images[i], cmap=plt.cm.gray_r, interpolation=&apos;nearest&apos;) plt.show() è°ƒç”¨è¯¥å‡½æ•°ï¼Œç»“æžœå¦‚ä¸‹ï¼š 12345vector from images 0: [ 0. 0. 5. 13. 9. 1. 0. 0. 0. 0. 13. 15. 10. 15. 5. 0. 0. 3. 1. 2. 0. 11. 8. 0. 0. 4. 12. 0. 0. 8. 8. 0. 0. 5. 8. 0. 1. 9. 8. 0. 0. 4. 11. 0. 1. 12. 7. 0. 0. 2. 14. 5. 10. 12. 2. 0. 0. 0. 6. 13. 10. 0. 0. 0.] åŠ è½½æ•°æ®é›†ï¼š 123def load_data(): digits = datasets.load_digits() return model_selection.train_test_split(digits.data, digits.target, test_size=0.25, random_state=0) é«˜æ–¯è´å¶æ–¯åˆ†ç±»å™¨(GaussianNB) å…¶åŽŸåž‹ä¸ºï¼šclass sklearn.native_bayes.GaussianNBã€‚GaussianNBæ²¡æœ‰å‚æ•°ï¼Œå› æ­¤ä¸éœ€è¦è°ƒå‚ã€‚ å±žæ€§ï¼š class_prior_: ä¸€ä¸ªæ•°ç»„ï¼Œå½¢çŠ¶ä¸º(n_classes,)ï¼Œæ˜¯æ¯ä¸ªç±»åˆ«çš„æ¦‚çŽ‡\(P(y=c_k)\) class_count_: ä¸€ä¸ªæ•°ç»„ï¼Œå½¢çŠ¶ä¸º(n_classes,)ï¼Œæ˜¯æ¯ä¸ªç±»åˆ«åŒ…å«çš„è®­ç»ƒæ ·æœ¬æ•°é‡ theta_: ä¸€ä¸ªæ•°ç»„ï¼Œå½¢çŠ¶ä¸º(n_classes, n_features)ï¼Œæ˜¯æ¯ä¸ªç±»åˆ«ä¸Šæ¯ä¸ªç‰¹å¾å€¼çš„å‡å€¼\(\mu_k\) sigma_: ä¸€ä¸ªæ•°ç»„ï¼Œå½¢çŠ¶ä¸º(n_classes, n_features)ï¼Œæ˜¯æ¯ä¸ªç±»åˆ«ä¸Šæ¯ä¸ªç‰¹å¾çš„æ ‡å‡†å·®\(\sigma_k\) æ–¹æ³•ï¼š fit(X, y[, sample_weight]): è®­ç»ƒæ¨¡åž‹ partial_fit(X, y[, classes, sample_weight]): è¿½åŠ è®­ç»ƒæ¨¡åž‹ã€‚è¯¥æ–¹æ³•ä¸»è¦ç”¨äºŽå¤§è§„æ¨¡æ•°æ®é›†çš„è®­ç»ƒã€‚æ­¤æ—¶å¯ä»¥å°†å¤§æ•°æ®é›†åˆ’åˆ†æˆè‹¥å¹²ä¸ªå°æ•°æ®é›†ï¼Œç„¶åŽåœ¨è¿™äº›å°æ•°æ®é›†ä¸Šè¿žç»­è°ƒç”¨partial_fitæ–¹æ³•æ¥è®­ç»ƒæ¨¡åž‹ã€‚ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ predict_log_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡çš„å¯¹æ•°å€¼ predict_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡å€¼ score(X, y[, sample_weight]): è¿”å›žåœ¨(X, y)ä¸Šé¢„æµ‹çš„å‡†ç¡®çŽ‡ 123456def demo_GaussianNB(*data): X_train, X_test, y_train, y_test = data cls = naive_bayes.GaussianNB() cls.fit(X_train, y_train) print(&quot;Training score: %.2f&quot; % cls.score(X_train, y_train)) print(&quot;Testing score: %.2f&quot; % cls.score(X_test, y_test)) è¿è¡Œç»“æžœï¼š 12Training score: 0.86Testing score: 0.83 å¯ä»¥çœ‹åˆ°é«˜æ–¯è´å¶æ–¯åˆ†ç±»å™¨å¯¹è®­ç»ƒæ•°æ®é›†çš„é¢„æµ‹å‡†ç¡®çŽ‡ä¸º86%ï¼Œå¯¹æµ‹è¯•æ•°æ®é›†çš„é¢„æµ‹å‡†ç¡®çŽ‡ä¸º83%ã€‚ å¤šé¡¹å¼è´å¶æ–¯åˆ†ç±»å™¨(MultinomialNB) å…¶åŽŸåž‹ä¸ºï¼š 1class sklearn.native_bayes.MultinomialNB(alpha=1.0, fit_prior=True, class_prior=None) å‚æ•°ï¼š alpha: ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ŒæŒ‡å®š\(\alpha\)å€¼ fit_prior: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œåˆ™ä¸åŽ»å­¦ä¹ \(P(y=c_k)\)ï¼Œæ›¿ä»£ä»¥å‡åŒ€åˆ†å¸ƒã€‚ class_prior: ä¸€ä¸ªæ•°ç»„ï¼ŒæŒ‡å®šäº†æ¯ä¸ªåˆ†ç±»çš„å…ˆéªŒæ¦‚çŽ‡\(P(y=c_1),P(y=c_2),â€¦,P(y=c_K)\)ã€‚å¦‚æžœæŒ‡å®šäº†è¯¥å‚æ•°ï¼Œåˆ™æ¯ä¸ªåˆ†ç±»çš„å…ˆéªŒæ¦‚çŽ‡ä¸å†ä»Žæ•°æ®é›†ä¸­å­¦å¾—ã€‚ å±žæ€§ï¼š class_log_prior_: ä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œå½¢çŠ¶ä¸º(n_classes,)ã€‚ç»™å‡ºæ¯ä¸ªç±»åˆ«è°ƒæ•´åŽçš„ç»éªŒæ¦‚çŽ‡åˆ†å¸ƒçš„å¯¹æ•°å€¼ feature_log_prob_: ä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œå½¢çŠ¶ä¸º(n_classes, n_features)ã€‚ç»™å‡ºäº†\(P(X^{(j)}/y=c_k)\)çš„ç»éªŒæ¦‚çŽ‡åˆ†å¸ƒçš„å¯¹æ•°å€¼ class_count_: ä¸€ä¸ªæ•°ç»„ï¼Œå½¢çŠ¶ä¸º(n_classes,)ï¼Œæ˜¯æ¯ä¸ªç±»åˆ«åŒ…å«çš„è®­ç»ƒæ ·æœ¬æ•°é‡ feature_count_: ä¸€ä¸ªæ•°ç»„ï¼Œå½¢çŠ¶ä¸º(n_classes, n_features)ã€‚è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªç±»åˆ«æ¯ä¸ªç‰¹å¾é‡åˆ°çš„æ ·æœ¬æ•°ã€‚ æ–¹æ³•ï¼š fit(X, y[, sample_weight]): è®­ç»ƒæ¨¡åž‹ partial_fit(X, y[, classes, sample_weight]): è¿½åŠ è®­ç»ƒæ¨¡åž‹ã€‚è¯¥æ–¹æ³•ä¸»è¦ç”¨äºŽå¤§è§„æ¨¡æ•°æ®é›†çš„è®­ç»ƒã€‚æ­¤æ—¶å¯ä»¥å°†å¤§æ•°æ®é›†åˆ’åˆ†æˆè‹¥å¹²ä¸ªå°æ•°æ®é›†ï¼Œç„¶åŽåœ¨è¿™äº›å°æ•°æ®é›†ä¸Šè¿žç»­è°ƒç”¨partial_fitæ–¹æ³•æ¥è®­ç»ƒæ¨¡åž‹ã€‚ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ predict_log_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡çš„å¯¹æ•°å€¼ predict_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡å€¼ score(X, y[, sample_weight]): è¿”å›žåœ¨(X, y)ä¸Šé¢„æµ‹çš„å‡†ç¡®çŽ‡ 123456def demo_MultinomialNB(*data): X_train, X_test, y_train, y_test = data cls = naive_bayes.MultinomialNB() cls.fit(X_train, y_train) print(&quot;Training score: %.2f&quot; % cls.score(X_train, y_train)) print(&quot;Testing score: %.2f&quot; % cls.score(X_test, y_test)) è¿è¡Œç»“æžœï¼š 12Training score: 0.91Testing score: 0.91 æŽ¥ç€æ£€éªŒä¸åŒçš„\(\alpha\)å¯¹å¤šé¡¹å¼è´å¶æ–¯åˆ†ç±»å™¨å¯¹é¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 123456789101112131415161718192021def demo_MultinomialNB_alpha(*data): X_train, X_test, y_train, y_test = data alphas = np.logspace(-2, 5, num=200) training_scores = [] testing_scores = [] for alpha in alphas: cls = naive_bayes.MultinomialNB(alpha=alpha) cls.fit(X_train, y_train) training_scores.append(cls.score(X_train, y_train)) testing_scores.append(cls.score(X_test, y_test)) # ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) ax.plot(alphas, training_scores, label=&quot;training score&quot;) ax.plot(alphas, testing_scores, label=&quot;testing score&quot;) ax.set_xlabel(r&quot;$\alpha$&quot;) ax.set_ylabel(&quot;score&quot;) ax.set_ylim(0, 1.0) ax.set_title(&quot;MultinomialNB&quot;) ax.set_xscale(&quot;log&quot;) plt.show() è¿è¡Œç»“æžœï¼š ä¸ºäº†ä¾¿äºŽè§‚å¯Ÿæˆ‘ä»¬å°†\(x\)è½´è®¾ç½®ä¸ºå¯¹æ•°åæ ‡ã€‚å¯ä»¥çœ‹åˆ°\(\alpha &gt;100\)ä¹‹åŽï¼Œéšç€\(\alpha\)çš„å¢žé•¿ï¼Œé¢„æµ‹å‡†ç¡®çŽ‡åœ¨ä¸‹é™ã€‚è¿™æ˜¯å› ä¸ºå¤šé¡¹å¼è´å¶æ–¯ä¼°è®¡ä¸­ï¼Œå‡è®¾ç‰¹å¾çš„æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒæ»¡è¶³å¤šé¡¹å¼åˆ†å¸ƒï¼š\[P(X^{(j)}=a_{sj}/y=c_k)=\frac{N_{kj}+\alpha }{N_k+\alpha n}\] å½“\(\alpha \to âˆž\)æ—¶ï¼Œ\(\frac{N_{kj}+\alpha }{N_k+\alpha n} \to \frac{1}{n}\)ï¼Œå³å¯¹ä»»ä½•ç±»åž‹çš„ç‰¹å¾ã€è¯¥ç±»åž‹ç‰¹å¾çš„ä»»æ„å–å€¼ï¼Œå‡ºçŽ°çš„æ¦‚çŽ‡éƒ½æ˜¯\(\frac{1}{n}\)ã€‚å®ƒå®Œå…¨å¿½ç•¥äº†å„ä¸ªç‰¹å¾ä¹‹é—´çš„å·®åˆ«ï¼Œä¹Ÿå¿½ç•¥äº†æ¯ä¸ªç‰¹å¾å†…éƒ¨çš„åˆ†å¸ƒã€‚åœ¨æœ¬é—®é¢˜ä¸­æ€»çš„æ ·æœ¬æ•°é‡åœ¨\(10^3\)ï¼Œ\(N_k\)çš„é‡çº§åœ¨\(10^2\)ï¼Œå› æ­¤åœ¨\(\alpha &gt;100\)ä¹‹åŽï¼Œé¢„æµ‹å‡†ç¡®çŽ‡å—å½±å“è¾ƒå¤§ã€‚ ä¼¯åŠªåˆ©è´å¶æ–¯åˆ†ç±»å™¨(BernoulliNB) å…¶åŽŸåž‹ä¸ºï¼š 12class sklearn.native_bayes.BernoulliNB(alpha=1.0, binarize=.0, fit_prior=True, class_prior=None) å‚æ•°ï¼š alpha: ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ŒæŒ‡å®š\(\alpha\)å€¼ï¼Œå°±æ˜¯å‰è¿°è´å¶æ–¯ä¼°è®¡ä¸­çš„\(\lambda\) binarize: ä¸€ä¸ªæµ®ç‚¹æ•°æˆ–è€…None None: å‡å®šåŽŸå§‹æ•°æ®å·²ç»äºŒå…ƒåŒ–äº† æµ®ç‚¹æ•°: ä»¥è¯¥æ•°ä¸ºç•Œï¼Œç‰¹å¾å–å€¼å¤§äºŽå®ƒçš„ä½œä¸º1ï¼Œç‰¹å¾å–å€¼å°äºŽå®ƒçš„ä½œä¸º0ã€‚é‡‡å–è¿™ç§ç­–ç•¥æ¥äºŒå…ƒåŒ– fit_prior: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œåˆ™ä¸åŽ»å­¦ä¹ \(P(y=c_k)\)ï¼Œæ›¿ä»£ä»¥å‡åŒ€åˆ†å¸ƒã€‚ class_prior: ä¸€ä¸ªæ•°ç»„ï¼ŒæŒ‡å®šäº†æ¯ä¸ªåˆ†ç±»çš„å…ˆéªŒæ¦‚çŽ‡\(P(y=c_1),P(y=c_2),â€¦,P(y=c_K)\)ã€‚å¦‚æžœæŒ‡å®šäº†è¯¥å‚æ•°ï¼Œåˆ™æ¯ä¸ªåˆ†ç±»çš„å…ˆéªŒæ¦‚çŽ‡ä¸å†ä»Žæ•°æ®é›†ä¸­å­¦å¾—ã€‚ å±žæ€§ï¼š class_log_prior_: ä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œå½¢çŠ¶ä¸º(n_classes,)ã€‚ç»™å‡ºæ¯ä¸ªç±»åˆ«è°ƒæ•´åŽçš„ç»éªŒæ¦‚çŽ‡åˆ†å¸ƒçš„å¯¹æ•°å€¼ feature_log_prob_: ä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œå½¢çŠ¶ä¸º(n_classes, n_features)ã€‚ç»™å‡ºäº†\(P(X^{(j)}/y=c_k)\)çš„ç»éªŒæ¦‚çŽ‡åˆ†å¸ƒçš„å¯¹æ•°å€¼ class_count_: ä¸€ä¸ªæ•°ç»„ï¼Œå½¢çŠ¶ä¸º(n_classes,)ï¼Œæ˜¯æ¯ä¸ªç±»åˆ«åŒ…å«çš„è®­ç»ƒæ ·æœ¬æ•°é‡ feature_count_: ä¸€ä¸ªæ•°ç»„ï¼Œå½¢çŠ¶ä¸º(n_classes, n_features)ã€‚è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªç±»åˆ«æ¯ä¸ªç‰¹å¾é‡åˆ°çš„æ ·æœ¬æ•°ã€‚ æ–¹æ³•ï¼š fit(X, y[, sample_weight]): è®­ç»ƒæ¨¡åž‹ partial_fit(X, y[, classes, sample_weight]): è¿½åŠ è®­ç»ƒæ¨¡åž‹ã€‚è¯¥æ–¹æ³•ä¸»è¦ç”¨äºŽå¤§è§„æ¨¡æ•°æ®é›†çš„è®­ç»ƒã€‚æ­¤æ—¶å¯ä»¥å°†å¤§æ•°æ®é›†åˆ’åˆ†æˆè‹¥å¹²ä¸ªå°æ•°æ®é›†ï¼Œç„¶åŽåœ¨è¿™äº›å°æ•°æ®é›†ä¸Šè¿žç»­è°ƒç”¨partial_fitæ–¹æ³•æ¥è®­ç»ƒæ¨¡åž‹ã€‚ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ predict_log_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡çš„å¯¹æ•°å€¼ predict_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡å€¼ score(X, y[, sample_weight]): è¿”å›žåœ¨(X, y)ä¸Šé¢„æµ‹çš„å‡†ç¡®çŽ‡ 123456def demo_BernoulliNB(*data): X_train, X_test, y_train, y_test = data cls = naive_bayes.BernoulliNB() cls.fit(X_train, y_train) print(&quot;Training score: %.2f&quot; % cls.score(X_train, y_train)) print(&quot;Testing score: %.2f&quot; % cls.score(X_test, y_test)) è¿è¡Œç»“æžœï¼š 12Training score: 0.87Testing score: 0.85 æŽ¥ç€æ£€éªŒä¸åŒçš„\(\alpha\)å¯¹ä¼¯åŠªåˆ©è´å¶æ–¯åˆ†ç±»å™¨é¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 12345678910111213141516171819202122def demo_BernoulliNB_alpha(*data): X_train, X_test, y_train, y_test = data alphas = np.logspace(-2, 5, num=200) training_scores = [] testing_scores = [] for alpha in alphas: cls = naive_bayes.BernoulliNB(alpha=alpha) cls.fit(X_train, y_train) training_scores.append(cls.score(X_train, y_train)) testing_scores.append(cls.score(X_test, y_test)) # ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) ax.plot(alphas, training_scores, label=&quot;training score&quot;) ax.plot(alphas, testing_scores, label=&quot;testing score&quot;) ax.set_xlabel(r&quot;$\alpha$&quot;) ax.set_ylabel(&quot;score&quot;) ax.set_ylim(0, 1.0) ax.set_title(&quot;BernoullizNB&quot;) ax.set_xscale(&quot;log&quot;) ax.legend(loc=&quot;best&quot;) plt.show() è¿è¡Œç»“æžœï¼š å¯ä»¥çœ‹åˆ°\(\alpha &gt;100\)ä¹‹åŽï¼Œéšç€\(\alpha\)çš„å¢žé•¿ï¼Œé¢„æµ‹å‡†ç¡®çŽ‡åœ¨ä¸‹é™ã€‚åŽŸå› ä¸Žå¤šé¡¹å¼è´å¶æ–¯åˆ†ç±»å™¨çš„æƒ…å†µç›¸åŒã€‚ æœ€åŽè€ƒå¯Ÿbinarizeçš„å‚æ•°å¯¹ä¼¯åŠªåˆ©è´å¶æ–¯åˆ†ç±»å™¨çš„é¢„æµ‹æ€§èƒ½çš„å½±å“ã€‚è¯¥å‚æ•°ç»™å®šäº†äºŒå…ƒåŒ–æ—¶ï¼Œ0-1çš„é˜ˆå€¼ã€‚ 123456789101112131415161718192021222324def demo_BernoulliNB_binarize(*data): X_train, X_test, y_train, y_test = data min_x = min(np.min(X_train.ravel()), np.min(X_test.ravel())) - 0.1 max_x = max(np.max(X_train.ravel()), np.max(X_test.ravel())) + 0.1 binarizes = np.linspace(min_x, max_x, endpoint=True, num=100) training_scores = [] testing_scores = [] for binarize in binarizes: cls = naive_bayes.BernoulliNB(binarize=binarize) cls.fit(X_train, y_train) training_scores.append(cls.score(X_train, y_train)) testing_scores.append(cls.score(X_test, y_test)) # ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) ax.plot(binarizes, training_scores, label=&quot;training score&quot;) ax.plot(binarizes, testing_scores, label=&quot;testing score&quot;) ax.set_xlabel(&quot;binarize&quot;) ax.set_ylabel(&quot;score&quot;) ax.set_ylim(0, 1.0) ax.set_xlim(min_x - 1, max_x + 1) ax.set_title(&quot;BernoullizNB&quot;) ax.legend(loc=&quot;best&quot;) plt.show() è¿è¡Œç»“æžœï¼š å½“æŒ‡å®šçš„binarizeçš„æœ€å°å€¼ä¸ºæ ·æœ¬é›†ï¼ˆåŒ…æ‹¬æµ‹è¯•é›†ï¼‰æ‰€ä»¥ç‰¹å¾çš„æ‰€æœ‰å€¼ä¸­çš„æœ€å°å€¼å‡åŽ»0.1ï¼Œå½“binarizeå–æœ€å°å€¼æ—¶æ‰€æœ‰ç‰¹å¾çš„æ‰€æœ‰å€¼éƒ½è§†ä¸º1ï¼›æŒ‡å®šçš„binarizeçš„æœ€å¤§å€¼ä¸ºæ ·æœ¬é›†ï¼ˆåŒ…æ‹¬æµ‹è¯•é›†ï¼‰æ‰€ä»¥ç‰¹å¾çš„æ‰€æœ‰å€¼ä¸­çš„æœ€å¤§å€¼åŠ ä¸Š0.1ï¼Œå½“binarizeå–æœ€å¤§å€¼æ—¶æ‰€æœ‰ç‰¹å¾çš„æ‰€æœ‰å€¼éƒ½è§†ä¸º0ã€‚å¯ä»¥çœ‹åˆ°å½“binarizeå¤ªå°æ—¶ï¼Œé¢„æµ‹å‡†ç¡®çŽ‡æ–­å´–å¼ä¸‹é™ï¼Œè¿™æ˜¯å› ä¸ºæ­¤æ—¶æ‰€æœ‰ç‰¹å¾çš„æ‰€æœ‰å€¼éƒ½è§†ä¸º0ï¼Œæ­¤æ—¶å¯¹äºŽä¼¯åŠªåˆ©è´å¶æ–¯åˆ†ç±»å™¨æ¥è®²ï¼Œæ‰€æœ‰æ ·æœ¬çš„æ‰€æœ‰ç‰¹å¾ä¹‹é—´æ²¡æœ‰ä»»ä½•åŒºåˆ†ï¼Œæ‰€ä»¥ä¹Ÿæ— ä»Žé¢„æµ‹ã€‚binarizeçš„å–å€¼å¿…é¡»åœ¨æ ·æœ¬é›†ï¼ˆåŒ…æ‹¬æµ‹è¯•é›†ï¼‰æ‰€æœ‰ç‰¹å¾çš„æ‰€æœ‰å€¼çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´ï¼Œä¸”æœ€å¥½èƒ½ä½¿å¾—äºŒå…ƒåŒ–ä¹‹åŽçš„ç‰¹å¾åˆ†å¸ƒå°½å¯èƒ½è¿‘ä¼¼äºŽåŽŸå§‹ç‰¹å¾çš„åˆ†å¸ƒã€‚ å¯ä»¥å°†binarizeå–â€œï¼ˆæ‰€æœ‰ç‰¹å¾çš„æ‰€æœ‰å€¼çš„æœ€å°å€¼+æ‰€æœ‰ç‰¹å¾æ‰€æœ‰å€¼çš„æœ€å¤§å€¼ï¼‰/2â€ é€’å¢žå¼å­¦ä¹ partial_fitæ–¹æ³• æœ´ç´ è´å¶æ–¯æ¨¡åž‹å¯ä»¥ç”¨æ¥è§£å†³å¤§è§„æ¨¡çš„åˆ†ç±»é—®é¢˜ï¼Œå…¶å®Œæ•´çš„è®­ç»ƒé›†å¯èƒ½ä¸é€‚åˆæ”¾åœ¨å†…å­˜ä¸­ã€‚ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸Šè¿°ä¸‰ä¸ªåˆ†ç±»å™¨éƒ½æœ‰ä¸€ä¸ªpartial_fitæ–¹æ³•ï¼Œå¯ä»¥åŠ¨æ€åœ°å¢žåŠ æ•°æ®æ¥ä½¿ç”¨(online classifier)ï¼Œèƒ½å¤Ÿç”¨äºŽé€’å¢žå¼å­¦ä¹ ã€‚ partial_fitçš„åŽŸåž‹ä¸ºpartial_fit(X, y, classes=None, sample_weight=None) X: æ ·æœ¬æ•°æ® y: æ ·æœ¬æ ‡è®° classes: ä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œå½¢çŠ¶ä¸º(n_classes,)ï¼Œå®ƒåˆ—å‡ºäº†æ‰€æœ‰å¯èƒ½çš„ç±»åˆ«ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨partial_fitæ—¶ï¼Œå¿…é¡»ä¼ å…¥è¯¥å‚æ•°ï¼ŒåŽç»­çš„è°ƒç”¨ä¸å¿…ä¼ å…¥ã€‚ sample_weight: ä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œå½¢çŠ¶ä¸º(n_samples,)ã€‚ç»™å‡ºæ¯ä¸ªæ ·æœ¬çš„æƒé‡ã€‚å¦‚æžœæœªæŒ‡å®šï¼Œåˆ™å…¨ä¸º1. ä½¿ç”¨è¯¥æ–¹æ³•æ—¶ï¼Œæœ€å¥½æ¯æ¬¡çš„æ•°æ®å—éƒ½è¶³å¤Ÿå¤§ï¼ŒæŽ¨èæ¯æ¬¡å¡«æ»¡æ•´ä¸ªå†…å­˜ã€‚]]></content>
      <categories>
        <category>Machine Learning</category>
      </categories>
      <tags>
        <tag>machine learning</tag>
        <tag>python</tag>
        <tag>sklearn</tag>
        <tag>bayes classifier</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MachineLearning Chapter-2 Decision Tree]]></title>
    <url>%2F2019%2F07%2F26%2FMachineLearning-Chapter-2-Decision-Tree%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿° å†³ç­–æ ‘(decision tree)æ˜¯åŠŸèƒ½å¼ºå¤§è€Œä¸”å¾ˆå—æ¬¢è¿Žçš„åˆ†ç±»å’Œé¢„æµ‹æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ç§æœ‰ç›‘ç£çš„å­¦ä¹ ç®—æ³•ï¼Œä»¥æ ‘çŠ¶å›¾ä¸ºåŸºç¡€ï¼Œå…¶è¾“å‡ºç»“æžœä¸ºä¸€ç³»åˆ—ç®€å•å®žç”¨çš„è§„åˆ™ã€‚å†³ç­–æ ‘å°±æ˜¯ä¸€ç³»åˆ—çš„if-thenäºŽè¯­å¥ï¼Œå¯ä»¥ç”¨äºŽåˆ†ç±»é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ç”¨äºŽå›žå½’é—®é¢˜ã€‚ å†³ç­–æ ‘æ¨¡åž‹åŸºäºŽç‰¹å¾å¯¹å®žä¾‹è¿›è¡Œåˆ†ç±»ï¼Œå®ƒæ˜¯ä¸€ç§æ ‘çŠ¶ç»“æž„ã€‚ä¼˜ç‚¹æ˜¯å¯è¯»æ€§å¼ºï¼Œåˆ†ç±»é€Ÿåº¦å¿«ã€‚å­¦ä¹ å†³ç­–æ ‘æ—¶ï¼Œé€šå¸¸é‡‡ç”¨æŸå¤±å‡½æ•°æœ€å°åŒ–åŽŸåˆ™ã€‚ æœ¬ç« ä¸­ï¼Œè®­ç»ƒé›†ç”¨Dè¡¨ç¤ºï¼ŒTè¡¨ç¤ºä¸€æ£µå†³ç­–æ ‘ã€‚ ç®—æ³• å†³ç­–æ ‘åŽŸç† å†³ç­–æ ‘æ˜¯ä¸€ä¸ªè´ªå¿ƒç®—æ³•ï¼Œå³åœ¨ç‰¹å¾ç©ºé—´ä¸Šæ‰§è¡Œé€’å½’çš„äºŒå…ƒåˆ†å‰²ï¼Œå†³ç­–æ ‘ç”±èŠ‚ç‚¹å’Œæœ‰å‘è¾¹ç»„æˆã€‚å†…éƒ¨èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾æˆ–è€…å±žæ€§ï¼Œå¶å­ç»“ç‚¹è¡¨ç¤ºä¸€ä¸ªåˆ†ç±»ã€‚ä½¿ç”¨å†³ç­–æ ‘è¿›è¡Œåˆ†ç±»æ—¶ï¼Œå°†å®žä¾‹åˆ†é…åˆ°å¶èŠ‚ç‚¹çš„ç±»ä¸­ï¼Œè¯¥å¶èŠ‚ç‚¹æ‰€å±žçš„ç±»å°±æ˜¯è¯¥èŠ‚ç‚¹çš„åˆ†ç±»ã€‚ å†³ç­–æ ‘å¯ä»¥è¡¨ç¤ºç»™å®šç‰¹å¾æ¡ä»¶ä¸‹ï¼Œç±»åˆ«çš„æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒã€‚å°†ç‰¹å¾ç©ºé—´åˆ’åˆ†ä¸ºäº’ä¸ç›¸äº¤çš„å•å…ƒ\(S_1,S_2,â€¦,S_m\)ã€‚è®¾æŸä¸ªå•å…ƒ\(S_i\)å†…éƒ¨æœ‰\(N_i\)ä¸ªæ ·æœ¬ç‚¹ï¼Œåˆ™å®ƒå®šä¹‰äº†ä¸€ä¸ªæ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒ\(P(y=c_k/X)\), \(X\in S_i\); \(c_k,k=1,2,â€¦,K\)ä¸ºç¬¬\(k\)ä¸ªåˆ†ç±»ã€‚ æ¯ä¸ªå•å…ƒå¯¹åº”äºŽå†³ç­–æ ‘çš„ä¸€æ¡è·¯å¾„ æ‰€æœ‰å•å…ƒçš„æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒæž„æˆäº†å†³ç­–æ ‘æ‰€ä»£è¡¨çš„æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒ åœ¨å•å…ƒ\(S_i\)å†…éƒ¨æœ‰\(N_i\)ä¸ªæ ·æœ¬ç‚¹ï¼Œä½†æ˜¯æ•´ä¸ªå•å…ƒéƒ½å±žäºŽç±»\(\hat{c}_k\)ã€‚å…¶ä¸­ï¼Œ\(\hat{c}_k=\arg_{c_k}\max P(y=c_k/X)\), \(X\in S_i\)ã€‚å³å•å…ƒ\(S_i\)å†…éƒ¨çš„\(N_i\)ä¸ªæ ·æœ¬ç‚¹ï¼Œå“ªä¸ªåˆ†ç±»å ä¼˜ï¼Œåˆ™æ•´ä¸ªå•å…ƒéƒ½å±žäºŽè¯¥ç±»ã€‚ æž„å»ºå†³ç­–æ ‘çš„æ­¥éª¤ æž„å»ºå†³ç­–æ ‘é€šå¸¸åŒ…æ‹¬ä¸‰ä¸ªæ­¥éª¤ï¼š ç‰¹å¾é€‰æ‹© å†³ç­–æ ‘ç”Ÿæˆ å†³ç­–æ ‘å‰ªæž å‡è®¾ç»™å®šè®­ç»ƒé›†\(D=\{(\vec{x}_1,y_1),(\vec{x}_2,y_2),â€¦,(\vec{x}_N,y_1N,\}\)ï¼Œå…¶ä¸­\(\vec{x}_i=(x_i^{(1)},x_i^{(2)},â€¦,x_i^{(n)})\)ä¸ºè¾“å…¥å®žä¾‹ï¼Œ\(n\)ä¸ºç‰¹å¾ä¸ªæ•°ï¼›\(y_i\in \{1,2,â€¦,K\}\)ä¸ºç±»æ ‡è®°ï¼Œ\(i=1,2,â€¦,N\)ï¼›\(N\)ä¸ºæ ·æœ¬å®¹é‡ã€‚æž„å»ºå†³ç­–æ ‘çš„ç›®æ ‡æ˜¯ï¼Œæ ¹æ®ç»™å®šçš„è®­ç»ƒæ•°æ®é›†å­¦ä¹ ä¸€ä¸ªå†³ç­–æ ‘æ¨¡åž‹ã€‚ æž„å»ºå†³ç­–æ ‘é€šå¸¸æ˜¯å°†æ­£åˆ™åŒ–çš„æžå¤§ä¼¼ç„¶å‡½æ•°ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œå…¶å­¦ä¹ ç›®æ ‡æ˜¯æŸå¤±å‡½æ•°ä¸ºç›®æ ‡å‡½æ•°çš„æœ€å°åŒ–ã€‚æž„å»ºå†³ç­–æ ‘çš„ç®—æ³•é€šå¸¸æ˜¯é€’å½’åœ°é€‰æ‹©æœ€ä¼˜ç‰¹å¾ï¼Œå¹¶æ ¹æ®è¯¥ç‰¹å¾å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œåˆ†å‰²ï¼Œå…¶æ­¥éª¤å¦‚ä¸‹ï¼š æž„å»ºæ ¹èŠ‚ç‚¹ï¼Œæ‰€æœ‰è®­ç»ƒæ ·æœ¬éƒ½ä½äºŽæ ¹èŠ‚ç‚¹ é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜ç‰¹å¾ã€‚é€šè¿‡è¯¥ç‰¹å¾å°†è®­ç»ƒæ•°æ®åˆ†å‰²æˆå­é›†ï¼Œç¡®ä¿å„ä¸ªå­é›†æœ‰æœ€å¥½çš„åˆ†ç±»ï¼Œä½†è¦è€ƒè™‘ä¸‹åˆ—ä¸¤ç§æƒ…å†µï¼š è‹¥å­é›†å·²èƒ½å¤Ÿè¢«è¾ƒå¥½åœ°åˆ†ç±»ï¼Œåˆ™æž„å»ºå¶èŠ‚ç‚¹ï¼Œå¹¶å°†è¯¥å­é›†åˆ’åˆ†åˆ°å¯¹åº”çš„å¶èŠ‚ç‚¹åŽ» è‹¥æŸä¸ªå­é›†ä¸èƒ½è¢«è¾ƒå¥½åœ°åˆ†ç±»ï¼Œåˆ™å¯¹è¯¥å­é›†ç»§ç»­åˆ’åˆ† é€’å½’ç›´è‡³æ‰€æœ‰è®­ç»ƒæ ·æœ¬éƒ½è¢«è¾ƒå¥½åœ°åˆ†ç±»ï¼Œæˆ–è€…æ²¡æœ‰åˆé€‚çš„ç‰¹å¾ä¸ºæ­¢ é€šè¿‡è¯¥æ­¥éª¤ç”Ÿæˆçš„å†³ç­–æ ‘å¯¹è®­ç»ƒæ ·æœ¬æœ‰å¾ˆå¥½çš„åˆ†ç±»èƒ½åŠ›ï¼Œä½†æˆ‘ä»¬éœ€è¦çš„æ˜¯å¯¹æœªçŸ¥æ ·æœ¬çš„åˆ†ç±»èƒ½åŠ›ã€‚å› æ­¤é€šå¸¸éœ€è¦å¯¹å·²ç”Ÿæˆçš„å†³ç­–æ ‘è¿›è¡Œå‰ªæžï¼Œä»Žè€Œä½¿å¾—å†³ç­–æ ‘å…·æœ‰æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›ã€‚å‰ªæžè¿‡ç¨‹æ˜¯åŽ»æŽ‰è¿‡äºŽç»†åˆ†çš„å¶èŠ‚ç‚¹ï¼Œä»Žè€Œæé«˜æ³›åŒ–èƒ½åŠ›ã€‚ ç‰¹å¾é€‰æ‹© ç‰¹å¾é€‰æ‹©å°±æ˜¯é€‰å–æœ‰è¾ƒå¼ºåˆ†ç±»èƒ½åŠ›çš„ç‰¹å¾ã€‚åˆ†ç±»èƒ½åŠ›é€šè¿‡ä¿¡æ¯å¢žç›Šæˆ–è€…ä¿¡æ¯å¢žç›Šæ¯”æ¥åˆ»ç”»ã€‚é€‰æ‹©ç‰¹å¾çš„æ ‡å‡†å°±æ˜¯æ‰¾å‡ºå±€éƒ¨æœ€ä¼˜çš„ç‰¹å¾ä½œä¸ºåˆ¤æ–­è¿›è¡Œåˆ‡åˆ†ï¼Œå–å†³äºŽåˆ‡åˆ†åŽèŠ‚ç‚¹æ•°æ®é›†åˆä¸­ç±»åˆ«çš„æœ‰åºç¨‹åº¦(çº¯åº¦)ï¼Œåˆ’åˆ†åŽçš„åˆ†åŒºæ•°æ®è¶Šçº¯ï¼Œåˆ‡åˆ†è§„åˆ™è¶Šåˆé€‚ã€‚è¡¡é‡èŠ‚ç‚¹æ•°æ®é›†åˆçš„çº¯åº¦æœ‰ï¼šç†µã€åŸºå°¼ç³»æ•°å’Œæ–¹å·®ã€‚ç†µå’ŒåŸºå°¼ç³»æ•°æ˜¯é’ˆå¯¹åˆ†ç±»çš„ï¼Œæ–¹å·®æ˜¯é’ˆå¯¹å›žå½’çš„ã€‚ ç†µ å…ˆç»™å‡ºç†µ(entropy)çš„å®šä¹‰ï¼Œè®¾Xæ˜¯ä¸€ä¸ªç¦»æ•£åž‹éšæœºå˜é‡ï¼Œå…¶æ¦‚çŽ‡åˆ†å¸ƒä¸º \[P(X=\vec{x}_i)=p_i,i=1,2,â€¦,n\] åˆ™éšæœºå˜é‡\(X\)çš„ç†µä¸ºï¼š \[H(X)=-\sum_{i=1}^n p_i \log p_i\] å…¶ä¸­ï¼Œå®šä¹‰\(0\log 0=0\)ã€‚ å½“éšæœºå˜é‡\(X\)åªå–ä¸¤ä¸ªå€¼æ—¶ï¼Œ\(X\)çš„åˆ†å¸ƒä¸ºï¼š \[P(X=1)=p \\ P(X=0)=1-p,0â‰¤pâ‰¤1\] æ­¤æ—¶ç†µä¸ºï¼š\(H(P)=-p\log p-(1-p)\log (1-p), 0â‰¤pâ‰¤1\) å½“\(p=0\)æˆ–è€…\(p=1\)æ—¶ï¼Œç†µæœ€å°(ä¸º0)ï¼Œæ­¤æ—¶éšæœºå˜é‡ä¸ç¡®å®šæ€§æœ€å° å½“\(p=0.5\)æ—¶ï¼Œç†µæœ€å¤§(ä¸º1)ï¼Œæ­¤æ—¶éšæœºå˜é‡ä¸ç¡®å®šæ€§æœ€å¤§ è®¾éšæœºå˜é‡\((X,Y)\)ï¼Œå…¶è”åˆæ¦‚çŽ‡åˆ†å¸ƒä¸ºï¼š\(P(X=\vec{x}_i,Y=y_j)=p_{ij}\), \(i=1,2,â€¦,n\); \(j=1,2,â€¦,m\)ã€‚åˆ™æ¡ä»¶ç†µ\(H(Y/X)\)å®šä¹‰ä¸ºï¼š \[H(Y/X)=\sum_{i=1}^n P_X(X=\vec{x}_i)H(Y/X=\vec{x}_i)\] å…¶ä¸­ï¼Œ\(P_X(X=\vec{x}_i)=\sum_YP(X=\vec{x}_i,Y)\) å½“ç†µä¸­çš„æ¦‚çŽ‡ç”±æ•°æ®ä¼°è®¡å¾—åˆ°æ—¶ï¼Œç§°ä¹‹ä¸ºç»éªŒç†µ å½“æ¡ä»¶ç†µä¸­çš„æ¦‚çŽ‡ç”±æ•°æ®ä¼°è®¡å¾—åˆ°æ—¶ï¼Œç§°ä¹‹ä¸ºç»éªŒæ¡ä»¶ç†µ ä¿¡æ¯å¢žç›Š å¯¹äºŽæ•°æ®é›†\(D\)ï¼Œæˆ‘ä»¬é€šè¿‡\(H(Y)\)æ¥åˆ»ç”»æ•°æ®é›†\(D\)çš„ä¸ç¡®å®šç¨‹åº¦ã€‚å½“æ•°æ®é›†\(D\)ä¸­çš„æ‰€æœ‰æ ·æœ¬éƒ½æ˜¯åŒä¸€ç±»åˆ«æ—¶ï¼Œ\(H(Y)=0\)ã€‚ä¹Ÿå°†\(H(Y)\)è®°ä½œ\(H(D)\)ã€‚ç»™å®šç‰¹å¾\(A\)å’Œè®­ç»ƒæ•°æ®é›†\(D\)ï¼Œå®šä¹‰ä¿¡æ¯å¢žç›Š\(g(D,A)\)ä¸ºï¼š\(g(D,A)=H(D)-H(D/A)\)ã€‚ ä¿¡æ¯å¢žç›Šåˆ»ç”»çš„æ˜¯ç”±äºŽç‰¹å¾\(A\)è€Œä½¿å¾—å¯¹æ•°æ®é›†\(D\)çš„åˆ†ç±»çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ã€‚æž„å»ºå†³ç­–æ ‘é€‰æ‹©ä¿¡æ¯å¢žç›Šå¤§çš„ç‰¹å¾æ¥åˆ’åˆ†æ•°æ®é›†ã€‚ è¿™é‡Œç»™å‡ºè®¡ç®—ä¿¡æ¯å¢žç›Šçš„ç®—æ³•ã€‚å‡è®¾è®­ç»ƒæ•°æ®é›†ä¸º\(D\)ï¼Œ\(N\)ä¸ºå…¶è®­ç»ƒæ•°æ®é›†å®¹é‡ã€‚å‡è®¾æœ‰\(K\)ä¸ªç±»åˆ«ä¾æ¬¡ä¸º\(c_k,k=1,2,â€¦,K\)ã€‚è®¾\(|C_k|\)ä¸ºå±žäºŽç±»\(c_k\)çš„æ ·æœ¬ä¸ªæ•°ã€‚ è®¾ç‰¹å¾\(A\)æ˜¯ç¦»æ•£çš„ï¼Œä¸”æœ‰\(n\)ä¸ªä¸åŒçš„å–å€¼ï¼š\(\{a_1,a_2,â€¦,a_n\}\)ï¼Œæ ¹æ®ç‰¹å¾\(A\)çš„å–å€¼å°†\(D\)åˆ’åˆ†å‡º\(n\)ä¸ªå­é›†ï¼š\(D_1,D_2,â€¦,D_n\)ï¼Œ\(N_i\)ä¸ºå¯¹åº”çš„\(D_i\)ä¸­çš„æ ·æœ¬ä¸ªæ•°ã€‚ è®¾é›†åˆ\(D_i\)ä¸­å±žäºŽç±»\(c_k\)çš„æ ·æœ¬é›†åˆä¸º\(D_{ik}\)ï¼Œå…¶å®¹é‡ä¸º\(N_{ik}\)ï¼Œä¿¡æ¯å¢žç›Šç®—æ³•å¦‚ä¸‹ï¼š è¾“å…¥ï¼š è®­ç»ƒæ•°æ®é›†\(D\) ç‰¹å¾\(A\) è¾“å‡ºï¼šä¿¡æ¯å¢žç›Š\(g(D,A)\) ç®—æ³•æ­¥éª¤ è®¡ç®—æ•°æ®é›†\(D\)çš„ç»éªŒç†µ\(H(D)\)ã€‚å®ƒå°±æ˜¯è®­ç»ƒæ•°æ®é›†\(D\)ä¸­ï¼Œåˆ†ç±»\(Y\)çš„æ¦‚çŽ‡ä¼°è®¡\(\hat{P}(Y=c_k)=\frac{|C_k|}{N}\)è®¡ç®—å¾—åˆ°çš„ç»éªŒç†µã€‚\[H(D)=-\sum_{k=1}^K\frac{|C_k|}{N}\log \frac{|C_k|}{N}\] è®¡ç®—ç‰¹å¾\(A\)å¯¹äºŽæ•°æ®é›†\(D\)çš„ç»éªŒæ¡ä»¶ç†µ\(H(D/A)\)ã€‚å®ƒä½¿ç”¨äº†ç‰¹å¾\(A\)çš„æ¦‚çŽ‡ä¼°è®¡ï¼š\(\hat{P}(X^{(A)}=a_i)=\frac{N_i}{N}\)ï¼Œä»¥åŠç»éªŒæ¡ä»¶ç†µï¼š\(\hat{H}(D/X^{(A)}=a_i)=\sum_{k=1}^K-(\frac{N_{ik}}{N_i}\log \frac{N_{ik}}{N_i})\)ï¼ˆå…¶ä¸­ä½¿ç”¨äº†æ¡ä»¶æ¦‚çŽ‡ä¼°è®¡\(\hat{P}(Y=c_k/X^{(A)}=a_i)=\frac{N_{ik}}{N_i}\)ï¼Œæ„ä¹‰æ˜¯ï¼šåœ¨å­é›†\(D_i\)ä¸­\(Y\)çš„åˆ†å¸ƒï¼‰\[H(D/A)=\sum_{i=1}^n\frac{N_i}{N}\sum_{k=1}^K-(\frac{N_{ik}}{N_i}\log \frac{N_{ik}}{N_i})\] è®¡ç®—ä¿¡æ¯å¢žç›Š\[g(D,A)=H(D)-H(D/A)\] ç†µè¶Šå¤§ï¼Œåˆ™è¡¨ç¤ºè¶Šæ··ä¹±ï¼›ç†µè¶Šå°ï¼Œåˆ™è¡¨ç¤ºè¶Šæœ‰åºã€‚å› æ­¤ä¿¡æ¯å¢žç›Šè¡¨ç¤ºæ··ä¹±çš„å‡å°‘ç¨‹åº¦ï¼ˆæœ‰åºçš„å¢žåŠ ç¨‹åº¦ï¼‰ã€‚ ä»¥ä¿¡æ¯å¢žç›Šä½œä¸ºåˆ’åˆ†è®­ç»ƒé›†çš„ç‰¹å¾é€‰å–æ–¹æ¡ˆï¼Œå­˜åœ¨åå‘äºŽé€‰å–å€¼è¾ƒå¤šçš„ç‰¹å¾çš„é—®é¢˜ã€‚å…¬å¼ï¼š \[g(D,A)=H(D)-H(D/A)=H(D)-\sum_{i=1}^n\frac{N_i}{N}\sum_{k=1}^K-(\frac{N_{ik}}{N_i}\log \frac{N_{ik}}{N_i})\] ä¿¡æ¯å¢žç›Šæ¯” åœ¨æžé™æƒ…å†µä¸‹ï¼Œç‰¹å¾\(A\)å°†æ¯ä¸€ä¸ªæ ·æœ¬ä¸€ä¸€å¯¹åº”åˆ°å¯¹åº”çš„èŠ‚ç‚¹å½“ä¸­åŽ»çš„æ—¶å€™(æ¯ä¸ªèŠ‚ç‚¹ä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæ ·æœ¬)ï¼Œæ­¤æ—¶\(\frac{N_{ik}}{N_i}=1,i=1,2,â€¦,n\)ï¼Œæ¡ä»¶ç†µéƒ¨åˆ†ä¸º0ã€‚è€Œæ¡ä»¶ç†µçš„æœ€å°å€¼ä¸º0ï¼Œè¿™æ„å‘³ç€è¯¥æƒ…å†µä¸‹çš„ä¿¡æ¯å¢žç›Šè¾¾åˆ°äº†æœ€å¤§å€¼ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªç‰¹å¾\(A\)æ˜¾ç„¶ä¸æ˜¯æœ€ä½³çš„é€‰æ‹©ã€‚ å¯ä»¥é€šè¿‡å®šä¹‰ä¿¡æ¯å¢žç›Šæ¯”æ¥è§£å†³ã€‚ç‰¹å¾\(A\)å¯¹è®­ç»ƒé›†\(D\)å¯¹ä¿¡æ¯å¢žç›Šæ¯”\(g_R(D,A)\)å®šä¹‰ä¸ºï¼š\[g_R(D,A)=\frac{g(D,A)}{H_A(D)}\\ H_A(D)=-\sum_{i=1}^n\frac{N_i}{N} \log \frac{N_i}{N}\] \(H_A(D)\)åˆ»ç”»äº†ç‰¹å¾\(A\)å¯¹è®­ç»ƒé›†\(D\)å¯¹åˆ†è¾¨èƒ½åŠ›ã€‚ä½†æ˜¯è¿™ä¸è¡¨å¾å®ƒå¯¹ç±»åˆ«çš„åˆ†è¾¨èƒ½åŠ›ã€‚æ¯”å¦‚\(A\)å°†\(D\)åˆ‡åˆ†æˆäº†2å—\(D_1\)å’Œ\(D_2\)ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½\(H(D)=H(D_1)=H(D_2)\)ï¼ˆå¦‚æ¯ä¸ªå­é›†\(D_i\)ä¸­å„ç±»åˆ«æ ·æœ¬çš„æ¯”ä¾‹ä¸Ž\(D\)ä¸­å„ç±»åˆ«æ ·æœ¬çš„æ¯”ä¾‹ç›¸åŒï¼‰ã€‚ å†³ç­–æ ‘ç”Ÿæˆ åŸºç¡€çš„å†³ç­–æ ‘ç”Ÿæˆç®—æ³•ä¸­ï¼Œå…¸åž‹çš„æœ‰ID3ç”Ÿæˆç®—æ³•å’ŒC4.5ç”Ÿæˆç®—æ³•ï¼Œå®ƒä»¬ç”Ÿæˆæ ‘çš„è¿‡ç¨‹å¤§è‡´ç›¸ä¼¼ã€‚ID3æ˜¯é‡‡ç”¨çš„ä¿¡æ¯å¢žç›Šä½œä¸ºç‰¹å¾é€‰æ‹©çš„åº¦é‡ï¼Œè€ŒC4.5åˆ™é‡‡ç”¨ä¿¡æ¯å¢žç›Šæ¯”ã€‚ ID3ç”Ÿæˆç®—æ³• ID3ç”Ÿæˆç®—æ³•åº”ç”¨ä¿¡æ¯å¢žç›Šå‡†åˆ™é€‰æ‹©ç‰¹å¾ï¼Œå…¶ç®—æ³•æè¿°å¦‚ä¸‹ï¼š è¾“å…¥ï¼š è®­ç»ƒæ•°æ®é›†\(D\) ç‰¹å¾é›†\(A\) ç‰¹å¾ä¿¡æ¯å¢žç›Šé˜ˆå€¼\(\varepsilon &gt;0\) è¾“å‡ºï¼šå†³ç­–æ ‘\(T\) ç®—æ³•æ­¥éª¤ è‹¥\({D}\)ä¸­æ‰€æœ‰å®žä¾‹å‡å±žäºŽåŒä¸€ç±»\({c_k}\)ï¼Œåˆ™\({T}\)ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°†\(c_k\)ä½œä¸ºè¯¥èŠ‚ç‚¹çš„åæ ‡è®°ï¼Œè¿”å›ž\(T\)ã€‚è¿™æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼š\(D\)çš„åˆ†ç±»é›†åˆåªæœ‰ä¸€ä¸ªåˆ†ç±»ã€‚ è‹¥\(A=\phi\)ï¼Œåˆ™\(T\)ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå°†\(D\)ä¸­å®žä¾‹æ•°æœ€å¤§çš„ç±»\(c_k\)ä½œä¸ºè¯¥èŠ‚ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å›ž\(T\)ï¼ˆå³å¤šæ•°è¡¨å†³ï¼‰ã€‚è¿™ä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼š\(D\)çš„ç‰¹å¾é›†åˆä¸ºç©ºã€‚ å¦åˆ™è®¡ç®—\(g(D,A_i)\)ï¼Œå…¶ä¸­\(A_i \in A\)ä¸ºç‰¹å¾é›†åˆä¸­çš„å„ä¸ªç‰¹å¾ï¼Œé€‰æ‹©ä¿¡æ¯å¢žç›Šæœ€å¤§çš„ç‰¹å¾$ A_g $ã€‚ åˆ¤æ–­\({A_g}\)çš„ä¿¡æ¯å¢žç›Š è‹¥\({g(D,A_g)&lt; \varepsilon}\)ï¼Œåˆ™ç½®\({T}\)ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå°†\({D}\)ä¸­å®žä¾‹æ•°æœ€å¤§çš„ç±»\({c_k}\)ä½œä¸ºè¯¥èŠ‚ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å›ž\({T}\)ã€‚ å¦‚æžœä¸è®¾ç½®ç‰¹å¾ä¿¡æ¯å¢žç›Šçš„ä¸‹é™ï¼Œåˆ™å¯èƒ½ä¼šä½¿æ¯ä¸ªå¶å­éƒ½åªæœ‰ä¸€ä¸ªæ ·æœ¬ç‚¹ï¼Œä»Žè€Œåˆ’åˆ†å¾—å¤ªç»† è‹¥\({g(D,A_g)â‰¥ \varepsilon}\)ï¼Œåˆ™å¯¹\({A_g}\)ç‰¹å¾å¯¹æ¯ä¸ªå¯èƒ½å–å€¼\({a_i}\)ï¼Œæ ¹æ®\({A_g=a_i}\)å°†\({D}\)åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéžç©ºå­é›†\({D_i}\)ï¼Œå°†\({D_i}\)ä¸­å®žä¾‹æ•°æœ€å¤§çš„ç±»ä½œä¸ºæ ‡è®°ï¼Œæž„å»ºå­èŠ‚ç‚¹ï¼Œç”±å­èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹æž„æˆæ ‘\({T}\)ï¼Œè¿”å›ž\({T}\)ã€‚ å¯¹ç¬¬\(i\)ä¸ªå­èŠ‚ç‚¹ï¼Œä»¥\(D_i\)ä¸ºè®­ç»ƒé›†ï¼Œä»¥\(A-\{A_g\}\)ä¸ºç‰¹å¾é›†ï¼Œé€’å½’åœ°è°ƒç”¨å‰é¢çš„æ­¥éª¤ï¼Œå¾—åˆ°å­æ ‘\(T_i\)ï¼Œè¿”å›ž\(T_i\)ã€‚ C4.5ç”Ÿæˆç®—æ³• C4.5ç”Ÿæˆç®—æ³•åº”ç”¨ä¿¡æ¯å¢žç›Šæ¯”æ¥é€‰æ‹©ç‰¹å¾ï¼Œå…¶ç®—æ³•æè¿°å¦‚ä¸‹ï¼š è¾“å…¥ è®­ç»ƒæ•°æ®é›†\(D\) ç‰¹å¾é›†\(A\) ç‰¹å¾ä¿¡æ¯å¢žç›Šæ¯”çš„é˜ˆå€¼\(\varepsilon &gt;0\) è¾“å‡ºï¼šå†³ç­–æ ‘\(T\) ç®—æ³•æ­¥éª¤ è‹¥\(D\)ä¸­æ‰€æœ‰å®žä¾‹å‡å±žäºŽåŒä¸€ç±»\(c_k\)ï¼Œåˆ™\(T\)ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°†\(c_k\)ä½œä¸ºè¯¥èŠ‚ç‚¹çš„åæ ‡è®°ï¼Œè¿”å›ž\(T\)ã€‚è¿™æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼š\(D\)çš„åˆ†ç±»é›†åˆåªæœ‰ä¸€ä¸ªåˆ†ç±»ã€‚ è‹¥\({A=\phi }\)ï¼Œåˆ™\(T\)ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå°†\(D\)ä¸­å®žä¾‹æ•°æœ€å¤§çš„ç±»\(c_k\)ä½œä¸ºè¯¥èŠ‚ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å›ž\(T\)ï¼ˆå³å¤šæ•°è¡¨å†³ï¼‰ã€‚è¿™ä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼š\(D\)çš„ç‰¹å¾é›†åˆä¸ºç©ºã€‚ å¦åˆ™è®¡ç®—\(g_R(D,A_i)\)ï¼Œå…¶ä¸­\(A_i \in A\)ä¸ºç‰¹å¾é›†åˆä¸­çš„å„ä¸ªç‰¹å¾ï¼Œé€‰æ‹©ä¿¡æ¯å¢žç›Šæ¯”æœ€å¤§çš„ç‰¹å¾\(A_g\)ã€‚ åˆ¤æ–­\(A_g\)çš„ä¿¡æ¯å¢žç›Šæ¯” è‹¥\({g_R(D,A_g)&lt;\varepsilon }\)ï¼Œåˆ™ç½®\(T\)ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå°†\(D\)ä¸­å®žä¾‹æ•°æœ€å¤§çš„ç±»\(c_k\)ä½œä¸ºè¯¥èŠ‚ç‚¹çš„ç±»æ ‡è®°(å¤šæ•°è¡¨å†³)ï¼Œè¿”å›ž\(T\)ã€‚ è‹¥\({g_R(D,A_g)â‰¥\varepsilon }\)ï¼Œåˆ™å¯¹\(A_g\)ç‰¹å¾å¯¹æ¯ä¸ªå¯èƒ½å–å€¼\(a_i\)ï¼Œæ ¹æ®\(A_g=a_i\)å°†\(D\)åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéžç©ºå­é›†\(D_i\)ï¼Œå°†\(D_i\)ä¸­å®žä¾‹æ•°æœ€å¤§çš„ç±»ä½œä¸ºæ ‡è®°(å¤šæ•°è¡¨å†³)ï¼Œæž„å»ºå­èŠ‚ç‚¹ï¼Œç”±å­èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹æž„æˆæ ‘\(T\)ï¼Œè¿”å›ž\(T\)ã€‚ å¯¹ç¬¬\(i\)ä¸ªå­èŠ‚ç‚¹ï¼Œä»¥\(D_i\)ä¸ºè®­ç»ƒé›†ï¼Œä»¥\(A-\{A_g\}\)ä¸ºç‰¹å¾é›†ï¼Œé€’å½’åœ°è°ƒç”¨å‰é¢çš„æ­¥éª¤ï¼Œå¾—åˆ°å­æ ‘\(T_i\)ï¼Œè¿”å›ž\(T_i\)ã€‚ è¯´æ˜Ž C4.5ç®—æ³•ç»§æ‰¿äº†ID3ç®—æ³•çš„ä¼˜ç‚¹ï¼Œå¹¶åœ¨ä»¥ä¸‹å‡ æ–¹é¢å¯¹ID3ç®—æ³•è¿›è¡Œäº†æ”¹è¿›ï¼š ç”¨ä¿¡æ¯å¢žç›ŠçŽ‡æ¥é€‰æ‹©å±žæ€§ï¼Œå…‹æœäº†ç”¨ä¿¡æ¯å¢žç›Šé€‰æ‹©å±žæ€§æ—¶åå‘é€‰æ‹©å–å€¼å¤šçš„å±žæ€§çš„ä¸è¶³ åœ¨æ ‘æž„é€ è¿‡ç¨‹ä¸­è¿›è¡Œå‰ªæž èƒ½å¤Ÿå®Œæˆå¯¹è¿žç»­å±žæ€§çš„ç¦»æ•£åŒ–å¤„ç† èƒ½å¤Ÿå¯¹ä¸å®Œæ•´æ•°æ®è¿›è¡Œå¤„ç† C4.5ç®—æ³•ä¼˜ç‚¹ï¼šäº§ç”Ÿçš„åˆ†ç±»è§„åˆ™æ˜“äºŽç†è§£ï¼Œå‡†ç¡®çŽ‡è¾ƒé«˜ã€‚ç¼ºç‚¹ï¼šåœ¨æž„é€ æ ‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¯¹æ•°æ®é›†è¿›è¡Œå¤šæ¬¡å¯¹é¡ºåºæ‰«æå’ŒæŽ’åºï¼Œå› è€Œå¯¼è‡´äº†ç®—æ³•çš„ä½Žæ•ˆã€‚æ­¤å¤–ï¼ŒC4.5åªé€‚åˆäºŽèƒ½å¤Ÿé©»ç•™äºŽå†…å­˜çš„æ•°æ®é›†ï¼Œå½“è®­ç»ƒé›†å¤§å¾—æ— æ³•åœ¨å†…å­˜å®¹çº³æ—¶ç¨‹åºæ— æ³•è¿è¡Œã€‚ å†³ç­–æ ‘å¯èƒ½åªæ˜¯ç”¨åˆ°ç‰¹å¾é›†ä¸­çš„éƒ¨åˆ†ç‰¹å¾ C4.5å’ŒID3ä¸¤ä¸ªç®—æ³•åªæœ‰æ ‘çš„ç”Ÿæˆç®—æ³•ï¼Œç”Ÿæˆçš„æ ‘å®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆã€‚å³å¯¹è®­ç»ƒé›†åŒ¹é…å¾ˆå¥½ï¼Œä½†æ˜¯é¢„æµ‹æµ‹è¯•é›†æ•ˆæžœè¾ƒå·®ã€‚ å†³ç­–æ ‘å‰ªæž å†³ç­–æ ‘éœ€è¦å‰ªæžçš„åŽŸå› ï¼šå†³ç­–æ ‘ç”Ÿæˆç®—æ³•ç”Ÿæˆçš„æ ‘å¯¹è®­ç»ƒæ•°æ®çš„é¢„æµ‹å¾ˆå‡†ç¡®ï¼Œä½†æ˜¯å¯¹äºŽæœªçŸ¥çš„æ•°æ®åˆ†ç±»å´å¾ˆå·®ï¼Œè¿™å°±äº§ç”Ÿè¿‡æ‹Ÿåˆçš„çŽ°è±¡ã€‚å‘ç”Ÿè¿‡æ‹Ÿåˆæ˜¯ç”±äºŽå†³ç­–æ ‘å¤ªå¤æ‚ï¼Œè§£å†³è¿‡æ‹Ÿåˆçš„æ–¹æ³•å°±æ˜¯æŽ§åˆ¶æ¨¡åž‹çš„å¤æ‚åº¦ï¼Œå¯¹äºŽå†³ç­–æ ‘æ¥è¯´å°±æ˜¯ç®€åŒ–æ¨¡åž‹ï¼Œç§°ä¸ºå‰ªæžã€‚ å†³ç­–æ ‘å‰ªæžè¿‡ç¨‹æ˜¯ä»Žå·²ç”Ÿæˆçš„å†³ç­–æ ‘ä¸Šè£æŽ‰ä¸€äº›å­æ ‘æˆ–è€…å¶èŠ‚ç‚¹ã€‚å‰ªæžçš„ç›®æ ‡æ˜¯é€šè¿‡æžå°åŒ–å†³ç­–æ ‘çš„æ•´ä½“æŸå¤±å‡½æ•°æˆ–ä»£ä»·å‡½æ•°æ¥å®žçŽ°çš„ã€‚ å†³ç­–æ ‘å‰ªæžçš„ç›®çš„æ˜¯é€šè¿‡å‰ªæžæ¥æé«˜æ³›åŒ–èƒ½åŠ›ã€‚å‰ªæžçš„æ€è·¯å°±æ˜¯ä¸­å†³ç­–æ ‘å¯¹è®­ç»ƒæ•°æ®çš„é¢„æµ‹è¯¯å·®å’Œæ•°æ®å¤æ‚åº¦ä¹‹é—´æ‰¾åˆ°ä¸€ä¸ªå¹³è¡¡ã€‚ è®¾æ ‘\(T\)çš„å¶èŠ‚ç‚¹ä¸ªæ•°ä¸º\(|T_f|\)ï¼Œ\(t\)ä¸ºæ ‘çš„å¶èŠ‚ç‚¹ï¼Œè¯¥å¶èŠ‚ç‚¹æœ‰\(N_t\)ä¸ªæ ·æœ¬ç‚¹ï¼Œå…¶ä¸­å±žäºŽ\(c_k\)ç±»çš„æ ·æœ¬ç‚¹æœ‰\(N_tk\)ï¼Œ\(k=1,2,â€¦,K\)ä¸ªã€‚åˆ™æœ‰ï¼š\(\sum_{k=1}^KN_{tk}=N_t\)ã€‚ ä»¤\(H(t)\)ä¸ºå¶èŠ‚ç‚¹\(t\)ä¸Šçš„ç»éªŒç†µï¼Œ\(\alpha â‰¥0\)ä¸ºå‚æ•°ï¼Œåˆ™å†³ç­–æ ‘\(T\)çš„æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š \[C_{\alpha }(T)=\sum_{t=1}^{|T_f|}N_tH(t)+\alpha |T_f|H(t)=-\sum_{k=1}^K\frac{N_{tk}}{N_t}\log \frac{N_{tk}}{N_t}\] ä»¤ï¼š \[C(T)=\sum_{t=1}^{|T_f|}N_tH(t)=-\sum_{t=1}^{|T_f|}\sum_{k=1}^KN_{tk}\log \frac{N_{tk}}{N_t}\] åˆ™ï¼š\(C_{\alpha }(T)=C(T)+\alpha |T_f|\)ï¼Œå…¶ä¸­\(\alpha |T_f|\)ä¸ºæ­£åˆ™åŒ–é¡¹ï¼Œ\(C(T)\)è¡¨ç¤ºé¢„æµ‹è¯¯å·®ã€‚ \(C(T)=0\)æ„å‘³ç€\(N_{tk}=N_t\)ï¼Œå³æ¯ä¸ªèŠ‚ç‚¹\(t\)å†…çš„æ ·æœ¬éƒ½æ˜¯çº¯çš„ï¼ˆå•ä¸€çš„åˆ†ç±»ï¼‰ã€‚ å†³ç­–æ ‘åˆ’åˆ†å¾—è¶Šç»†è‡´ï¼Œåˆ™\(T\)çš„å¶å­èŠ‚ç‚¹è¶Šå¤šï¼Œ\(|T_f|\)è¶Šå¤§ï¼›\(|T_f|\)å°äºŽç­‰äºŽæ ·æœ¬é›†çš„æ•°é‡ï¼Œå½“å–ç­‰å·æ—¶ï¼Œæ ‘\(T\)çš„æ¯ä¸ªå¶å­èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªæ ·æœ¬ç‚¹ã€‚ å‚æ•°\(\alpha\)æŽ§åˆ¶é¢„æµ‹è¯¯å·®ä¸Žæ¨¡åž‹å¤æ‚åº¦ä¹‹é—´çš„å…³ç³» è¾ƒå¤§çš„\(\alpha\)ä¼šé€‰æ‹©è¾ƒç®€å•çš„æ¨¡åž‹ è¾ƒå°çš„\(\alpha\)ä¼šé€‰æ‹©è¾ƒå¤æ‚çš„æ¨¡åž‹ \(\alpha =0\)åªè€ƒè™‘è®­ç»ƒæ•°æ®ä¸Žæ¨¡åž‹çš„æ‹Ÿåˆç¨‹åº¦ï¼Œä¸è€ƒè™‘æ¨¡åž‹å¤æ‚åº¦ å‰ªæžç®—æ³•æè¿°å¦‚ä¸‹ï¼š è¾“å…¥ï¼š ç”Ÿæˆæ ‘\(T\) å‚æ•°\({\alpha}\) è¾“å‡ºï¼šå‰ªæžæ ‘\(T_{\alpha}\) ç®—æ³•æ­¥éª¤å¦‚ä¸‹ è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„ç»éªŒç†µ é€’å½’åœ°ä»Žæ ‘çš„å¶èŠ‚ç‚¹å‘ä¸Šå›žé€€ è®¾ä¸€ç»„å¶èŠ‚ç‚¹å›žé€€åˆ°çˆ¶èŠ‚ç‚¹ä¹‹å‰ä¸Žä¹‹åŽçš„æ•´æ£µæ ‘åˆ†åˆ«ä¸º\(T_t\)ä¸Ž\(T_t&#39;\)ï¼Œå¯¹åº”çš„æŸå¤±å‡½æ•°å€¼åˆ†åˆ«ä¸º\(C_{\alpha }(T_t)\)ä¸Ž\(C_{\alpha }(T_t&#39;)\)ã€‚è‹¥\(C_{\alpha }(T_t&#39;)â‰¤C_{\alpha }(T_t)\)ï¼Œåˆ™è¿›è¡Œå‰ªæžå¹¶å°†çˆ¶èŠ‚ç‚¹å˜æˆæ–°çš„å¶èŠ‚ç‚¹ã€‚ é€’å½’è¿›è¡Œä¸Šä¸€æ­¥ï¼Œç›´åˆ°ä¸èƒ½ç»§ç»­ä¸ºæ­¢ï¼Œå¾—åˆ°æŸå¤±å‡½æ•°æœ€å°çš„å­æ ‘\(T_{\alpha}\) CARTç®—æ³• åˆ†ç±»ä¸Žå›žå½’æ ‘(Classfification And Regression Tree, CART)æ¨¡åž‹ä¹Ÿæ˜¯ä¸€ç§å†³ç­–æ ‘æ¨¡åž‹ï¼Œå®ƒå³å¯ç”¨äºŽåˆ†ç±»ï¼Œä¹Ÿå¯ç”¨äºŽå›žå½’ã€‚å…¶å­¦ä¹ ç®—æ³•åˆ†ä¸ºä¸¤æ­¥ï¼š å†³ç­–æ ‘ç”Ÿæˆï¼šç”¨è®­ç»ƒæ¨¡åž‹ç”Ÿæˆå†³ç­–æ ‘ï¼Œç”Ÿæˆæ ‘å°½å¯èƒ½åœ°å¤§ å†³ç­–æ ‘å‰ªæžï¼šåŸºäºŽæŸå¤±å‡½æ•°æœ€å°åŒ–çš„æ ‡å‡†ï¼Œç”¨éªŒè¯æ•°æ®å¯¹ç”Ÿæˆçš„å†³ç­–æ ‘å‰ªæž åˆ†ç±»ä¸Žå›žå½’æ ‘æ¨¡åž‹é‡‡ç”¨ä¸åŒçš„æœ€ä¼˜åŒ–ç­–ç•¥ã€‚CARTå›žå½’ç”Ÿæˆæ ‘ç”¨å¹³æ–¹è¯¯å·®æœ€å°åŒ–ç­–ç•¥ï¼ŒCARTåˆ†ç±»ç”Ÿæˆæ ‘é‡‡ç”¨åŸºå°¼æŒ‡æ•°æœ€å°åŒ–ç­–ç•¥ã€‚ CARTå›žå½’æ ‘ ç»™å®šè®­ç»ƒæ•°æ®é›†\(D=\{(\vec{x}_1,y_1),(\vec{x}_2,y_2),â€¦,(\vec{x}_N,y_N)\}\), \(y_i\in R\)ã€‚è®¾å·²ç»å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º\(M\)ä¸ªå•å…ƒ\(R_1,R_2,â€¦,R_M\)ï¼Œä¸”åœ¨å•å…ƒ\(R_m\)ä¸Šè¾“å‡ºå€¼ä¸º\(c_m\), \(m=1,2,â€¦,M\)ã€‚åˆ™å›žå½’æ ‘æ¨¡åž‹ä¸ºï¼š \[f(\vec{x})=\sum_{m=1}^Mc_mI(\vec{x}\in R_m)\] å…¶ä¸­ï¼Œ\(I(Â·)\)ä¸ºç¤ºæ€§å‡½æ•°ã€‚ å¦‚æžœç»™å®šè¾“å…¥ç©ºé—´çš„ä¸€ä¸ªåˆ’åˆ†ï¼Œåˆ™å›žå½’æ ‘åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šçš„è¯¯å·®ï¼ˆå¹³æ–¹è¯¯å·®ï¼‰ä¸ºï¼š \[\sum_{\vec{x}_i\in R_m}(y_i-f(\vec{x}))^2\] åŸºäºŽå¹³æ–¹è¯¯å·®æœ€å°çš„å‡†åˆ™ï¼Œå¯ä»¥æ±‚è§£å‡ºæ¯ä¸ªå•å…ƒä¸Šçš„æœ€ä¼˜è¾“å‡ºå€¼\(\hat{c}_m\)ï¼š\(\hat{c}_m=ave(y_i | \vec{x}_i \in R_m)\)ã€‚å®ƒå°±æ˜¯\(R_m\)ä¸Šæ‰€æœ‰è¾“å…¥æ ·æœ¬å¯¹åº”çš„è¾“å‡º\(y_i\)çš„å¹³å‡å€¼ã€‚ çŽ°åœ¨éœ€è¦æ‰¾åˆ°æœ€ä½³çš„åˆ’åˆ†ï¼Œä½¿å¾—è¯¥åˆ’åˆ†å¯¹åº”çš„å›žå½’æ ‘çš„å¹³æ–¹è¯¯å·®åœ¨æ‰€æœ‰åˆ’åˆ†ä¸­æœ€å°ã€‚è®¾\(\vec{x}_i=(,x_i^{(1)},x_i^{(2)},â€¦,x_i^{(k)})\)ï¼Œå³è¾“å…¥ä¸º\(k\)ç»´ã€‚é€‰æ‹©ç¬¬\(j\)ç»´\(x_i^{(j)}\)ï¼Œå®ƒçš„å–å€¼\(s\)ä½œä¸ºåˆ‡åˆ†å˜é‡å’Œåˆ‡åˆ†ç‚¹ã€‚å®šä¹‰ä¸¤ä¸ªåŒºåŸŸï¼š \[R_1(j,s)=\{\vec{x}|x^{(j)}â‰¤s\} \\ R_2(j,s)=\{\vec{x}|x^{(j)}&gt;s\}\] ç„¶åŽå¯»æ±‚æœ€ä¼˜åˆ‡åˆ†å˜é‡\(j\)å’Œæœ€ä¼˜åˆ‡åˆ†ç‚¹\(s\)ã€‚å³æ±‚è§£ï¼š \[\min_{j,s}[\min_{c_1}\sum_{x_i\in R_1(j,s)}(y_i-c_1)^2+\min_{c_2}\sum_{x_i\in R_2(j,s)}(y_i-c_2)^2]\] å¯¹äºŽç»™å®šçš„ç»´åº¦\(j\)å¯ä»¥æ‰¾åˆ°æœ€ä¼˜åˆ‡åˆ†ç‚¹\(s\)ã€‚åŒæ—¶: \[\hat{c}_1=ave(y_i|\vec{x}_i\in R_1(j,s)) \\ \hat{c}_2=ave(y_i|\vec{x}_i\in R_2(j,s))\] é—®é¢˜æ˜¯å¦‚ä½•æ±‚è§£\(j\)ï¼šé¦–å…ˆéåŽ†æ‰€æœ‰ç»´åº¦ï¼Œæ‰¾åˆ°æœ€ä¼˜åˆ‡åˆ†ç»´åº¦\(j\)ï¼›ç„¶åŽå¯¹è¯¥ç»´åº¦æ‰¾åˆ°æœ€ä¼˜åˆ‡åˆ†ç‚¹\(s\)æž„æˆä¸€ä¸ª\((j,s)\)å¯¹ï¼Œå¹¶å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸã€‚ç„¶åŽåœ¨å­åŒºåŸŸä¸­é‡å¤åˆ’åˆ†è¿‡ç¨‹ï¼Œç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶ä¸ºæ­¢ã€‚è¿™æ ·çš„å›žå½’æ ‘ç§°ä¸ºæœ€å°äºŒä¹˜å›žå½’æ ‘ã€‚ æœ€å°äºŒä¹˜å›žå½’æ ‘ç”Ÿæˆç®—æ³•æè¿°å¦‚ä¸‹ï¼š è¾“å…¥ è®­ç»ƒæ•°æ®é›†\(D\) åœæ­¢è®¡ç®—æ¡ä»¶ è¾“å‡ºï¼šCARTå›žå½’æ ‘\(f(\vec{x})\) ç®—æ³•æ­¥éª¤ é€‰æ‹©æ•°æ®é›†\(D\)çš„æœ€ä¼˜åˆ‡åˆ†ç»´åº¦\(j\)å’Œåˆ‡åˆ†ç‚¹\(s\)ï¼Œå³æ±‚è§£ï¼š\[\min_{j,s}[\min_{c_1}\sum_{x_i\in R_1(j,s)}(y_i-c_1)^2+\min_{c_2}\sum_{x_i\in R_2(j,s)}(y_i-c_2)^2]\] æ±‚è§£æ–¹æ³•ï¼šéåŽ†\(j,s\)æ‰¾åˆ°ä½¿ä¸Šå¼æœ€å°çš„\((j,s)\)å¯¹ ç”¨é€‰å®šçš„\((j,s)\)åˆ’åˆ†åŒºåŸŸå¹¶å†³å®šç›¸åº”çš„è¾“å‡ºå€¼ï¼š\[R_1(j,s)=\{\vec{x}|x^{(j)}â‰¤s\} \\ R_2(j,s)=\{\vec{x}|x^{(j)}&gt;s\} \\ \hat{c}_1=ave(y_i|\vec{x}_i\in R_1(j,s)) \\ \hat{c}_2=ave(y_i|\vec{x}_i\in R_2(j,s))\] å¯¹å­åŒºåŸŸ\(R_1,R_2\)é€’å½’åœ°è°ƒç”¨ä¸Šé¢ä¸¤æ­¥ï¼Œç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶ä¸ºæ­¢ å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º\(M\)ä¸ªåŒºåŸŸ\(R_1,R_2,â€¦,R_m\)ï¼Œç”Ÿæˆå†³ç­–æ ‘ï¼š\[f(\vec{x})=\sum_{m=1}^M\hat{c_m}I(\vec{x}\in R_m)\] é€šå¸¸çš„åœæ­¢æ¡ä»¶ä¸ºä¸‹åˆ—æ¡ä»¶ä¹‹ä¸€ï¼š èŠ‚ç‚¹ä¸­æ ·æœ¬ä¸ªæ•°å°äºŽé¢„å®šå€¼ æ ·æœ¬é›†çš„å¹³æ–¹è¯¯å·®å°äºŽé¢„å®šå€¼ æ²¡æœ‰æ›´å¤šçš„ç‰¹å¾ CARTåˆ†ç±»æ ‘ å‡è®¾æœ‰\(K\)ä¸ªåˆ†ç±»ï¼Œæ ·æœ¬ç‚¹å±žäºŽç¬¬\(k\)ç±»çš„æ¦‚çŽ‡ä¸º\(p_k=P(Y=c_k)\)ã€‚å®šä¹‰æ¦‚çŽ‡åˆ†å¸ƒçš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š \[Gini(p)=\sum_{k=1}^Kp_k(1-p_k)=1-\sum_{k=1}^Kp_k^2\] å¯¹äºŽç»™å®šçš„æ ·æœ¬é›†åˆ\(D\)ï¼Œè®¾å±žäºŽç±»\(c_k\)çš„æ ·æœ¬å­é›†ä¸º\(C_k\)ï¼Œåˆ™åŸºå°¼æŒ‡æ•°ä¸ºï¼š \[Gini(D)=1-\sum_{k=1}^K(\frac{|C_k|}{|D|})^2\] ç»™å®šç‰¹å¾\(A\),æ ¹æ®å…¶æ˜¯å¦å–æŸä¸€ä¸ªå¯èƒ½å€¼\(a\)ï¼Œæ ·æœ¬é›†\(D\)è¢«åˆ†ä¸ºä¸¤ä¸ªå­é›†\(D_1\)å’Œ\(D_2\)ï¼Œå…¶ä¸­ï¼š \[D_1=\{(\vec{x},y)\in D|\vec{x}^{(A)}=a\}\\D_2=\{(\vec{x},y)\in D|\vec{x}^{(A)}â‰ a\}=D-D_1\] å®šä¹‰\(Gini(D,A)\)ï¼š \[Gini(D,A)=\frac{|D_1|}{|D|}Gini(D_1)+\frac{|D_2|}{|D|}Gini(D_2)\] å®ƒè¡¨ç¤ºåœ¨ç‰¹å¾\(A\)çš„æ¡ä»¶ä¸‹ï¼Œé›†åˆ\(D\)çš„åŸºå°¼æŒ‡æ•°ã€‚ å¯¹äºŽæœ€ç®€å•çš„äºŒé¡¹åˆ†å¸ƒï¼Œè®¾\(P(X=1)=p,P(X=0)=1-p\)ï¼Œå…¶åŸºå°¼ç³»æ•°å’Œç†µä¸€æ ·ï¼Œä¹Ÿæ˜¯ç”¨äºŽåº¦é‡ä¸ç¡®å®šæ€§ã€‚å¯¹äºŽæ ·æœ¬é›†\(D\)ï¼Œ\(Gini(D)\)è¶Šå°è¯´æ˜Žæ ·æœ¬è¶Šå±žäºŽåŒä¸€ç±»ã€‚ CARTåˆ†ç±»æ ‘é‡‡ç”¨åŸºå°¼æŒ‡æ•°é€‰æ‹©æœ€ä¼˜ç‰¹å¾ï¼ŒCARTåˆ†ç±»æ ‘çš„ç”Ÿæˆç®—æ³•å¦‚ä¸‹ï¼š è¾“å…¥ è®­ç»ƒæ•°æ®é›†\(D\) åœæ­¢è®¡ç®—æ¡ä»¶ è¾“å‡ºï¼šCARTå†³ç­–æ ‘ ç®—æ³•æ­¥éª¤ å¯¹æ¯ä¸ªç‰¹å¾\(A\)ï¼Œä»¥åŠå®ƒå¯èƒ½çš„æ¯ä¸ªå€¼\(a\)ï¼Œè®¡ç®—\(Gini(D,A)\)ã€‚ é€‰å–æœ€ä¼˜ç‰¹å¾å’Œæœ€ä¼˜åˆ‡åˆ†ç‚¹ï¼šåœ¨æ‰€æœ‰ç‰¹å¾\(A\)ä»¥åŠæ‰€æœ‰çš„åˆ‡åˆ†ç‚¹\(a\)ä¸­ï¼ŒåŸºå°¼æŒ‡æ•°æœ€å°çš„\(A\)å’Œ\(a\)å°±æ˜¯æœ€ä¼˜ç‰¹å¾å’Œæœ€ä¼˜åˆ‡åˆ†ç‚¹ã€‚æ ¹æ®æœ€ä¼˜ç‰¹å¾å’Œæœ€ä¼˜åˆ‡åˆ†ç‚¹å°†è®­ç»ƒé›†\(D\)åˆ‡åˆ†æˆä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚ å¯¹ä¸¤ä¸ªå­èŠ‚ç‚¹é€’å½’è°ƒç”¨ä¸Šé¢ä¸¤æ­¥ï¼Œç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶ä¸ºæ­¢ã€‚ æœ€ç»ˆç”ŸæˆCARTå†³ç­–æ ‘ã€‚ é€šå¸¸çš„åœæ­¢æ¡ä»¶ä¸ºä¸‹åˆ—æ¡ä»¶ä¹‹ä¸€ï¼š èŠ‚ç‚¹ä¸­æ ·æœ¬ä¸ªæ•°å°äºŽé¢„å®šå€¼ æ ·æœ¬é›†çš„åŸºå°¼æŒ‡æ•°å°äºŽé¢„å®šå€¼ æ²¡æœ‰æ›´å¤šçš„ç‰¹å¾ CARTå‰ªæž CARTå‰ªæžæ˜¯ä»Žç”Ÿæˆæ ‘å¼€å§‹å‰ªæŽ‰ä¸€äº›å­æ ‘ï¼Œä½¿å¾—å†³ç­–æ ‘å˜å°ã€‚å‰ªæžè¿‡ç¨‹ç”±ä¸¤æ­¥ç»„æˆï¼ˆå‡è®¾åˆå§‹çš„ç”Ÿæˆæ ‘ä¸º\(T_0\)ï¼‰ï¼š ä»Ž\(T_0\)å¼€å§‹ä¸æ–­å‰ªæžï¼ŒçŸ¥é“å‰ªæˆä¸€æ£µå•èŠ‚ç‚¹çš„æ ‘ã€‚è¿™äº›å‰ªæžæ ‘å½¢æˆä¸€ä¸ªå‰ªæžæ ‘åºåˆ—\(\{T_0,T_1,â€¦,T_n\}\)ã€‚ ä»Žè¿™ä¸ªå‰ªæžæ ‘åºåˆ—ä¸­æŒ‘é€‰å‡ºæœ€ä¼˜å‰ªæžæ ‘ã€‚æ–¹æ³•ï¼šé€šè¿‡äº¤å‰éªŒè¯æ³•ä½¿ç”¨éªŒè¯æ•°æ®é›†å¯¹å‰ªæžæ ‘åºåˆ—è¿›è¡Œæµ‹è¯•ã€‚ ç»™å‡ºå†³ç­–æ ‘çš„æŸå¤±å‡½æ•°ä¸ºï¼š\({C_{\alpha }(T)=C(T)+\alpha |T|}\)ã€‚å…¶ä¸­\({C(T)}\)ä¸ºå†³ç­–æ ‘å¯¹è®­ç»ƒæ•°æ®çš„é¢„æµ‹è¯¯å·®ï¼›\({|T|}\)ä¸ºå†³ç­–æ ‘çš„å¶èŠ‚ç‚¹ä¸ªæ•°ã€‚ å¯¹å›ºå®šçš„\(\alpha\)ï¼Œå­˜åœ¨ä½¿\(C_{\alpha }(T)\)æœ€å°çš„æ ‘ã€‚ä»¤å…¶ä¸º\(T_{\alpha}\)ï¼Œå¯ä»¥è¯æ˜Ž\(T_{\alpha}\)æ˜¯å”¯ä¸€çš„ã€‚ å½“\(\alpha\)å¤§æ—¶ï¼Œ\(C_{\alpha }(T)\)åå°ï¼ˆå³å†³ç­–æ ‘æ¯”è¾ƒç®€å•ï¼‰ã€‚ å½“\(\alpha\)å°æ—¶ï¼Œ\(C_{\alpha }(T)\)åå¤§ï¼ˆå³å†³ç­–æ ‘æ¯”è¾ƒå¤æ‚ï¼‰ã€‚ å½“\(\alpha =0\)æ—¶ï¼Œç”Ÿæˆæ ‘å°±æ˜¯æœ€ä¼˜çš„ã€‚ å½“\(\alpha = âˆž\)æ—¶ï¼Œæ ¹ç»„æˆçš„ä¸€ä¸ªå•èŠ‚ç‚¹æ ‘å°±æ˜¯æœ€ä¼˜çš„ã€‚ è€ƒè™‘ç”Ÿæˆæ ‘\(T_0\)ã€‚å¯¹\(T_0\)å†…ä»»æ„èŠ‚ç‚¹\(t\)ï¼Œä»¥\(t\)ä¸ºå•èŠ‚ç‚¹æ ‘(è®°ä½œ\(\tilde{t}\))çš„æŸå¤±å‡½æ•°ä¸ºï¼š\(C_{\alpha}(\tilde{t})=C(\tilde{t})+\alpha\)ï¼Œä»¥\(t\)ä¸ºæ ¹çš„å­æ ‘\(T_t\)çš„æŸå¤±å‡½æ•°ä¸ºï¼š\(C_{\alpha }(T_t)=C(T_t)+\alpha |T_t|\)ã€‚å¯ä»¥è¯æ˜Žï¼š å½“\(\alpha =0\)åŠå……åˆ†å°æ—¶ï¼Œæœ‰\(C_{\alpha }(T_t)&lt;C_{\alpha}(\tilde{t})\) å½“\(\alpha\)å¢žå¤§åˆ°æŸä¸ªå€¼æ—¶ï¼Œæœ‰\(C_{\alpha }(T_t)=C_{\alpha}(\tilde{t})\) å½“\(\alpha\)å†å¢žå¤§æ—¶ï¼Œæœ‰\(C_{\alpha }(T_t)&gt;C_{\alpha}(\tilde{t})\) å› æ­¤ä»¤\(\alpha =\frac{C(\tilde{t})-C(T_t)}{|T_t|-1}\)ï¼Œæ­¤æ—¶\(T_t\)ä¸Ž\(\tilde{t}\)æœ‰ç›¸åŒçš„æŸå¤±å‡½æ•°å€¼ï¼Œä½†æ˜¯\(\tilde{t}\)çš„å¶èŠ‚ç‚¹æ›´å°‘ã€‚äºŽæ˜¯å¯¹\(T_t\)è¿›è¡Œå‰ªæžæˆä¸€æ£µå•èŠ‚ç‚¹æ ‘\(\tilde{t}\)äº†ã€‚ å¯¹\(T_0\)å†…éƒ¨å¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹\(t\)ï¼Œå®šä¹‰\(g(t)=\frac{C(t)-C(T_t)}{|T_t|-1}\)ã€‚è®¾\(T_0\)å†…\(g(t)\)æœ€å°çš„å­æ ‘ä¸º\(T_t^*\)ï¼Œä»¤è¯¥æœ€å°å€¼çš„\(g(t)\)ä¸º\(\tilde{\alpha}_1\)ã€‚ä»Ž\(T_0\)å‰ªåŽ»\(T_t^*\)ï¼Œå³å¾—åˆ°å‰ªæžæ ‘\(T_1\)ã€‚é‡å¤è¿™ç§è¿‡ç¨‹ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹å³å®Œæˆå‰ªæžè¿‡ç¨‹ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ä¸æ–­å¢žåŠ \(\tilde{\alpha}_i\)çš„å€¼ï¼Œä»Žè€Œç”Ÿæˆå‰ªæžæ ‘åºåˆ—ã€‚ CARTå‰ªæžäº¤å‰éªŒè¯è¿‡ç¨‹æ˜¯é€šè¿‡éªŒè¯æ•°æ®é›†æ¥æµ‹è¯•å‰ªæžæ ‘åºåˆ—\(\{T_0,T_1,â€¦,T_n\}\)ä¸­å„å‰ªæžæ ‘çš„ã€‚å¯¹äºŽCARTå›žå½’æ ‘ï¼Œæ˜¯è€ƒå¯Ÿå‰ªæžæ ‘çš„å¹³æ–¹è¯¯å·®ï¼Œå¹³æ–¹è¯¯å·®æœ€å°çš„å†³ç­–æ ‘è¢«è®¤ä¸ºæ˜¯æœ€ä¼˜å†³ç­–æ ‘ã€‚å¯¹åº”CARTåˆ†ç±»æ ‘ï¼Œæ˜¯è€ƒå¯Ÿå‰ªæžæ ‘çš„åŸºå°¼æŒ‡æ•°ï¼ŒåŸºå°¼æŒ‡æ•°æœ€å°çš„å†³ç­–æ ‘è¢«è®¤ä¸ºæ˜¯æœ€ä¼˜å†³ç­–æ ‘ã€‚ CARTå‰ªæžç®—æ³•çš„æè¿°å¦‚ä¸‹ï¼š è¾“å…¥ï¼šCARTç”Ÿæˆæ ‘\(T_0\) è¾“å‡ºï¼šCARTå‰ªæžæ ‘\(T_{\alpha}\) ç®—æ³•æ­¥éª¤ ä»¤\(k=0,T=T_0,\alpha =âˆž\) è‡ªä¸‹è€Œä¸Šåœ°å¯¹æ ‘\(T\)å„å†…éƒ¨èŠ‚ç‚¹\(t\)è®¡ç®—\(g(t)=\frac{C(t)-C(T_t)}{|T_t|-1}\) å¯¹æ‰€æœ‰çš„å†…éƒ¨èŠ‚ç‚¹ï¼Œ\(\tilde{\alpha}_{k+1}=\min_t(g(t))\)ï¼Œä»¤\(t^*=\arg \min_t(g(t))\)ã€‚å¯¹å†…éƒ¨èŠ‚ç‚¹\(t^*\)è¿›è¡Œå‰ªæžå¾—åˆ°æ ‘\(T_{k+1}\) ä»¤\(T=T_{k+1},k=k+1\) è‹¥\(T\)ä¸æ˜¯ç”±æ ¹èŠ‚ç‚¹å•ç‹¬æž„æˆçš„æ ‘ï¼Œåˆ™ç»§ç»­å‰é¢çš„æ­¥éª¤ é‡‡ç”¨äº¤å‰éªŒè¯æ³•åœ¨å‰ªæžæ ‘åºåˆ—\(T_0,T_1,â€¦,T_n\)ä¸­é€‰å–æœ€ä¼˜å‰ªæžæ ‘\(T_{\alpha}\) è¿žç»­å€¼å’Œç¼ºå¤±å€¼çš„å¤„ç† è¿žç»­å€¼ å­¦ä¹ ä»»åŠ¡ä¸­å¸¸å¸¸ä¼šé‡åˆ°è¿žç»­ç‰¹å¾ï¼Œå¦‚ä¸ªäººèº«é«˜ã€ä½“é‡ç­‰ç‰¹å¾å–å€¼å°±æ˜¯è¿žç»­å€¼ã€‚å¯ä»¥é€šè¿‡äºŒåˆ†æ³•(bi-partition)å¯¹è¿žç»­ç‰¹å¾è¿›è¡Œç¦»æ•£åŒ–å¤„ç†ã€‚ ç»™å®šæ ·æœ¬é›†\(D\)å’Œè¿žç»­ç‰¹å¾\(A\)ï¼Œå‡è®¾è¯¥ç‰¹å¾åœ¨\(D\)ä¸Šå¯¹å–å€¼ä»Žå°åˆ°å¤§è¿›è¡ŒæŽ’åˆ—ä¸º\(a_1,a_2,â€¦,a_M\)ã€‚å¯ä»¥é€‰å–\(M-1\)ä¸ªåˆ’åˆ†ç‚¹ï¼Œä¾æ¬¡ä¸ºï¼š\(\frac{a_1+a_2}{2},\frac{a_2+a_3}{2},â€¦,\frac{a_{M-1}+a_M}{2}\)ã€‚ç„¶åŽå°±å¯ä»¥åƒç¦»æ•£ç‰¹å¾ä¸€æ ·æ¥è€ƒå¯Ÿè¿™äº›åˆ’åˆ†ç‚¹ï¼Œé€‰å–æœ€ä¼˜çš„åˆ’åˆ†ç‚¹è¿›è¡Œæ ·æœ¬é›†åˆçš„åˆ’åˆ†ã€‚è¿™ä¹Ÿæ˜¯C4.5ç®—æ³•é‡‡å–çš„æ–¹æ¡ˆã€‚ ç¼ºå¤±å€¼ å­¦ä¹ ä»»åŠ¡ä¸­é‡åˆ°ä¸å®Œæ•´æ ·æœ¬ï¼Œå³æŸäº›æ ·æœ¬çš„æŸäº›ç‰¹å¾çš„å–å€¼ç¼ºå¤±ã€‚å¦‚æžœç®€å•åœ°ä¸¢æŽ‰è¿™äº›ä¸å®Œæ•´çš„æ ·æœ¬å¯èƒ½ä¼šæµªè´¹å¤§é‡æœ‰æ•ˆçš„ä¿¡æ¯ã€‚ ç»™å®šè®­ç»ƒé›†\(D\)å’Œç‰¹å¾\(A\)ï¼Œä»¤\(\tilde{D}\)è¡¨ç¤º\(D\)ä¸­åœ¨ç‰¹å¾\(A\)ä¸Šæ²¡æœ‰ç¼ºå¤±çš„æ ·æœ¬å­é›†ã€‚å‡å®šç‰¹å¾\(A\)æœ‰\(M\)ä¸ªå¯å–å€¼\(a_1,a_2,â€¦,a_M\)ï¼Œä»¤\(\tilde{D}^i\)è¡¨ç¤º\(\tilde{D}\)ä¸­æœ€ç‰¹å¾\(A\)ä¸Šå–å€¼ä¸º\(a_i\)çš„æ ·æœ¬çš„å­é›†ï¼Œ\(\tilde{D}_k\)è¡¨ç¤º\(\tilde{D}\)ä¸­å±žäºŽç¬¬\(k\)ç±»çš„æ ·æœ¬å­é›†ï¼ˆä¸€å…±æœ‰\(K\)ä¸ªåˆ†ç±»ï¼‰ï¼Œåˆ™æœ‰ï¼š \[\tilde{D}=\bigcup_{k=1}^K\tilde{D}_k=\bigcup_{i=1}^M\tilde{D}^i\] å‡å®šä¸ºæ¯ä¸ªæ ·æœ¬\(\vec{x}\)èµ‹äºˆä¸€ä¸ªæƒé‡\(w_{\vec{x}}\)ï¼Œå®šä¹‰ï¼š \[\rho =\frac{\sum_{\vec{x}\in \hat{D}}w_{\vec{x}}}{\sum_{\vec{x}\in D}w_{\vec{x}}} \\ \tilde{p}_k=\frac{\sum_{\vec{x}\in \tilde{D}_k}w_{\vec{x}}}{\sum_{\vec{x}\in \tilde{D}}w_{\vec{x}}},k=1,2,â€¦,K \\ \tilde{r}_i=\frac{\sum_{\vec{x}\in \tilde{D}^i}w_{\vec{x}}}{\sum_{\vec{x}\in \tilde{D}}w_{\vec{x}}},i=1,2,â€¦,M\] å…¶ç‰©ç†æ„ä¹‰å¦‚ä¸‹ï¼š \(\rho\)ï¼šè¡¨ç¤ºæ— ç¼ºå¤±å€¼æ ·æœ¬å æ€»ä½“æ ·æœ¬çš„æ¯”ä¾‹ \(\tilde{p}_k\)ï¼šè¡¨ç¤ºæ— ç¼ºå¤±å€¼æ ·æœ¬ä¸­ï¼Œç¬¬\(k\)ç±»æ‰€å çš„æ¯”ä¾‹ \(\tilde{r}_i\)ï¼šè¡¨ç¤ºæ— ç¼ºå¤±å€¼æ ·æœ¬ä¸­ï¼Œåœ¨ç‰¹å¾\(A\)ä¸Šå–å€¼ä¸º\(a_i\)çš„æ ·æœ¬æ‰€å çš„æ¯”ä¾‹ äºŽæ˜¯å¯ä»¥å°†ä¿¡æ¯å¢žç›Šçš„è®¡ç®—å…¬å¼ä¿®æ­£ä¸ºï¼š \[g(D,A)=\rho \times g(\tilde{D},A)=\rho \times \lgroup H(\tilde{D})-\sum_{i=1}^M\tilde{r}_iH(\tilde{D}^i)\rgroup\] å…¶ä¸­ï¼Œ\(H(\tilde{D})=-\sum_{k=1}^K\tilde{p}_k\log \tilde{p}_k\)ã€‚ åœ¨é€šè¿‡ç‰¹å¾\(A\)åˆ’åˆ†æ ·æœ¬\(\vec{x}\)æ—¶ï¼Œè®©å®ƒä»¥ä¸åŒçš„æ¦‚çŽ‡åˆ†æ•£åˆ°ä¸åŒçš„å­èŠ‚ç‚¹ä¸­åŽ»ï¼š å¦‚æžœæ ·æœ¬åœ¨åˆ’åˆ†ç‰¹å¾ä¸Šçš„å–å€¼å·²çŸ¥ï¼Œåˆ™å°†å®ƒåˆ’å…¥ä¸Žå…¶å¯¹åº”çš„å­èŠ‚ç‚¹ï¼Œä¸”æƒå€¼åœ¨å­èŠ‚ç‚¹ä¸­ä¿æŒä¸º\(w_{\vec{x}}\) å¦‚æžœæ ·æœ¬åœ¨åˆ’åˆ†ç‰¹å¾ä¸Šçš„å–å€¼ç¼ºå¤±ï¼Œåˆ™å°†å®ƒåŒæ—¶åˆ’å…¥æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼Œä¸”åœ¨å­èŠ‚ç‚¹ä¸­è¯¥æ ·æœ¬çš„æƒå€¼è¿›è¡Œè°ƒæ•´ï¼šåœ¨ç‰¹å¾å–å€¼ä¸º\(a_i\)å¯¹åº”çš„å­èŠ‚ç‚¹ä¸­ï¼Œè¯¥æ ·æœ¬çš„æƒå€¼è°ƒæ•´ä¸º\(\tilde{r}_i \times w_{\vec{x}}\) Pythonå®žæˆ˜ scikit-learnä¸­æœ‰ä¸¤ç±»å†³ç­–æ ‘ï¼Œå‡é‡‡ç”¨ä¼˜åŒ–çš„CARTå†³ç­–æ ‘ç®—æ³•ã€‚ å›žå½’å†³ç­–æ ‘(DecisionTreeRegressor) DecisionTreeRegressorå®žçŽ°äº†å›žå½’å†³ç­–æ ‘ï¼Œç”¨äºŽå›žå½’é—®é¢˜ï¼š 123456789101112class.sklearn.tree.DecisionTreeRegressor(criterion=&quot;mse&quot;, splitter=&quot;best&quot;, max_depth=None, min_samples_split=2, min_samples_leaf=1, min_weight_fraction_leaf=0., max_features=None, random_state=None, max_leaf_nodes=None, min_impurity_decrease=0., min_impurity_split=None, presort=False) å‚æ•° criterionï¼šå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šåˆ‡åˆ†è´¨é‡çš„è¯„ä»·å‡†åˆ™ã€‚é»˜è®¤ä¸º'mse'ï¼Œä¸”åªæ”¯æŒè¯¥å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå‡æ–¹è¯¯å·®ã€‚ splitterï¼šå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šåˆ‡åˆ†åŽŸåˆ™ 'best'ï¼šé€‰æ‹©æœ€ä¼˜çš„åˆ‡åˆ† 'random'ï¼šéšæœºåˆ‡åˆ† max_depthï¼šæŒ‡å®šæ ‘çš„æœ€å¤§æ·±åº¦ Noneï¼šè¡¨ç¤ºæ ‘çš„æ·±åº¦ä¸é™ï¼Œç›´åˆ°æ¯ä¸ªå¶å­éƒ½æ˜¯çº¯çš„ï¼Œå³å¶èŠ‚ç‚¹ä¸­æ‰€æœ‰æ ·æœ¬ç‚¹éƒ½å±žäºŽä¸€ä¸ªç±»ï¼Œæˆ–è€…å¶å­ä¸­åŒ…å«å°äºŽmin_samples_splitä¸ªæ ·æœ¬ç‚¹ min_samples_splitï¼šæ•´æ•°ï¼ŒæŒ‡å®šæ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹ï¼ˆéžå¶èŠ‚ç‚¹ï¼‰åŒ…å«çš„æœ€å°‘çš„æ ·æœ¬æ•° min_samples_leafï¼šæ•´æ•°ï¼ŒæŒ‡å®šæ¯ä¸ªå¶èŠ‚ç‚¹åŒ…å«çš„æœ€å°‘æ ·æœ¬æ•° min_weight_fraction_leafï¼šæµ®ç‚¹æ•°ï¼Œå¶èŠ‚ç‚¹ä¸­æ ·æœ¬çš„æœ€å°æƒé‡ç³»æ•° max_featuresï¼šæŒ‡å®šå¯»æ‰¾best splitæ—¶è€ƒè™‘çš„ç‰¹å¾æ•°é‡ã€‚å¦‚æžœå·²ç»è€ƒè™‘äº†max_featuresä¸ªç‰¹å¾ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„åˆ‡åˆ†ï¼Œé‚£ä¹ˆè¿˜ä¼šç»§ç»­å¯»æ‰¾ä¸‹ä¸€ç‰¹å¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„åˆ‡åˆ†ä¸ºæ­¢ã€‚ æ•´æ•°ï¼šæ¯æ¬¡åˆ‡åˆ†åªè€ƒè™‘max_featuresä¸ªç‰¹å¾ æµ®ç‚¹æ•°ï¼šæ¯æ¬¡åˆ‡åˆ†åªè€ƒè™‘max_features * n_featuresä¸ªç‰¹å¾ï¼ˆmax_featuresæŒ‡å®šäº†ç™¾åˆ†æ¯”ï¼‰ 'auto' æˆ–è€… 'sqrt'ï¼šmax_features = n_features 'log2'ï¼šmax_features = log2(n_features) Noneï¼šmax_features = n_features random_state: ä¸€ä¸ªæ•´æ•°æˆ–è€…ä¸€ä¸ªRandomStateå®žä¾‹ï¼Œæˆ–è€…None å¦‚æžœä¸ºæ•´æ•°ï¼Œåˆ™å®ƒæŒ‡å®šäº†éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ å¦‚æžœä¸ºRandomStateå®žä¾‹ï¼Œåˆ™æŒ‡å®šä¾‹éšæœºæ•°ç”Ÿæˆå™¨ å¦‚æžœä¸ºNoneï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„éšæœºæ•°ç”Ÿæˆå™¨ max_leaf_nodesï¼šæŒ‡å®šå¶èŠ‚ç‚¹çš„æœ€å¤§æ•°é‡ Noneï¼šæ­¤æ—¶å¶èŠ‚ç‚¹æ•°é‡ä¸é™ æ•´æ•°ï¼šåˆ™max_depthè¢«å¿½ç•¥ presortï¼šbooleanï¼ŒæŒ‡å®šæ˜¯å¦è¦æå‰æŽ’åºæ•°æ®ä»Žè€ŒåŠ é€Ÿå¯»æ‰¾æœ€ä¼˜åˆ‡åˆ†çš„è¿‡ç¨‹ã€‚è®¾ç½®ä¸ºTrueæ—¶ï¼Œå¯¹äºŽå¤§æ•°æ®é›†ä¼šå‡æ…¢æ€»ä½“çš„è®­ç»ƒè¿‡ç¨‹ï¼Œä½†æ˜¯å¯¹äºŽä¸€ä¸ªå°æ•°æ®é›†æˆ–è€…è®¾å®šäº†æœ€å¤§æ·±åº¦çš„æƒ…å†µä¸‹ï¼Œåˆ™ä¼šåŠ é€Ÿè®­ç»ƒè¿‡ç¨‹ class_weightï¼šä¸€ä¸ªå­—å…¸ã€å­—å…¸çš„åˆ—è¡¨ã€'balance'æˆ–è€…Noneï¼ŒæŒ‡å®šäº†åˆ†ç±»çš„æƒé‡ã€‚å½¢å¼ï¼š{class_label: weight}ã€‚å¦‚æžœæä¾›äº†sample_weightå‚æ•°ï¼ˆfitæ–¹æ³•æä¾›ï¼‰ï¼Œåˆ™è¿™äº›æƒé‡éƒ½ä¼šä¹˜ä»¥sample_weightã€‚ Noneï¼šæ¯ä¸ªåˆ†ç±»æƒé‡éƒ½ä¸º1 'balance'ï¼šåˆ†ç±»çš„æƒé‡æ˜¯æ ·æœ¬ä¸­å„åˆ†ç±»å‡ºçŽ°çš„é¢‘çŽ‡çš„åæ¯” å±žæ€§ feature_importances_ï¼šç»™å‡ºç‰¹å¾çš„é‡è¦ç¨‹åº¦ã€‚è¯¥å€¼è¶Šé«˜ï¼Œåˆ™è¯¥ç‰¹å¾è¶Šé‡è¦ã€‚ï¼ˆGini importanceï¼‰ max_features_ï¼šmax_featuresçš„æŽ¨æ–­å€¼ n_features_ï¼šå½“æ‰§è¡Œfitä¹‹åŽï¼Œç‰¹å¾çš„æ•°é‡ n_outputs_ï¼šå½“æ‰§è¡Œfitä¹‹åŽï¼Œè¾“å‡ºçš„æ•°é‡ tree_ï¼šä¸€ä¸ªTreeå¯¹è±¡ï¼Œå³åº•å±‚çš„å†³ç­–æ ‘ æ–¹æ³• fit(X, y[, sample_weight, check_input, â€¦]): è®­ç»ƒæ¨¡åž‹ predict(X[, check_input]): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ score(X, y[, sample_weight]): è¿”å›žé¢„æµ‹æ€§èƒ½å¾—åˆ† è®¾é¢„æµ‹é›†ä¸º\(T_{test}\)ï¼ŒçœŸå®žå€¼ä¸º\(y_i\)ï¼ŒçœŸå®žå€¼çš„å‡å€¼ä¸º\(\overline{y}\)ï¼Œé¢„æµ‹å€¼ä¸º\(\hat{y}_i\)ï¼Œåˆ™ï¼š\[score=1-\frac{\sum_{T_{test}}(y_i-\hat{y}_i)^2}{(y_i-\overline{y})^2}\] scoreä¸è¶…è¿‡1ï¼Œä½†æ˜¯å¯èƒ½ä¸ºè´Ÿå€¼ï¼ˆé¢„æµ‹æ•ˆæžœå¤ªå·®ï¼‰ã€‚ scoreè¶Šå¤§ï¼Œé¢„æµ‹æ€§èƒ½è¶Šå¥½ã€‚ é¦–å…ˆå¯¼å…¥åŒ… 1234import matplotlib.pyplot as pltimport numpy as npfrom sklearn.tree import DecisionTreeRegressorfrom sklearn import model_selection ç»™å‡ºä¸€ä¸ªéšæœºäº§ç”Ÿçš„æ•°æ®é›† 123456789101112def create_data(n): &quot;&quot;&quot; éšæœºäº§ç”Ÿæ•°æ®é›† :param n: æ•°æ®é›†å®¹é‡ :return: ä¸€ä¸ªå…ƒç»„ï¼šè®­ç»ƒæ ·æœ¬é›†ã€æµ‹è¯•æ ·æœ¬é›†ã€è®­ç»ƒæ ·æœ¬é›†å¯¹åº”çš„å€¼ã€æµ‹è¯•æ ·æœ¬é›†å¯¹åº”çš„å€¼ &quot;&quot;&quot; np.random.seed(0) X = 5 * np.random.rand(n, 1) y = np.sin(X).ravel() noise_num = int(n / 5) y[::5] += 3 * (0.5 - np.random.rand(noise_num)) return model_selection.train_test_split(X, y, test_size=0.25, random_state=1) create_dataå‡½æ•°äº§ç”Ÿçš„æ•°æ®é›†æ˜¯åœ¨sin(x)å‡½æ•°åŸºç¡€ä¸Šæ·»åŠ äº†è‹¥å¹²ä¸ªéšæœºå™ªå£°äº§ç”Ÿçš„ã€‚xæ˜¯éšæœºåœ¨0ï½ž1ä¹‹é—´äº§ç”Ÿçš„ï¼Œyæ˜¯sin(x)ï¼Œå…¶ä¸­yæ¯éš”5ä¸ªç‚¹æ·»åŠ ä¸€ä¸ªéšæœºå™ªå£°ã€‚ç„¶åŽå°†æ•°æ®é›†éšæœºåˆ‡åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚æŒ‡å®šæµ‹è¯•é›†æ ·æœ¬å¤§å°ä¸ºåŽŸæ ·æœ¬ç‚¹0.25å€ã€‚ ç„¶åŽç»™å‡ºæµ‹è¯•å‡½æ•° 12345678910111213141516171819def demo_DecisionTreeRegressor(*data): X_train, X_test, y_train, y_test = data regr = DecisionTreeRegressor() regr.fit(X_train, y_train) print(&quot;Training score: %f&quot; % regr.score(X_train, y_train)) print(&quot;Testing score: %f&quot; % regr.score(X_test, y_test)) # ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) X = np.arange(0.0, 5.0, 0.01)[:, np.newaxis] Y = regr.predict(X) ax.scatter(X_train, y_train, label=&quot;train sample&quot;, c=&apos;g&apos;) ax.scatter(X_test, y_test, label=&quot;test sample&quot;, c=&apos;r&apos;) ax.plot(X, Y, label=&quot;predict_value&quot;, linewidth=2, alpha=0.5) ax.set_xlabel(&quot;data&quot;) ax.set_ylabel(&quot;target&quot;) ax.set_title(&quot;Decision Tree Regression&quot;) ax.legend(framealpha=0.5) plt.show() åœ¨demo_DecisionTreeRegressorä¸­ï¼Œç»™å‡ºäº†å¯¹xä¸Šæ¯ä¸ªç‚¹çš„é¢„æµ‹å€¼ï¼ˆè€ƒè™‘åˆ°è¿žç»­å€¼æœ‰æ— ç©·å¤šï¼Œé‡‡å–çš„æ–¹å¼æ˜¯[0, 5]ä¹‹é—´ï¼Œæ­¥é•¿ä¸º0.01ï¼‰ã€‚è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = create_data(100)demo_DecisionTreeRegressor(X_train, X_test, y_train, y_test) è¾“å‡ºå¦‚ä¸‹ï¼š 12Training score: 1.000000Testing score: 0.789107 å¯ä»¥çœ‹åˆ°å¯¹äºŽè®­ç»ƒæ ·æœ¬çš„æ‹Ÿåˆç›¸å½“å¥½ï¼Œä½†æ˜¯å¯¹äºŽæµ‹è¯•æ ·æœ¬çš„æ‹Ÿåˆå°±å·®å¼ºäººæ„ã€‚ æŽ¥ä¸‹æ¥ï¼Œæ£€éªŒéšæœºåˆ’åˆ†ä¸Žæœ€ä¼˜åˆ’åˆ†çš„å½±å“ï¼š 123456789def demo_DecisionTreeRegressor_splitter(*data): X_train, X_test, y_train, y_test = data splitters = [&apos;best&apos;, &apos;random&apos;] for splitter in splitters: regr = DecisionTreeRegressor(splitter=splitter) regr.fit(X_train, y_train) print(&quot;Splitter %s&quot; % splitter) print(&quot;Training score: %f&quot; % regr.score(X_train, y_train)) print(&quot;Testing score: %f&quot; % regr.score(X_test, y_test)) è¿è¡Œç»“æžœå¦‚ä¸‹ï¼š 123456Splitter bestTraining score: 1.000000Testing score: 0.789107Splitter randomTraining score: 1.000000Testing score: 0.778989 å¯ä»¥çœ‹åˆ°å¯¹äºŽæœ¬é—®é¢˜ï¼Œæœ€ä¼˜åˆ’åˆ†é¢„æµ‹æ€§èƒ½è¾ƒå¼ºï¼Œä½†æ˜¯ç›¸å·®ä¸å¤§ã€‚è€Œå¯¹äºŽè®­ç»ƒé›†çš„æ‹Ÿåˆï¼ŒäºŒè€…éƒ½æ‹Ÿåˆå¾—ç›¸å½“å¥½ã€‚ æœ€åŽè€ƒå¯Ÿå†³ç­–æ ‘æ·±åº¦çš„å½±å“ã€‚å†³ç­–æ ‘çš„æ·±åº¦å¯¹åº”ç€æ ‘çš„å¤æ‚åº¦ã€‚å†³ç­–æ ‘è¶Šæ·±ï¼Œåˆ™æ¨¡åž‹è¶Šå¤æ‚ã€‚ 1234567891011121314151617181920def demo_DecisionTreeRegressor_depth(*data, maxdepth): X_train, X_test, y_train, y_test = data depths = np.arange(1, maxdepth) training_scores = [] testing_scores = [] for depth in depths: regr = DecisionTreeRegressor(max_depth=depth) regr.fit(X_train, y_train) training_scores.append(regr.score(X_train, y_train)) testing_scores.append(regr.score(X_test, y_test)) # ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) ax.plot(depths, training_scores, label=&quot;training score&quot;) ax.plot(depths, testing_scores, label=&quot;testing score&quot;) ax.set_xlabel(&quot;maxdepth&quot;) ax.set_ylabel(&quot;score&quot;) ax.set_title(&quot;Decision Tree Regression&quot;) ax.legend(framealpha=0.5) plt.show() è°ƒç”¨è¯¥å‡½æ•° 12X_train, X_test, y_train, y_test = create_data(100)demo_DecisionTreeRegressor_depth(X_train, X_test, y_train, y_test, maxdepth=20) è¿è¡Œç»“æžœï¼š å¯ä»¥çœ‹åˆ°éšç€æ ‘æ·±åº¦çš„åŠ æ·±ï¼Œæ¨¡åž‹å¯¹è®­ç»ƒé›†å’Œé¢„æµ‹é›†çš„æ‹Ÿåˆéƒ½åœ¨æé«˜ã€‚ç”±äºŽæ ·æœ¬åªæœ‰100ä¸ªï¼Œå› æ­¤ç†è®ºä¸ŠäºŒå‰æ ‘æœ€æ·±ä¸º\(\log_2(100)=6.65\)ã€‚å³æ ‘æ·±åº¦ä¸º7ä¹‹åŽï¼Œå†ä¹Ÿæ— æ³•åˆ’åˆ†äº†ï¼ˆæ¯ä¸ªå­èŠ‚ç‚¹éƒ½åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ã€‚ ç»˜åˆ¶ä¸åŒæ·±åº¦çš„å†³ç­–æ ‘ï¼š 1234567891011121314151617181920def demo_DecisionTreeRegressor_depth_plot(*data): X_train, X_test, y_train, y_test = data depths = [1, 3, 7] fig = plt.figure() ax = fig.add_subplot(1, 1, 1) for depth in depths: regr = DecisionTreeRegressor(max_depth=depth) regr.fit(X_train, y_train) print(&quot;Training score: %f&quot; % regr.score(X_train, y_train)) print(&quot;Testing score: %f&quot; % regr.score(X_test, y_test)) X = np.arange(0.0, 5.0, 0.01)[:, np.newaxis] Y = regr.predict(X) ax.plot(X, Y, label=&quot;predict_value_max_depth=%d&quot; % depth, linewidth=2, alpha=0.5) ax.scatter(X_train, y_train, label=&quot;train sample&quot;, c=&apos;g&apos;) ax.scatter(X_test, y_test, label=&quot;test sample&quot;, c=&apos;r&apos;) ax.set_xlabel(&quot;data&quot;) ax.set_ylabel(&quot;target&quot;) ax.set_title(&quot;Decision Tree Regression&quot;) ax.legend(framealpha=0.5) plt.show() ç»“æžœï¼š å¯ä»¥çœ‹åˆ°ï¼Œæ·±åº¦è¶Šå°çš„å†³ç­–æ ‘è¶Šç®€å•ï¼Œå®ƒå°†ç‰¹å¾ç©ºé—´åˆ’åˆ†çš„æŠ˜çº¿è¶Šå°‘ã€‚æ·±åº¦è¶Šæ·±çš„å†³ç­–æ ‘è¶Šå¤æ‚ï¼Œå®ƒå°†ç‰¹å¾ç©ºé—´åˆ’åˆ†çš„æŠ˜çº¿è¶Šå¤šï¼ˆè¶Šæ›²æŠ˜ï¼‰ã€‚ åˆ†ç±»å†³ç­–æ ‘(DecisionTreeClassifier) DecisionTreeClassifierå®žçŽ°äº†åˆ†ç±»å†³ç­–æ ‘ï¼Œç”¨äºŽåˆ†ç±»é—®é¢˜ï¼š 12345678910111213class sklearn.tree.DecisionTreeClassifier(criterion=&quot;gini&quot;, splitter=&quot;best&quot;, max_depth=None, min_samples_split=2, min_samples_leaf=1, min_weight_fraction_leaf=0., max_features=None, random_state=None, max_leaf_nodes=None, min_impurity_decrease=0., min_impurity_split=None, class_weight=None, presort=False) å‚æ•° criterionï¼šå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šåˆ‡åˆ†è´¨é‡çš„è¯„ä»·å‡†åˆ™ã€‚ 'gini'ï¼šåˆ‡åˆ†æ—¶è¯„ä»·å‡†åˆ™æ˜¯Giniç³»æ•° 'entropy'ï¼šåˆ‡åˆ†æ—¶è¯„ä»·å‡†åˆ™æ˜¯ç†µ splitterï¼šå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šåˆ‡åˆ†åŽŸåˆ™ 'best'ï¼šé€‰æ‹©æœ€ä¼˜çš„åˆ‡åˆ† 'random'ï¼šéšæœºåˆ‡åˆ† max_depthï¼šæŒ‡å®šæ ‘çš„æœ€å¤§æ·±åº¦ Noneï¼šè¡¨ç¤ºæ ‘çš„æ·±åº¦ä¸é™ï¼Œç›´åˆ°æ¯ä¸ªå¶å­éƒ½æ˜¯çº¯çš„ï¼Œå³å¶èŠ‚ç‚¹ä¸­æ‰€æœ‰æ ·æœ¬ç‚¹éƒ½å±žäºŽä¸€ä¸ªç±»ï¼Œæˆ–è€…å¶å­ä¸­åŒ…å«å°äºŽmin_samples_splitä¸ªæ ·æœ¬ç‚¹ min_samples_splitï¼šæ•´æ•°ï¼ŒæŒ‡å®šæ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹ï¼ˆéžå¶èŠ‚ç‚¹ï¼‰åŒ…å«çš„æœ€å°‘çš„æ ·æœ¬æ•° min_samples_leafï¼šæ•´æ•°ï¼ŒæŒ‡å®šæ¯ä¸ªå¶èŠ‚ç‚¹åŒ…å«çš„æœ€å°‘æ ·æœ¬æ•° min_weight_fraction_leafï¼šæµ®ç‚¹æ•°ï¼Œå¶èŠ‚ç‚¹ä¸­æ ·æœ¬çš„æœ€å°æƒé‡ç³»æ•° max_featuresï¼šæŒ‡å®šå¯»æ‰¾best splitæ—¶è€ƒè™‘çš„ç‰¹å¾æ•°é‡ã€‚å¦‚æžœå·²ç»è€ƒè™‘äº†max_featuresä¸ªç‰¹å¾ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„åˆ‡åˆ†ï¼Œé‚£ä¹ˆè¿˜ä¼šç»§ç»­å¯»æ‰¾ä¸‹ä¸€ç‰¹å¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„åˆ‡åˆ†ä¸ºæ­¢ã€‚ æ•´æ•°ï¼šæ¯æ¬¡åˆ‡åˆ†åªè€ƒè™‘max_featuresä¸ªç‰¹å¾ æµ®ç‚¹æ•°ï¼šæ¯æ¬¡åˆ‡åˆ†åªè€ƒè™‘max_features * n_featuresä¸ªç‰¹å¾ï¼ˆmax_featuresæŒ‡å®šäº†ç™¾åˆ†æ¯”ï¼‰ 'auto' æˆ–è€… 'sqrt'ï¼šmax_features = sqrt(n_features) 'log2'ï¼šmax_features = log2(n_features) Noneï¼šmax_features = n_features random_state: ä¸€ä¸ªæ•´æ•°æˆ–è€…ä¸€ä¸ªRandomStateå®žä¾‹ï¼Œæˆ–è€…None å¦‚æžœä¸ºæ•´æ•°ï¼Œåˆ™å®ƒæŒ‡å®šäº†éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ å¦‚æžœä¸ºRandomStateå®žä¾‹ï¼Œåˆ™æŒ‡å®šä¾‹éšæœºæ•°ç”Ÿæˆå™¨ å¦‚æžœä¸ºNoneï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„éšæœºæ•°ç”Ÿæˆå™¨ max_leaf_nodesï¼šæŒ‡å®šå¶èŠ‚ç‚¹çš„æœ€å¤§æ•°é‡ Noneï¼šæ­¤æ—¶å¶èŠ‚ç‚¹æ•°é‡ä¸é™ æ•´æ•°ï¼šåˆ™max_depthè¢«å¿½ç•¥ presortï¼šbooleanï¼ŒæŒ‡å®šæ˜¯å¦è¦æå‰æŽ’åºæ•°æ®ä»Žè€ŒåŠ é€Ÿå¯»æ‰¾æœ€ä¼˜åˆ‡åˆ†çš„è¿‡ç¨‹ã€‚è®¾ç½®ä¸ºTrueæ—¶ï¼Œå¯¹äºŽå¤§æ•°æ®é›†ä¼šå‡æ…¢æ€»ä½“çš„è®­ç»ƒè¿‡ç¨‹ï¼Œä½†æ˜¯å¯¹äºŽä¸€ä¸ªå°æ•°æ®é›†æˆ–è€…è®¾å®šäº†æœ€å¤§æ·±åº¦çš„æƒ…å†µä¸‹ï¼Œåˆ™ä¼šåŠ é€Ÿè®­ç»ƒè¿‡ç¨‹ class_weightï¼šä¸€ä¸ªå­—å…¸ã€å­—å…¸çš„åˆ—è¡¨ã€'balance'æˆ–è€…Noneï¼ŒæŒ‡å®šäº†åˆ†ç±»çš„æƒé‡ã€‚å½¢å¼ï¼š{class_label: weight}ã€‚å¦‚æžœæä¾›äº†sample_weightå‚æ•°ï¼ˆfitæ–¹æ³•æä¾›ï¼‰ï¼Œåˆ™è¿™äº›æƒé‡éƒ½ä¼šä¹˜ä»¥sample_weightã€‚ Noneï¼šæ¯ä¸ªåˆ†ç±»æƒé‡éƒ½ä¸º1 'balance'ï¼šåˆ†ç±»çš„æƒé‡æ˜¯æ ·æœ¬ä¸­å„åˆ†ç±»å‡ºçŽ°çš„é¢‘çŽ‡çš„åæ¯” å±žæ€§ classes_ï¼šåˆ†ç±»çš„æ ‡ç­¾å€¼ feature_importances_ï¼šç»™å‡ºç‰¹å¾çš„é‡è¦ç¨‹åº¦ã€‚è¯¥å€¼è¶Šé«˜ï¼Œåˆ™è¯¥ç‰¹å¾è¶Šé‡è¦ã€‚ï¼ˆGini importanceï¼‰ max_features_ï¼šmax_featuresçš„æŽ¨æ–­å€¼ n_classes_ï¼šç»™å‡ºåˆ†ç±»çš„æ•°é‡ n_features_ï¼šå½“æ‰§è¡Œfitä¹‹åŽï¼Œç‰¹å¾çš„æ•°é‡ n_outputs_ï¼šå½“æ‰§è¡Œfitä¹‹åŽï¼Œè¾“å‡ºçš„æ•°é‡ tree_ï¼šä¸€ä¸ªTreeå¯¹è±¡ï¼Œå³åº•å±‚çš„å†³ç­–æ ‘ æ–¹æ³• fit(X, y[, sample_weight, check_input, â€¦]): è®­ç»ƒæ¨¡åž‹ predict(X[, check_input]): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ predict_log_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡çš„å¯¹æ•°å€¼ predict_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡å€¼ score(X, y[, sample_weight]): è¿”å›žåœ¨(X, y)ä¸Šé¢„æµ‹çš„å‡†ç¡®çŽ‡ é¦–å…ˆå¯¼å…¥åŒ… 12345import matplotlib.pyplot as pltimport numpy as npfrom sklearn.tree import DecisionTreeClassifierfrom sklearn import model_selectionfrom sklearn import datasets é‡‡ç”¨é¸¢å°¾èŠ±æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†ä¸€å…±æœ‰150ä¸ªæ•°æ®ï¼Œè¿™äº›æ•°æ®åˆ†ä¸º3ç±»(setosa, versicolor, virginica)ï¼Œæ¯ç±»50ä¸ªæ•°æ®ã€‚æ¯ä¸ªæ•°æ®åŒ…å«4ä¸ªå±žæ€§ï¼šsepalé•¿åº¦ã€sepalå®½åº¦ã€petalé•¿åº¦ã€petalå®½åº¦ã€‚ é¦–å…ˆåŠ è½½æ•°æ®ï¼š 123456789def load_data(): &quot;&quot;&quot; é‡‡ç”¨åˆ†å±‚é‡‡æ · :return: &quot;&quot;&quot; iris = datasets.load_iris() X_train = iris.data y_train = iris.target return model_selection.train_test_split(X_train, y_train, test_size=0.25, random_state=0, stratify=y_train) ç„¶åŽï¼Œç»™å‡ºä½¿ç”¨DecisionTreeClassifierè¿›è¡Œåˆ†ç±»çš„å‡½æ•° 123456def demo_DecisionTreeClassifier(*data): X_train, X_test, y_train, y_test = data clf = DecisionTreeClassifier() clf.fit(X_train, y_train) print(&quot;Training score: %f&quot; % clf.score(X_train, y_train)) print(&quot;Testing score: %f&quot; % clf.score(X_test, y_test)) æ‰§è¡Œç»“æžœï¼š 12Training score: 1.000000Testing score: 0.973684 å¯ä»¥çœ‹åˆ°å¯¹è®­ç»ƒæ•°æ®é›†å®Œå…¨æ‹Ÿåˆï¼Œå¯¹æµ‹è¯•æ•°æ®é›†æ‹Ÿåˆç²¾åº¦é«˜è¾¾97.3684%ã€‚ çŽ°åœ¨è€ƒå¯Ÿè¯„ä»·åˆ‡åˆ†è´¨é‡çš„è¯„ä»·å‡†åˆ™criterionå¯¹äºŽåˆ†ç±»æ€§èƒ½çš„å½±å“ï¼š 123456789def demo_DecisionTreeClassifier_criterion(*data): X_train, X_test, y_train, y_test = data criterions = [&apos;gini&apos;, &apos;entropy&apos;] for criterion in criterions: clf = DecisionTreeClassifier(criterion=criterion) clf.fit(X_train, y_train) print(&quot;criterion: %s&quot; % criterion) print(&quot;Training score: %f&quot; % clf.score(X_train, y_train)) print(&quot;Testing score: %f&quot; % clf.score(X_test, y_test)) ç»“æžœï¼š 123456criterion: giniTraining score: 1.000000Testing score: 0.973684criterion: entropyTraining score: 1.000000Testing score: 0.921053 å¯ä»¥çœ‹åˆ°å¯¹äºŽæœ¬é—®é¢˜äºŒè€…å¯¹äºŽè®­ç»ƒé›†çš„æ‹Ÿåˆéƒ½éžå¸¸å®Œç¾Žï¼Œå¯¹åº”æµ‹è¯•é›†çš„é¢„æµ‹éƒ½è¾ƒé«˜ï¼Œä½†æ˜¯ç¨æœ‰ä¸åŒï¼Œä½¿ç”¨Giniç³»æ•°çš„ç­–ç•¥é¢„æµ‹æ€§èƒ½é«˜ã€‚ æŽ¥ä¸‹æ¥ï¼Œæ£€éªŒéšæœºåˆ’åˆ†ä¸Žæœ€ä¼˜åˆ’åˆ†çš„å½±å“ï¼š 123456789def demo_DecisionTreeClassifier_splitter(*data): X_train, X_test, y_train, y_test = data splitters = [&apos;best&apos;, &apos;random&apos;] for splitter in splitters: clf = DecisionTreeClassifier(splitter=splitter) clf.fit(X_train, y_train) print(&quot;splitter: %s&quot; % splitter) print(&quot;Training score: %f&quot; % clf.score(X_train, y_train)) print(&quot;Testing score: %f&quot; % clf.score(X_test, y_test)) è¿è¡Œç»“æžœï¼š 123456splitter: bestTraining score: 1.000000Testing score: 0.947368splitter: randomTraining score: 1.000000Testing score: 0.973684 æœ€åŽè€ƒå¯Ÿå†³ç­–æ ‘æ·±åº¦çš„å½±å“ï¼š 1234567891011121314151617181920def demo_DecisionTreeClassifier_depth(*data, maxdepth): X_train, X_test, y_train, y_test = data depths = np.arange(1, maxdepth) training_scores = [] testing_scores = [] for depth in depths: clf = DecisionTreeClassifier(max_depth=depth) clf.fit(X_train, y_train) training_scores.append(clf.score(X_train, y_train)) testing_scores.append(clf.score(X_test, y_test)) # ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) ax.plot(depths, training_scores, label=&quot;training score&quot;, marker=&apos;o&apos;) ax.plot(depths, testing_scores, label=&quot;testing score&quot;, marker=&apos;*&apos;) ax.set_xlabel(&quot;maxdepth&quot;) ax.set_ylabel(&quot;score&quot;) ax.set_title(&quot;Decision Tree Classification&quot;) ax.legend(framealpha=0.5, loc=&apos;best&apos;) plt.show() è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_DecisionTreeClassifier_depth(X_train, X_test, y_train, y_test, maxdepth=100) è¿è¡Œç»“æžœï¼š å¯ä»¥çœ‹åˆ°éšç€æ ‘æ·±åº¦çš„å¢žåŠ ï¼Œæ¨¡åž‹å¯¹è®­ç»ƒé›†å’Œé¢„æµ‹é›†çš„æ‹Ÿåˆéƒ½åœ¨æé«˜ã€‚è¿™é‡Œè®­ç»ƒæ•°æ®é›†å¤§å°ä»…ä¸º150ï¼Œä¸è€ƒè™‘ä»»åŠ¡æ¡ä»¶ï¼Œåªéœ€è¦ä¸€æ£µæ·±åº¦ä¸º\(\log_2150 â‰¤8\)çš„äºŒå‰æ ‘å°±èƒ½å¤Ÿå®Œå…¨æ‹Ÿåˆæ•°æ®ï¼Œä½¿å¾—æ¯ä¸ªå¶å­ç»“ç‚¹æœ€å¤šåªæœ‰ä¸€ä¸ªæ ·æœ¬ã€‚è€ƒè™‘åˆ°å†³ç­–æ ‘ç®—æ³•ä¸­çš„æå‰ç»ˆæ­¢æ¡ä»¶ï¼Œåˆ™æ ‘çš„æ·±åº¦å°äºŽ8ã€‚ å†³ç­–å›¾ å½“è®­ç»ƒå®Œä¸€æ£µå†³ç­–æ ‘æ—¶ï¼Œå¯ä»¥é€šè¿‡sklearn.tree.export_graphviz(classifier, out_file)æ¥å°†å†³ç­–æ ‘è½¬åŒ–æˆGraphvizæ ¼å¼çš„æ–‡ä»¶ã€‚å¯¹ä¸Šé¢DecisionTreeClassifierä¾‹å­ï¼Œä½¿ç”¨export_graphvizå‡½æ•°å¦‚ä¸‹ï¼š 12345def demo_export_graphviz(*data, filename): X_train, X_test, y_train, y_test = data clf = DecisionTreeClassifier() clf.fit(X_train, y_train) export_graphviz(clf, filename) è°ƒç”¨ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_export_graphviz(X_train, X_test, y_train, y_test, filename=&quot;out_DecisionTreeClassifier&quot;) è¿™é‡Œéœ€è¦å®‰è£…Graphvizç¨‹åºã€‚Graphvizæ˜¯è´å°”å®žéªŒå®¤å¼€å‘çš„ä¸€ä¸ªå¼€æºå·¥å…·åŒ…ï¼Œç”¨äºŽç»˜åˆ¶ç»“æž„åŒ–çš„å›¾å½¢ç½‘ç»œã€‚é€šè¿‡brew install graphvizå®‰è£…ã€‚ ç„¶åŽé€šè¿‡Graphvizçš„dotå·¥å…·ï¼Œåœ¨ç»ˆç«¯ä¸­è¿›å…¥æ–‡ä»¶å­˜æ”¾æ–‡ä»¶å¤¹ï¼Œç„¶åŽè¿è¡Œå‘½ä»¤dot -Tpng out_DecisionTreeClassifier -o out_DecisionTreeClassifier.pngæ¥ç”Ÿæˆpngæ ¼å¼çš„å†³ç­–å›¾ã€‚å…¶ä¸­-TæŒ‡å®šäº†è¾“å‡ºæ–‡ä»¶çš„æ ¼å¼ï¼Œ-oæŒ‡å®šäº†è¾“å‡ºæ–‡ä»¶åã€‚]]></content>
      <categories>
        <category>Machine Learning</category>
      </categories>
      <tags>
        <tag>machine learning</tag>
        <tag>python</tag>
        <tag>sklearn</tag>
        <tag>decision tree</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MachineLearning Chapter-1 Linear Model]]></title>
    <url>%2F2019%2F07%2F24%2FMachineLearning-Chapter-1-Linear-Model%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿° å¯¹äºŽæ ·æœ¬\(\stackrel{\rightarrow}{x}\)ï¼Œç”¨åˆ—å‘é‡è¡¨ç¤ºè¯¥æ ·æœ¬\(\stackrel{\rightarrow}{x}={(x^{(1)},x^{(2)},â€¦,x^{(n)})}^{T}\)ã€‚æ ·æœ¬æœ‰\(n\)ç§ç‰¹å¾ï¼Œç”¨\(x^{(i)}\)æ¥è¡¨ç¤ºæ ·æœ¬çš„ç¬¬\(i\)ä¸ªç‰¹å¾ã€‚ çº¿æ€§æ¨¡åž‹(linear model)çš„å½¢å¼ä¸ºï¼š \[f(\stackrel{\rightarrow}{x})=\stackrel{\rightarrow}{w}Â·\stackrel{\rightarrow}{x}+b\] å…¶ä¸­\(\stackrel{\rightarrow}{w}={(w^{(1)},w^{(2)},â€¦,w^{(n)})}^{T}\)ä¸ºæ¯ä¸ªç‰¹å¾å¯¹åº”çš„æƒé‡ç”Ÿæˆçš„æƒé‡å‘é‡ã€‚æƒé‡å‘é‡ç›´è§‚åœ°è¡¨è¾¾äº†æ¯ä¸ªç‰¹å¾åœ¨é¢„æµ‹ä¸­çš„é‡è¦æ€§ã€‚ çº¿æ€§æ¨¡åž‹å…¶å®žå°±æ˜¯ä¸€ç³»åˆ—ä¸€æ¬¡ç‰¹å¾çš„çº¿æ€§ç»„åˆï¼Œåœ¨äºŒç»´å±‚é¢æ˜¯ä¸€æ¡ç›´çº¿ï¼Œä¸‰ç»´å±‚é¢åˆ™æ˜¯ä¸€ä¸ªå¹³é¢ï¼Œä»¥æ­¤ç±»æŽ¨åˆ°\(n\)ç»´ç©ºé—´ï¼Œè¿™æ ·å¯ä»¥ç†è§£ä¸ºå¹¿ä¹‰çº¿æ€§æ¨¡åž‹ã€‚ å¸¸è§çš„å¹¿ä¹‰çº¿æ€§æ¨¡åž‹åŒ…æ‹¬å²­å›žå½’ã€lassoå›žå½’ã€Elastic Netã€é€»è¾‘å›žå½’ã€çº¿æ€§åˆ¤åˆ«åˆ†æžç­‰ã€‚ ç®—æ³• æ™®é€šçº¿æ€§å›žå½’ çº¿æ€§å›žå½’æ˜¯ä¸€ç§å›žå½’åˆ†æžæŠ€æœ¯ï¼Œå›žå½’åˆ†æžæœ¬è´¨ä¸Šå°±æ˜¯æ‰¾å‡ºå› å˜é‡å’Œè‡ªå˜é‡ä¹‹é—´çš„è”ç³»ã€‚å›žå½’åˆ†æžçš„å› å˜é‡åº”è¯¥æ˜¯è¿žç»­å˜é‡ï¼Œå¦‚æžœå› å˜é‡ä¸ºç¦»æ•£å˜é‡ï¼Œåˆ™é—®é¢˜è½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜ï¼Œå›žå½’åˆ†æžæ˜¯ä¸€ä¸ªç›‘ç£å­¦ä¹ çš„é—®é¢˜ã€‚ ç»™å®šæ•°æ®é›†\(T=\{(\stackrel{\rightarrow}{x}_1,y_1),(\stackrel{\rightarrow}{x}_2,y_2),â€¦,(\stackrel{\rightarrow}{x}_N,y_N)\}\), \(\stackrel{\rightarrow}{x}_i\in X\subseteq R^n\), \(\stackrel{\rightarrow}{y}_i\in Y\subseteq R\), \(i=1,2,â€¦,N\)ã€‚å…¶ä¸­\(\stackrel{\rightarrow}{x}={(x^{(1)},x^{(2)},â€¦,x^{(n)})}^{T}\)ã€‚éœ€è¦å­¦ä¹ çš„æ¨¡åž‹ä¸ºï¼š \[f(\stackrel{\rightarrow}{x})=\stackrel{\rightarrow}{w}Â·\stackrel{\rightarrow}{x}+b\] å³ï¼šæ ¹æ®å·²çŸ¥çš„æ•°æ®é›†\(T\)æ¥è®¡ç®—å‚æ•°\(\stackrel{\rightarrow}{w}\)å’Œ\(b\)ã€‚ å¯¹äºŽç»™å®šçš„æ ·æœ¬\(\stackrel{\rightarrow}{x}_i\)ï¼Œå…¶é¢„æµ‹å€¼ä¸º\(\hat{y}_i=f(\stackrel{\rightarrow}{x}_i)=\stackrel{\rightarrow}{w}Â·\stackrel{\rightarrow}{x}+b\)ã€‚é‡‡ç”¨å¹³æ–¹æŸå¤±å‡½æ•°ï¼Œåœ¨è®­ç»ƒé›†\(T\)ä¸Šï¼Œæ¨¡åž‹çš„æŸå¤±å‡½æ•°ä¸ºï¼š \[L(f)=\sum_{i=1}^{N}(\hat{y}_i-y_i)^2=\sum_{i=1}^{N}(\stackrel{\rightarrow}{w}Â·\stackrel{\rightarrow}{x}+b-y_i)^2\] æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æŸå¤±å‡½æ•°æœ€å°åŒ–ï¼Œå³ï¼š \[(\stackrel{\rightarrow}{w}^*,b^*)=\arg\min_{\stackrel{\rightarrow}{w},b}\sum_{i=1}^{N}(\stackrel{\rightarrow}{w}Â·\stackrel{\rightarrow}{x}+b-y_i)^2\] å¯ä»¥åˆ©ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥æ±‚è§£ä¸Šè¿°æœ€ä¼˜åŒ–é—®é¢˜çš„æ•°å€¼è§£ã€‚åœ¨ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•çš„æ—¶å€™ï¼Œè¦æ³¨æ„ç‰¹å¾å½’ä¸€åŒ–(Feature Scaling)ï¼Œè¿™ä¹Ÿæ˜¯è®¸å¤šæœºå™¨å­¦ä¹ æ¨¡åž‹éƒ½è¦æ³¨æ„çš„é—®é¢˜ã€‚ç‰¹å¾å½’ä¸€åŒ–å¯ä»¥æœ‰æ•ˆåœ°æå‡æ¨¡åž‹çš„æ”¶æ•›é€Ÿåº¦å’Œæ¨¡åž‹ç²¾åº¦ã€‚ ä¸Šè¿°æœ€ä¼˜åŒ–é—®é¢˜å®žé™…ä¸Šæ˜¯æœ‰è§£æžè§£çš„ï¼Œå¯ä»¥ç”¨æœ€å°äºŒä¹˜æ³•æ¥æ±‚è§£è§£æžè§£ï¼Œè¯¥é—®é¢˜ç§°ä¸ºå¤šå…ƒçº¿æ€§å›žå½’(multivariate linear regression)ã€‚ ä»¤ï¼š \[\vec{\tilde{w}}=(w^{(1)},w^{(2)},â€¦,w^{(n)},b)^T=(\vec{w}^T,b)^T\\ \vec{\tilde{x}}=(x^{(1)},x^{(2)},â€¦,x^{(n)},1)^T=(\vec{x}^T,1)^T\\ \vec{y}=(y_1,y_2,â€¦,y_N)^T\] åˆ™æœ‰ï¼š \[\sum_{i=1}^{N}(\stackrel{\rightarrow}{w}Â·\stackrel{\rightarrow}{x}+b-y_i)^2={(\vec{y}-(\vec{\tilde{x}}_1,\vec{\tilde{x}}_2,â€¦,\vec{\tilde{x}}_N)^T\vec{\tilde{w}})}^T(\vec{y}-(\vec{\tilde{x}}_1,\vec{\tilde{x}}_2,â€¦,\vec{\tilde{x}}_N)^T\vec{\tilde{w}})\] ä»¤ï¼š \[\vec{x}=(\vec{\tilde{x}}_1,\vec{\tilde{x}}_2,â€¦,\vec{\tilde{x}}_N)^T=\begin{bmatrix}\vec{\tilde{x}}_1^T\\\vec{\tilde{x}}_2^T\\â€¦\\\vec{\tilde{x}}_N^T\end{bmatrix}=\begin{bmatrix}x_1^{(1)} &amp; x_1^{(2)} &amp; â€¦ &amp; x_1^{(n)} &amp; 1\\x_2^{(1)} &amp; x_2^{(2)} &amp; â€¦ &amp; x_2^{(n)} &amp; 1\\â€¦ &amp; â€¦ &amp; â€¦ &amp; â€¦ &amp; 1\\x_N^{(1)} &amp; x_N^{(2)} &amp; â€¦ &amp; x_N^{(n)} &amp; 1\end{bmatrix}\] åˆ™ï¼š \[\vec{\tilde{w}}^*=\arg\min_{\vec{\tilde{w}}}(\vec{y}-\vec{x}\vec{\tilde{w}})^T(\vec{y}-\vec{x}\vec{\tilde{w}})\] ä»¤\(E_{\vec{\tilde{w}}}=(\vec{y}-\vec{x}\vec{\tilde{w}})^T(\vec{y}-\vec{x}\vec{\tilde{w}})\)ï¼Œæ±‚å®ƒçš„æžå°å€¼ã€‚å¯¹\(\vec{\tilde{w}}\)æ±‚å¯¼ä»¤å¯¼æ•°ä¸ºé›¶ï¼Œå¾—åˆ°è§£æžè§£ï¼š \[\frac{\partial E_{\vec{\tilde{w}}}}{\partial \vec{\tilde{w}}}=2\vec{x}^T(\vec{x}\vec{\tilde{w}}-\vec{y})=\vec{0}\Longrightarrow \vec{x}^T\vec{x}\vec{\tilde{w}}=\vec{x}^T\vec{y}\] å½“\(\vec{x}^T\vec{x}\)ä¸ºæ»¡ç§©çŸ©é˜µæˆ–è€…æ­£å®šçŸ©é˜µæ—¶ï¼Œå¯å¾—:\[\vec{\tilde{w}}^*=(\vec{x}^T\vec{x})^{-1}\vec{x}^T\vec{y}\]äºŽæ˜¯å¤šå…ƒçº¿æ€§å›žå½’æ¨¡åž‹ä¸ºï¼š\[f(\vec{\tilde{x}}_i)=\vec{\tilde{x}}^T_i\vec{\tilde{w}}^*\] å½“\(\vec{x}^T\vec{x}\)ä¸æ˜¯æ»¡ç§©çŸ©é˜µæ—¶ã€‚æ¯”å¦‚\(N&lt;n\)ï¼ˆæ ·æœ¬æ•°é‡å°äºŽç‰¹å¾ç§ç±»çš„æ•°é‡ï¼‰ï¼Œæ ¹æ®\(\vec{x}\)çš„ç§©å°äºŽç­‰äºŽ\((N,n)\)ä¸­çš„æœ€å°å€¼ï¼Œå³å°äºŽç­‰äºŽ\(N\)ï¼ˆçŸ©é˜µçš„ç§©ä¸€å®šå°äºŽç­‰äºŽçŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°ï¼‰ï¼›è€ŒçŸ©é˜µ\(\vec{x}^T\vec{x}\)æ˜¯\(n\times n\)å¤§å°çš„ï¼Œå®ƒçš„ç§©ä¸€å®šå°äºŽç­‰äºŽ\(N\)ï¼Œå› æ­¤ä¸æ˜¯æ»¡ç§©çŸ©é˜µã€‚æ­¤æ—¶å­˜åœ¨å¤šä¸ªè§£æžè§£ã€‚å¸¸è§çš„åšæ³•æ˜¯å¼•å…¥æ­£åˆ™åŒ–é¡¹ï¼Œå¦‚\(L_1\)æ­£åˆ™åŒ–æˆ–è€…\(L_2\)æ­£åˆ™åŒ–ï¼Œä»¥\(L_2\)æ­£åˆ™åŒ–ä¸ºä¾‹ï¼š\[\vec{\tilde{w}}^*=\arg\min_{\vec{\tilde{w}}}[(\vec{y}-\vec{x}\vec{\tilde{w}})^T(\vec{y}-\vec{x}\vec{\tilde{w}})+\lambda||\vec{\tilde{w}}||_2^2]\]å…¶ä¸­ï¼Œ\(\lambda &gt;0\)è°ƒæ•´æ­£åˆ™åŒ–é¡¹ä¸Žå‡æ–¹è¯¯å·®çš„æ¯”ä¾‹ï¼›\(||â€¦||_2\)ä¸º\(L_2\)èŒƒæ•°ã€‚ æ ¹æ®ä¸Šè¿°åŽŸç†ï¼Œæˆ‘ä»¬å¾—åˆ°å¤šå…ƒçº¿æ€§å›žå½’ç®—æ³•ï¼š è¾“å…¥ï¼šæ•°æ®é›† \(T=\{(\stackrel{\rightarrow}{x}_1,y_1),(\stackrel{\rightarrow}{x}_2,y_2),â€¦,(\stackrel{\rightarrow}{x}_N,y_N)\}\), \(\stackrel{\rightarrow}{x}_i\in X\subseteq R^n\), \(\stackrel{\rightarrow}{y}_i\in Y\subseteq R\), \(i=1,2,â€¦,N\)ï¼Œæ­£åˆ™åŒ–é¡¹ç³»æ•°\(\lambda &gt;0\)ã€‚ è¾“å‡ºï¼š\[f(\stackrel{\rightarrow}{x})=\stackrel{\rightarrow}{w}Â·\stackrel{\rightarrow}{x}+b\] ç®—æ³•æ­¥éª¤ï¼š ä»¤ï¼š\[\vec{\tilde{w}}=(w^{(1)},w^{(2)},â€¦,w^{(n)},b)^T=(\vec{w}^T,b)^T\\\vec{\tilde{x}}=(x^{(1)},x^{(2)},â€¦,x^{(n)},1)^T=(\vec{x}^T,1)^T\\\vec{y}=(y_1,y_2,â€¦,y_N)^T\]è®¡ç®—\[\vec{x}=(\vec{\tilde{x}}_1,\vec{\tilde{x}}_2,â€¦,\vec{\tilde{x}}_N)^T=\begin{bmatrix}\vec{\tilde{x}}_1^T\\\vec{\tilde{x}}_2^T\\â€¦\\\vec{\tilde{x}}_N^T\end{bmatrix}=\begin{bmatrix}x_1^{(1)} &amp; x_1^{(2)} &amp; â€¦ &amp; x_1^{(n)} &amp; 1\\x_2^{(1)} &amp; x_2^{(2)} &amp; â€¦ &amp; x_2^{(n)} &amp; 1\\â€¦ &amp; â€¦ &amp; â€¦ &amp; â€¦ &amp; 1\\x_N^{(1)} &amp; x_N^{(2)} &amp; â€¦ &amp; x_N^{(n)} &amp; 1\end{bmatrix}\] æ±‚è§£ï¼š\[\vec{\tilde{w}}^*=\arg\min_{\vec{\tilde{w}}}[(\vec{y}-\vec{x}\vec{\tilde{w}})^T(\vec{y}-\vec{x}\vec{\tilde{w}})+\lambda||\vec{\tilde{w}}||_2^2]\] æœ€ç»ˆå¾—åˆ°æ¨¡åž‹ï¼š\[f(\vec{\tilde{x}}_i)=\vec{\tilde{x}}^T_i\vec{\tilde{w}}^*\] å¹¿ä¹‰çº¿æ€§æ¨¡åž‹ è€ƒè™‘å•è°ƒå¯å¯¼å‡½æ•°\(h(Â·)\)ï¼Œä»¤\(h(y)=\vec{w}^T\vec{x}+b\)ï¼Œè¿™æ ·å¾—åˆ°çš„æ¨¡åž‹ç§°ä¸ºå¹¿ä¹‰çº¿æ€§æ¨¡åž‹(generalized linear model)ã€‚ å¹¿ä¹‰çº¿æ€§æ¨¡åž‹çš„ä¸€ä¸ªå…¸åž‹ä¾‹å­å°±æ˜¯å¯¹æ•°çº¿æ€§å›žå½’ã€‚å½“\(h(Â·)=\ln{(Â·)}\)æ—¶å½“å¹¿ä¹‰çº¿æ€§æ¨¡åž‹å°±æ˜¯å¯¹æ•°çº¿æ€§å›žå½’ï¼Œå³\[\ln{y}=\vec{w}^T\vec{x}+b\] å®ƒæ˜¯é€šè¿‡\(\exp(\vec{w}^T\vec{x}+b)\)æ‹Ÿåˆ\(y\)çš„ã€‚å®ƒè™½ç„¶ç§°ä¸ºå¹¿ä¹‰çº¿æ€§å›žå½’ï¼Œä½†å®žè´¨ä¸Šæ˜¯éžçº¿æ€§çš„ã€‚ é€»è¾‘å›žå½’ ä¸Šè¿°å†…å®¹éƒ½æ˜¯åœ¨ç”¨çº¿æ€§æ¨¡åž‹è¿›è¡Œå›žå½’å­¦ä¹ ï¼Œè€Œçº¿æ€§æ¨¡åž‹ä¹Ÿå¯ä»¥ç”¨äºŽåˆ†ç±»ã€‚è€ƒè™‘äºŒç±»åˆ†ç±»é—®é¢˜ï¼Œç»™å®šæ•°æ®é›†\(T=\{(\stackrel{\rightarrow}{x}_1,y_1),(\stackrel{\rightarrow}{x}_2,y_2),â€¦,(\stackrel{\rightarrow}{x}_N,y_N)\}\), \(\stackrel{\rightarrow}{x}_i\in X\subseteq R^n\), \(\stackrel{\rightarrow}{y}_i\in Y=\{0,1\},\)\(i=1,2,â€¦,N\)ï¼Œå…¶ä¸­\(\stackrel{\rightarrow}{x}_i={(x_i^{(1)},x_i^{(2)},â€¦,x_i^{(n)})}^{T}\)ã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“\(P(y/ \vec{x})\)ï¼Œè¿™é‡Œç”¨æ¡ä»¶æ¦‚çŽ‡çš„åŽŸå› æ˜¯ï¼šé¢„æµ‹çš„æ—¶å€™éƒ½æ˜¯å·²çŸ¥\(\vec{x}\)ï¼Œç„¶åŽéœ€è¦åˆ¤æ–­æ­¤æ—¶å¯¹åº”çš„\(y\)å€¼ã€‚ è€ƒè™‘åˆ°\(\vec{w}Â·\vec{x}+b\)å–å€¼æ˜¯è¿žç»­çš„ï¼Œå› æ­¤å®ƒä¸èƒ½æ‹Ÿåˆç¦»æ•£å˜é‡ã€‚å¯ä»¥è€ƒè™‘ç”¨å®ƒæ¥æ‹Ÿåˆæ¡ä»¶æ¦‚çŽ‡\(P(y/\vec{x})\)ï¼Œå› ä¸ºæ¦‚çŽ‡çš„å–å€¼ä¹Ÿæ˜¯è¿žç»­çš„ã€‚ä½†æ˜¯å¯¹äºŽ\(\vec{w}\neq \vec{0}\)ï¼ˆè‹¥ç­‰äºŽé›¶å‘é‡åˆ™æ²¡æœ‰æ±‚è§£çš„ä»·å€¼ï¼‰ï¼Œ\(\vec{w}Â·\vec{x}+b\)çš„å–å€¼æ˜¯ä»Ž\(-\infty \thicksim +\infty\)ï¼Œä¸ç¬¦åˆæ¦‚çŽ‡å–å€¼ä¸º\(0\thicksim 1\)ï¼Œå› æ­¤è€ƒè™‘é‡‡ç”¨å¹¿ä¹‰çº¿æ€§æ¨¡åž‹ï¼Œæœ€ç†æƒ³çš„æ˜¯å•ä½é˜¶è·ƒå‡½æ•°ï¼š\[P(y=1/\vec{x})=\left\{\begin{aligned}0,z&lt;0\\0.5,z=0\\1,z&gt;0\end{aligned}\right.,z=\vec{w}Â·\vec{x}+b\] ä½†æ˜¯é˜¶è·ƒå‡½æ•°ä¸æ»¡è¶³å•è°ƒå¯å¯¼çš„æ€§è´¨ï¼Œé€€è€Œæ±‚å…¶æ¬¡ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªå¯å¯¼çš„ã€ä¸Žé˜¶è·ƒå‡½æ•°ç›¸ä¼¼çš„å‡½æ•°ã€‚å¯¹æ•°æ¦‚çŽ‡å‡½æ•°(logistic function)å°±æ˜¯è¿™æ ·ä¸€ä¸ªæ›¿ä»£å‡½æ•°ï¼š\[P(y=1/\vec{x})=\frac{1}{1+e^{-z}},z=\vec{w}Â·\vec{x}+b\] ç”±äºŽ\(P(y=0/\vec{x})=1-P(y=1/\vec{x})\)ï¼Œåˆ™æœ‰ï¼š\(\ln{\frac{P(y=1/\vec{x})}{P(y=0/\vec{x})}}=z=\vec{w}Â·\vec{x}+b\)ã€‚æ¯”å€¼\(\frac{P(y=1/\vec{x})}{P(y=0/\vec{x})}\)è¡¨ç¤ºæ ·æœ¬ä¸ºæ­£ä¾‹çš„å¯èƒ½æ€§æ¯”åä¾‹çš„å¯èƒ½æ€§ï¼Œç§°ä¸ºæ¦‚çŽ‡(odds)ï¼Œåæ˜ æ ·æœ¬ä½œä¸ºæ­£ä¾‹çš„ç›¸å¯¹å¯èƒ½æ€§ã€‚æ¦‚çŽ‡å¤§å¯¹æ•°ç§°ä¸ºå¯¹æ•°æ¦‚çŽ‡(log oddsï¼Œä¹Ÿç§°ä¸ºlogit)ã€‚ ä¸‹é¢ç»™å‡ºé€»è¾‘å›žå½’æ¨¡åž‹å‚æ•°ä¼°è®¡ï¼šç»™å®šè®­ç»ƒæ•°æ®é›†\(T=\{(\stackrel{\rightarrow}{x}_1,y_1),(\stackrel{\rightarrow}{x}_2,y_2),â€¦,(\stackrel{\rightarrow}{x}_N,y_N)\}\)ï¼Œå…¶ä¸­\(\vec{x}_i \in R^n,y_i \in \{0,1\}\)ã€‚æ¨¡åž‹ä¼°è®¡çš„åŽŸç†ï¼šç”¨æžå¤§ä¼¼ç„¶ä¼°è®¡æ³•ä¼°è®¡æ¨¡åž‹å‚æ•°ã€‚ ä¸ºäº†ä¾¿äºŽè®¨è®ºï¼Œæˆ‘ä»¬å°†å‚æ•°\(b\)å¸æ”¶è¿›\(\vec{w}\)ä¸­ï¼Œä»¤ï¼š\[\vec{\tilde{w}}={(w^{(1)},w^{(2)},â€¦,w^{(n)},b)}^{T}\in R^{n+1}\\\vec{\tilde{x}}={(x^{(1)},x^{(2)},â€¦,x^{(n)},1)}^{T}\in R^{n+1}\] ä»¤\(P(Y=1/\vec{\tilde{x}})=\pi (\vec{\tilde{x}})=\frac{\exp (\vec{\tilde{w}}Â·\vec{\tilde{x}})}{1+\exp (\vec{\tilde{w}}Â·\vec{\tilde{x}})}\),\(P(Y= 0/\vec{\tilde{x}})=1-\pi (\vec{\tilde{x}})\)ï¼Œåˆ™ä¼¼ç„¶å‡½æ•°ä¸ºï¼š\[\prod_{i=1}^N[\pi (\vec{\tilde{x}}_i)]^{y_i}[1-\pi (\vec{\tilde{x}}_i)]^{1-y_i}\] å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºï¼š\[L(\vec{\tilde{w}})=\sum_{i=1}^N[y_i\log \pi (\vec{\tilde{x}}_i)+(1-y_i)\log (1-\pi (\vec{\tilde{x}}_i)]\\=\sum_{i=1}^N[y_i\log \frac{\pi (\vec{\tilde{x}}_i)}{1-\pi (\vec{\tilde{x}}_i)}+\log(1-\pi (\vec{\tilde{x}}_i))]\] åˆç”±äºŽ\(\pi (\vec{\tilde{x}}_i)=\frac{\exp (\vec{\tilde{w}}Â·\vec{\tilde{x}})}{1+\exp (\vec{\tilde{w}}Â·\vec{\tilde{x}})}\)ï¼Œå› æ­¤ï¼š\[L(\vec{\tilde{w}})=\sum_{i=1}^N[y_i(\vec{\tilde{w}}Â·\vec{\tilde{x}}_i)-\log (1+\exp(\vec{\tilde{w}}Â·\vec{\tilde{x}}_i))]\] å¯¹\(L(\vec{\tilde{w}})\)æ±‚æžå¤§å€¼ï¼Œå¾—åˆ°\(\vec{\tilde{w}}\)çš„ä¼°è®¡å€¼ã€‚è®¾ä¼°è®¡å€¼ä¸º\(\vec{\tilde{w}}^{*}\)ï¼Œåˆ™é€»è¾‘å›žå½’æ¨¡åž‹ä¸ºï¼š\[P(Y=1/X=\vec{\tilde{x}})=\frac{\exp (\vec{\tilde{w}}^{*} Â·\vec{\tilde{x}})}{1+\exp(\vec{\tilde{w}}^{*}Â·\vec{\tilde{x}})}\\P(Y=0/X=\vec{\tilde{x}})=\frac{1}{1+\exp(\vec{\tilde{w}}^{*}Â·\vec{\tilde{x}})}\] é€šå¸¸ç”¨æ¢¯åº¦ä¸‹é™æ³•æˆ–è€…æ‹Ÿç‰›é¡¿æ³•æ¥æ±‚è§£è¯¥æœ€å¤§å€¼é—®é¢˜ ä»¥ä¸Šè®¨è®ºçš„éƒ½æ˜¯äºŒç±»åˆ†ç±»çš„é€»è¾‘å›žå½’æ¨¡åž‹ï¼Œå¯ä»¥æŽ¨å¹¿åˆ°å¤šç±»åˆ†ç±»é€»è¾‘å›žå½’æ¨¡åž‹ã€‚è®¾ç¦»æ•£æ€§éšæœºå˜é‡Yçš„å–å€¼é›†åˆä¸ºï¼š\(\{1,2,â€¦,K\}\)ï¼Œåˆ™å¤šç±»åˆ†ç±»é€»è¾‘å›žå½’æ¨¡åž‹ä¸ºï¼š\[P(Y=k/\vec{\tilde{x}})=\frac{\exp (\vec{\tilde{w}}_k Â·\vec{\tilde{x}})}{1+\sum_{k=1}^{K-1}\exp(\vec{\tilde{w}}_kÂ·\vec{\tilde{x}})},k=1,2,â€¦,K-1\\P(Y=K/\vec{\tilde{x}})=\frac{1}{1+\sum_{k=1}^{K-1}\exp(\vec{\tilde{w}}_kÂ·\vec{\tilde{x}})},\vec{\tilde{x}}\in R^{n+1},\vec{\tilde{w}}_k\in R^{n+1}\] å…¶å‚æ•°ä¼°è®¡æ–¹æ³•ç±»ä¼¼äºŒç±»åˆ†ç±»é€»è¾‘å›žå½’æ¨¡åž‹ã€‚ çº¿æ€§åˆ¤åˆ«åˆ†æž çº¿æ€§åˆ¤åˆ«åˆ†æž(Linear Discriminant Analysis, LDA)çš„æ€æƒ³ï¼š è®­ç»ƒæ—¶ï¼šè®¾æ³•å°†è®­ç»ƒæ ·æœ¬æŠ•å½±åˆ°ä¸€æ¡ç›´çº¿ä¸Šï¼Œä½¿å¾—åŒç±»æ ·æœ¬çš„æŠ•å½±ç‚¹å°½å¯èƒ½åœ°æŽ¥è¿‘ã€å¼‚ç±»æ ·æœ¬çš„æŠ•å½±ç‚¹å°½å¯èƒ½åœ°è¿œç¦»ã€‚è¦å­¦ä¹ çš„å°±æ˜¯è¿™æ ·ä¸€æ¡ç›´çº¿ã€‚ é¢„æµ‹æ—¶ï¼šå°†å¾…é¢„æµ‹æ ·æœ¬æŠ•å½±åˆ°å­¦ä¹ åˆ°ç›´çº¿ä¸Šï¼Œæ ¹æ®å®ƒçš„æŠ•å½±ç‚¹çš„ä½ç½®æ¥åˆ¤å®šå®ƒçš„ç±»åˆ«ã€‚ è€ƒè™‘äºŒç±»åˆ†ç±»é—®é¢˜ï¼Œç»™å®šæ•°æ®é›†\(T=\{(\stackrel{\rightarrow}{x}_1,y_1),(\stackrel{\rightarrow}{x}_2,y_2),â€¦,(\stackrel{\rightarrow}{x}_N,y_N)\}\), \(\stackrel{\rightarrow}{x}_i\in X\subseteq R^n\), \(\stackrel{\rightarrow}{y}_i\in Y=\{0,1\}\), \(i=1,2,â€¦,N\)ï¼Œå…¶ä¸­\(\stackrel{\rightarrow}{x}_i={(x_i^{(1)},x_i^{(2)},â€¦,x_i^{(n)})}^{T}\)ã€‚ è®¾\(T_0\)è¡¨ç¤ºç±»åˆ«ä¸º0çš„æ ·ä¾‹çš„é›†åˆï¼Œè¿™äº›æ ·ä¾‹çš„å‡å€¼å‘é‡ä¸º\(\stackrel{\rightarrow}{\mu}_0={(\mu_0^{(1)},\mu_0^{(2)},â€¦,\mu_0^{(n)})}^{T}\)ï¼Œè¿™äº›æ ·ä¾‹çš„ç‰¹å¾ä¹‹é—´åæ–¹å·®çŸ©é˜µä¸º\(\sum_0\)ï¼ˆåæ–¹å·®çŸ©é˜µå¤§å°ä¸º\(n\times n\)ï¼‰ã€‚ è®¾\(T_1\)è¡¨ç¤ºç±»åˆ«ä¸º1çš„æ ·ä¾‹çš„é›†åˆï¼Œè¿™äº›æ ·ä¾‹çš„å‡å€¼å‘é‡ä¸º\(\stackrel{\rightarrow}{\mu}_1={(\mu_1^{(1)},\mu_1^{(2)},â€¦,\mu_1^{(n)})}^{T}\)ï¼Œè¿™äº›æ ·ä¾‹çš„ç‰¹å¾ä¹‹é—´åæ–¹å·®çŸ©é˜µä¸º\(\sum_1\)ï¼ˆåæ–¹å·®çŸ©é˜µå¤§å°ä¸º\(n\times n\)ï¼‰ã€‚ å‡å®šç›´çº¿ä¸º\(y=\vec{w}^T\vec{x}\)ï¼ˆè¿™é‡Œçœç•¥äº†\(b\)ï¼Œå› ä¸ºè€ƒå¯Ÿçš„æ˜¯æ ·æœ¬ç‚¹åœ¨ç›´çº¿ä¸Šçš„æŠ•å½±ï¼Œæ€»å¯ä»¥å¹³è¡Œç§»åŠ¨ç›´çº¿åˆ°åŽŸç‚¹è€Œä¿æŒæŠ•å½±ä¸å˜ï¼Œæ­¤æ—¶\(b=0\)ï¼‰ï¼Œå…¶ä¸­\(\stackrel{\rightarrow}{w}={(w^{(1)},w^{(2)},â€¦,w^{(n)})}^{T}\),\(\stackrel{\rightarrow}{x}={(x^{(1)},x^{(2)},â€¦,x^{(n)})}^{T}\) å°†æ•°æ®æŠ•å½±åˆ°ç›´çº¿ä¸Šï¼Œåˆ™ ä¸¤ç±»æ ·æœ¬çš„ä¸­å¿ƒåœ¨ç›´çº¿ä¸Šçš„æŠ•å½±åˆ†åˆ«ä¸º\(\vec{w}^T\vec{\mu}_0\)å’Œ\(\vec{w}^T\vec{\mu}_1\)ã€‚ ä¸¤ç±»æ ·æœ¬æŠ•å½±çš„æ–¹å·®åˆ†åˆ«ä¸º\(\vec{w}^T\sum_0\vec{w}\)å’Œ\(\vec{w}^T\sum_1\vec{w}\)ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼šåŒç±»æ ·æœ¬çš„æŠ•å½±ç‚¹å°½å¯èƒ½åœ°æŽ¥è¿‘ã€å¼‚ç±»æ ·æœ¬ç‚¹æŠ•å½±ç‚¹å°½å¯èƒ½åœ°è¿œç¦»ã€‚é‚£ä¹ˆå¯ä»¥ä½¿åŒç±»æ ·ä¾‹æŠ•å½±ç‚¹ç‚¹æ–¹å·®å°½å¯èƒ½åœ°å°ï¼Œå³\(\vec{w}^T\sum_0\vec{w}+\vec{w}^T\sum_1\vec{w}\)å°½å¯èƒ½åœ°å°ï¼›å¯ä»¥ä½¿å¼‚ç±»æ ·ä¾‹çš„ä¸­å¿ƒçš„æŠ•å½±ç‚¹å°½å¯èƒ½åœ°è¿œï¼Œå³\(||\vec{w}^T\vec{\mu}_0-\vec{w}^T\vec{\mu}_1||_2^2\)å°½å¯èƒ½åœ°å¤§ã€‚äºŽæ˜¯å¾—åˆ°æœ€å¤§åŒ–çš„ç›®æ ‡ï¼š\[J=\frac{||\vec{w}^T\vec{\mu}_0-\vec{w}^T\vec{\mu}_1||_2^2}{\vec{w}^T\sum_0\vec{w}+\vec{w}^T\sum_1\vec{w}}=\frac{\vec{w}^T(\vec{\mu}_0-\vec{\mu}_1)(\vec{\mu}_0-\vec{\mu}_1)^T\vec{w}}{\vec{w}^T(\sum_0+\sum_1)\vec{w}}\] å®šä¹‰ç±»å†…æ•£åº¦çŸ©é˜µ(within-class scatter matrix)ï¼š\[S_w={\sum}_0+{\sum}_1=\sum_{\vec{x}\in T_0}(\vec{x}-\vec{\mu}_0)(\vec{x}-\vec{\mu}_0)^T+\sum_{\vec{x}\in T_1}(\vec{x}-\vec{\mu}_1)(\vec{x}-\vec{\mu}_1)^T\] å®šä¹‰ç±»é—´æ•£åº¦çŸ©é˜µ(between-class scatter matrix)ï¼š\(S_b=(\vec{\mu}_0-\vec{\mu}_1)(\vec{\mu}_0-\vec{\mu}_1)^T\)ï¼Œå®ƒæ˜¯å‘é‡\((\vec{\mu}_0-\vec{\mu}_1)\)ä¸Žå®ƒè‡ªèº«çš„å¤–ç§¯ï¼Œåˆ™LDAæœ€å¤§åŒ–çš„ç›®æ ‡ä¸ºï¼š\[J=\frac{\vec{w}^TS_b\vec{w}}{\vec{w}^TS_w\vec{w}}\] \(J\)ä¹Ÿç§°ä¸º\(S_b\)ä¸Ž\(S_w\)çš„å¹¿ä¹‰ç‘žåˆ©å•†ã€‚çŽ°åœ¨æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜ï¼š\[\vec{w}^*=\arg \max_{\vec{w}}\frac{\vec{w}^TS_b\vec{w}}{\vec{w}^TS_w\vec{w}}\] ç”±äºŽåˆ†å­ä¸Žåˆ†æ¯éƒ½æ˜¯å…³äºŽ\(\vec{w}\)çš„äºŒæ¬¡é¡¹ï¼Œå› æ­¤ä¸Šå¼çš„è§£ä¸Ž\(\vec{w}\)çš„é•¿åº¦æ— å…³ã€‚ä»¤\(\vec{w}^TS_w\vec{w}=1\)ï¼Œåˆ™æœ€ä¼˜åŒ–é—®é¢˜æ”¹å†™ä¸ºï¼š\[\vec{w}^*=\arg \min_{\vec{w}}-\vec{w}^TS_b\vec{w}\\s.t.\vec{w}^TS_w\vec{w}=1\] åº”ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼š\[S_b\vec{w}=\lambda S_w\vec{w}\] ä»¤\((\vec{\mu}_0-\vec{\mu}_1)^T\vec{w}=\lambda_{\vec{w}}\)ï¼Œå…¶ä¸­\(\lambda_{\vec{w}}\)ä¸ºå®žæ•°ã€‚åˆ™\[S_b\vec{w}=(\vec{\mu}_0-\vec{\mu}_1)(\vec{\mu}_0-\vec{\mu}_1)^T\vec{w}=\lambda_{\vec{w}}(\vec{\mu}_0-\vec{\mu}_1)=\lambda S_w\vec{w}\] ç”±äºŽä¸Ž\(\vec{w}\)çš„é•¿åº¦æ— å…³ï¼Œå¯ä»¥ä»¤\(\lambda_{\vec{w}}=\lambda\)ï¼Œåˆ™æœ‰ï¼š\[(\vec{\mu}_0-\vec{\mu}_1)=S_w\vec{w}\Longrightarrow \vec{w}=S_w^{-1}(\vec{\mu}_0-\vec{\mu}_1)\] ä¸Šè¿°è®¨è®ºçš„æ˜¯äºŒç±»åˆ†ç±»LDAç®—æ³•ã€‚å¯ä»¥å°†å®ƒæŽ¨å¹¿åˆ°å¤šåˆ†ç±»ä»»åŠ¡ä¸­ï¼šå‡å®šå­˜åœ¨\(M\)ä¸ªç±»ï¼Œå±žäºŽç¬¬\(i\)ä¸ªç±»çš„æ ·æœ¬çš„é›†åˆä¸º\(T_i\)ï¼Œ\(T_i\)ä¸­çš„æ ·ä¾‹æ•°ä¸º\(m_i\)ï¼Œåˆ™æœ‰ï¼š\(\sum_{i=1}^Mm_i=N\)ï¼Œå…¶ä¸­\(N\)ä¸ºæ ·æœ¬æ€»æ•°ã€‚è®¾\(T_i\)è¡¨ç¤ºç±»åˆ«ä¸º\(iï¼Œi=1,2,â€¦,M\)çš„æ ·ä¾‹çš„é›†åˆï¼Œè¿™äº›æ ·ä¾‹çš„å‡å€¼å‘é‡ä¸ºï¼š\[\vec{\mu}_i=(\mu_i^{(1)},\mu_i^{(2)},â€¦,\mu_i^{(n)})^T=\frac{1}{m_i}\sum_{\vec{x}_i\in T_i}\vec{x}_i\] è¿™äº›æ ·ä¾‹çš„ç‰¹å¾ä¹‹é—´åæ–¹å·®çŸ©é˜µä¸º\(\sum_i\)ï¼ˆåæ–¹å·®çŸ©é˜µå¤§å°ä¸º\(n\times n\)ï¼‰ã€‚å®šä¹‰\(\vec{\mu}=(\mu^{(1)},\mu^{(2)},â€¦,\mu^{(n)})^T=\frac{1}{N}\sum_{i=1}^N\vec{x}_i\)æ˜¯æ‰€æœ‰æ ·ä¾‹çš„å‡å€¼å‘é‡ã€‚ è¦ä½¿å¾—åŒç±»æ ·ä¾‹çš„æŠ•å½±ç‚¹å°½å¯èƒ½åœ°æŽ¥è¿‘ï¼Œåˆ™å¯ä»¥ä½¿åŒç±»æ ·ä¾‹æŠ•å½±ç‚¹çš„æ–¹å·®å°½å¯èƒ½åœ°å°ï¼Œå› æ­¤å®šä¹‰ç±»åˆ«çš„ç±»å†…æ•£åº¦çŸ©é˜µä¸º\(S_{wi}=\sum_{\vec{x}\in T_i}(\vec{x}-\vec{\mu}_i)(\vec{x}-\vec{\mu}_i)^T\)ï¼›å®šä¹‰ç±»å†…æ•£åº¦çŸ©é˜µä¸º\(S_w=\sum_{i=1}^MS_{wi}\)ã€‚ ç±»åˆ«çš„ç±»å†…æ•£åº¦çŸ©é˜µä¸º\(S_{wi}=\sum_{\vec{x}\in T_i}(\vec{x}-\vec{\mu}_i)(\vec{x}-\vec{\mu}_i)^T\)ï¼Œå®žé™…ä¸Šå°±ç­‰äºŽæ ·æœ¬é›†\(T_i\)çš„åæ–¹å·®çŸ©é˜µ\(\sum_i\)ã€‚ è¦ä½¿å¼‚ç±»æ ·ä¾‹çš„æŠ•å½±ç‚¹å°½å¯èƒ½åœ°è¿œï¼Œåˆ™å¯ä»¥ä½¿å¼‚ç±»æ ·ä¾‹ä¸­å¿ƒçš„æŠ•å½±ç‚¹å°½å¯èƒ½åœ°è¿œï¼Œç”±äºŽè¿™é‡Œä¸æ­¢ä¸¤ä¸ªä¸­å¿ƒç‚¹ï¼Œå› æ­¤ä¸èƒ½ç®€å•åœ°å¥—ç”¨äºŒç±»LDAçš„åšæ³•ï¼ˆå³ä¸¤ä¸ªä¸­å¿ƒç‚¹çš„è·ç¦»ï¼‰ã€‚è¿™é‡Œç”¨æ¯ä¸€ç±»æ ·æœ¬é›†çš„ä¸­å¿ƒç‚¹è·å’Œæ€»çš„ä¸­å¿ƒç‚¹çš„è·ç¦»ä½œä¸ºåº¦é‡ã€‚è€ƒè™‘åˆ°æ¯ä¸€ç±»æ ·æœ¬é›†çš„å¤§å°å¯èƒ½ä¸åŒï¼ˆå¯†åº¦åˆ†å¸ƒä¸å‡ï¼‰ï¼Œæ•…æˆ‘ä»¬å¯¹è¿™ä¸ªè·ç¦»åŠ ä»¥æƒé‡ï¼Œå› æ­¤å®šä¹‰ç±»é—´æ•£åº¦çŸ©é˜µ\(S_b=\sum_{i=1}^Mm_i(\vec{\mu}_i-\vec{\mu})(\vec{\mu}_i-\vec{\mu})^T\)ã€‚ \((\vec{\mu}_i-\vec{\mu})(\vec{\mu}_i-\vec{\mu})^T\)ä¹Ÿæ˜¯ä¸€ä¸ªåæ–¹å·®çŸ©é˜µï¼Œå®ƒåˆ»ç”»çš„æ˜¯ç¬¬\(i\)ç±»ä¸Žæ€»ä½“ä¹‹é—´çš„å…³ç³»ã€‚ è®¾\(W\in R^{n\times (M-1)}\)æ˜¯æŠ•å½±çŸ©é˜µã€‚ç»è¿‡æŽ¨å¯¼å¯ä»¥å¾—åˆ°æœ€å¤§åŒ–çš„ç›®æ ‡ï¼š\[J=\frac{tr(W^TS_bW)}{tr(W^TS_wW)}\] å…¶ä¸­\(tr(.)\)è¡¨ç¤ºçŸ©é˜µçš„è¿¹ã€‚ä¸€ä¸ªçŸ©é˜µçš„è¿¹æ˜¯çŸ©é˜µå¯¹è§’çº¿çš„å…ƒç´ ä¹‹å’Œï¼Œå®ƒæ˜¯ä¸€ä¸ªçŸ©é˜µçš„ä¸å˜é‡ï¼Œä¹Ÿç­‰äºŽæ‰€æœ‰ç‰¹å¾å€¼ä¹‹å’Œã€‚ è¿˜æœ‰ä¸€ä¸ªå¸¸ç”¨çš„çŸ©é˜µä¸å˜é‡æ˜¯çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œå®ƒç­‰äºŽçŸ©é˜µçš„æ‰€æœ‰ç‰¹å¾å€¼ä¹‹ç§¯ã€‚ å¤šåˆ†ç±»LDAå°†æ ·æœ¬æŠ•å½±åˆ°\(M-1\)ç»´ç©ºé—´ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ç§ç»å…¸çš„ç›‘ç£é™ç»´æŠ€æœ¯ã€‚ Pythonå®žæˆ˜ 123import matplotlib.pyplot as pltimport numpy as npfrom sklearn import datasets, linear_model, discriminant_analysis, model_selection åœ¨çº¿æ€§å›žå½’é—®é¢˜ä¸­ï¼Œæ•°æ®é›†ä½¿ç”¨äº†scikit-learnè‡ªå¸¦çš„ä¸€ä¸ªæ•°æ®é›†ã€‚è¯¥æ•°æ®é›†æœ‰442ä¸ªæ ·æœ¬ï¼›æ¯ä¸ªæ ·æœ¬æœ‰10ä¸ªç‰¹å¾ï¼›æ¯ä¸ªç‰¹å¾éƒ½æ˜¯æµ®ç‚¹æ•°ï¼Œæ•°æ®éƒ½åœ¨-0.2ï½ž0.2ä¹‹é—´ï¼›æ ·æœ¬çš„ç›®æ ‡åœ¨æ•´æ•°25ï½ž346ä¹‹é—´ã€‚ 12345678def load_data(): &quot;&quot;&quot; åŠ è½½æ•°æ®é›†å¹¶éšæœºåˆ‡åˆ†æ•°æ®é›†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­test_sizeæŒ‡å®šäº†æµ‹è¯•é›†ä¸ºåŽŸå§‹æ•°æ®é›†çš„å¤§å°/æ¯”ä¾‹ :return: listï¼šè®­ç»ƒæ ·æœ¬é›†ã€æµ‹è¯•æ ·æœ¬é›†ã€è®­ç»ƒæ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ã€æµ‹è¯•æ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ &quot;&quot;&quot; diabetes = datasets.load_diabetes() return model_selection.train_test_split(diabetes.data, diabetes.target, test_size=0.25, random_state=0) çº¿æ€§å›žå½’æ¨¡åž‹ LinearRegressionæ˜¯scikit-learnæä¾›çš„çº¿æ€§å›žå½’æ¨¡åž‹ 1class sklearn.linear_model.LinearRegression(fit_intercept=True, normalize=Fasle, copy_X=True, n_jobs=1) å‚æ•° fit_intercept : boolean, optional, default True. æŒ‡å®šæ˜¯å¦éœ€è¦è®¡ç®—bå€¼, å¦‚æžœä¸ºFalseåˆ™ä¸è®¡ç®—bå€¼ã€‚ normalize : boolean, optional, default False. å¦‚æžœä¸ºTrueï¼Œé‚£ä¹ˆè®­ç»ƒæ ·æœ¬ä¼šåœ¨å›žå½’ä¹‹å‰è¢«å½’ä¸€åŒ–ã€‚ copy_X : boolean, optional, default True. å¦‚æžœä¸ºTrueï¼Œåˆ™ä¼šå¤åˆ¶Xã€‚ n_jobs : int or None, optional (default=None). ä»»åŠ¡å¹¶è¡Œæ—¶æŒ‡å®šçš„CPUæ•°é‡ï¼Œå¦‚æžœä¸º-1åˆ™ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„CPUã€‚ å±žæ€§ coef_ : æƒé‡å‘é‡ intercept_ : bå€¼ æ–¹æ³• fit(X, y[, sample_weight]): è®­ç»ƒæ¨¡åž‹ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ score(X, y[, sample_weight]): è¿”å›žé¢„æµ‹æ€§èƒ½å¾—åˆ† è®¾é¢„æµ‹é›†ä¸º\(T_{test}\)ï¼ŒçœŸå®žå€¼ä¸º\(y_i\)ï¼ŒçœŸå®žå€¼çš„å‡å€¼ä¸º\(\overline{y}\)ï¼Œé¢„æµ‹å€¼ä¸º\(\hat{y}_i\)ï¼Œåˆ™ï¼š\[score=1-\frac{\sum_{T_{test}}(y_i-\hat{y}_i)^2}{(y_i-\overline{y})^2}\] scoreä¸è¶…è¿‡1ï¼Œä½†æ˜¯å¯èƒ½ä¸ºè´Ÿå€¼ï¼ˆé¢„æµ‹æ•ˆæžœå¤ªå·®ï¼‰ã€‚ scoreè¶Šå¤§ï¼Œé¢„æµ‹æ€§èƒ½è¶Šå¥½ã€‚ 12345678910111213def demo_LinearRegression(*data): &quot;&quot;&quot; ä½¿ç”¨LinearRegressionå‡½æ•° :param data: è®­ç»ƒæ ·æœ¬é›†ã€æµ‹è¯•æ ·æœ¬é›†ã€è®­ç»ƒæ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ã€æµ‹è¯•æ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ :return: æƒé‡å‘é‡ã€bå€¼ï¼Œé¢„æµ‹ç»“æžœçš„å‡æ–¹è¯¯å·®ï¼Œé¢„æµ‹æ€§èƒ½å¾—åˆ† &quot;&quot;&quot; X_train, X_test, y_train, y_test = data regr = linear_model.LinearRegression() regr.fit(X_train, y_train) print(&apos;Coefficients: %s&apos; % regr.coef_) print(&apos;Intercept: %.2f&apos; % regr.intercept_) print(&apos;Residual sum of squares: %.2f&apos; % np.mean((regr.predict(X_test) - y_test) ** 2)) print(&apos;Score: %.2f&apos; % regr.score(X_test, y_test)) è¯¥å‡½æ•°ç®€å•åœ°ä»Žè®­ç»ƒæ•°æ®é›†ä¸­å­¦ä¹ ï¼Œç„¶åŽä»Žæµ‹è¯•æ•°æ®ä¸­é¢„æµ‹ã€‚è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_LinearRegression(X_train, X_test, y_train, y_test) è¾“å‡ºç»“æžœå¦‚ä¸‹ï¼š 12345Coefficients: [ -43.26774487 -208.67053951 593.39797213 302.89814903 -560.27689824 261.47657106 -8.83343952 135.93715156 703.22658427 28.34844354]Intercept: 153.07Residual sum of squares: 3180.20Score: 0.36 å¯ä»¥çœ‹åˆ°æµ‹è¯•é›†ä¸­é¢„æµ‹ç»“æžœçš„å‡æ–¹è¯¯å·®ä¸º3180.20ï¼Œé¢„æµ‹æ€§èƒ½å¾—åˆ†ä»…ä¸º0.36ã€‚ çº¿æ€§å›žå½’æ¨¡åž‹çš„æ­£åˆ™åŒ– å‰é¢ç†è®ºéƒ¨åˆ†æåˆ°å¯¹äºŽå¤šå…ƒçº¿æ€§å›žå½’ï¼Œå½“\(\vec{x}^T\vec{x}\)ä¸æ˜¯æ»¡ç§©çŸ©é˜µæ—¶å­˜åœ¨å¤šä¸ªè§£æžè§£ï¼Œå®ƒä»¬éƒ½èƒ½ä½¿å¾—å‡æ–¹è¯¯å·®æœ€å°åŒ–ï¼Œå¸¸è§çš„åšæ³•æ˜¯å¼•å…¥æ­£åˆ™åŒ–é¡¹ã€‚æ‰€è°“æ­£åˆ™åŒ–ï¼Œå°±æ˜¯å¯¹æ¨¡åž‹çš„å‚æ•°æ·»åŠ ä¸€äº›å…ˆéªŒå‡è®¾ï¼ŒæŽ§åˆ¶æ¨¡åž‹ç©ºé—´ï¼Œä»¥è¾¾åˆ°ä½¿å¾—æ¨¡åž‹å¤æ‚åº¦è¾ƒå°çš„ç›®çš„ã€‚å²­å›žå½’å’ŒLASSOæ˜¯ç›®å‰æœ€æµè¡Œçš„ä¸¤ç§çº¿æ€§å›žå½’æ­£åˆ™åŒ–æ–¹æ³•ã€‚æ ¹æ®ä¸åŒçš„æ­£åˆ™åŒ–æ–¹å¼ï¼Œæœ‰ä¸åŒçš„æ–¹æ³•ï¼š Ridge Regression: æ­£åˆ™åŒ–é¡¹ä¸ºï¼š\(\alpha ||\vec{w}||_2^2,\alpha &gt;0\)ã€‚ Lasso Regression: æ­£åˆ™åŒ–é¡¹ä¸ºï¼š\(\alpha ||\vec{w}||_1, \alpha &gt;0\)ã€‚ Elastic Net: æ­£åˆ™åŒ–é¡¹ä¸ºï¼š\(\alpha \rho ||\vec{w}||_1+\frac{\alpha (1-\rho )}{2}||\vec{w}||_2^2,\alpha &gt;0,1\ge\rho \ge 0\)ã€‚ å…¶ä¸­ï¼Œæ­£åˆ™é¡¹ç³»æ•°\(\alpha\)çš„é€‰æ‹©å¾ˆå…³é”®ï¼Œåˆå§‹å€¼å»ºè®®ä¸€å¼€å§‹è®¾ç½®ä¸º0ï¼Œå…ˆç¡®å®šä¸€ä¸ªæ¯”è¾ƒå¥½çš„learning rateï¼Œç„¶åŽå›ºå®šè¯¥learning rateï¼Œç»™\(\alpha\)ä¸€ä¸ªå€¼ï¼ˆæ¯”å¦‚1.0ï¼‰ï¼Œç„¶åŽæ ¹æ®validation accuracyå°†\(\alpha\)å¢žå¤§æˆ–è€…ç¼©å°10å€ï¼ˆå¢žå‡10å€ä¸ºç²—è°ƒèŠ‚ï¼Œå½“ä½ ç¡®å®šäº†\(\alpha\)åˆé€‚çš„æ•°é‡çº§åŽï¼Œæ¯”å¦‚\(\alpha=0.01\)ï¼Œå†è¿›ä¸€æ­¥ç»†è°ƒèŠ‚ä¸º0.02ã€0.03ã€0.0009ç­‰ï¼‰ã€‚ å²­å›žå½’ å²­å›žå½’(Ridge Regression)æ˜¯ä¸€ç§æ­£åˆ™åŒ–æ–¹æ³•ï¼Œé€šè¿‡å€¼æŸå¤±å‡½æ•°ä¸­åŠ å…¥\(L_2\)èŒƒæ•°æƒ©ç½šé¡¹ï¼Œæ¥æŽ§åˆ¶çº¿æ€§æ¨¡åž‹çš„å¤æ‚ç¨‹åº¦ï¼Œä»Žè€Œä½¿å¾—æ¨¡åž‹æ›´ç¨³å¥ã€‚Ridgeç±»å®žçŽ°äº†å²­å›žå½’æ¨¡åž‹ï¼Œå…¶åŽŸåž‹ä¸ºï¼š 12class sklearn.linear_model.Ridge(alpha=1.0, fit_intercept=True, normalize=False, copy_X=True, max_iter=None, tol=0.001, solver=&apos;auto, random_state=None) å‚æ•° alpha: \(\alpha\)å€¼ï¼Œå…¶å€¼è¶Šå¤§åˆ™æ­£åˆ™åŒ–é¡¹çš„å æ¯”è¶Šå¤§ã€‚ fit_intercept: booleanï¼ŒæŒ‡å®šæ˜¯å¦éœ€è¦è®¡ç®—bå€¼ã€‚ max_iter: ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šæœ€å¤§è¿­ä»£æ¬¡æ•°ã€‚å¦‚æžœä¸ºNoneåˆ™ä¸ºé»˜è®¤å€¼ï¼Œä¸åŒsolverçš„é»˜è®¤å€¼ä¸åŒã€‚ normalize: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œé‚£ä¹ˆè®­ç»ƒæ ·æœ¬ä¼šåœ¨å›žå½’ä¹‹å‰è¢«å½’ä¸€åŒ–ã€‚ copy_X: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œåˆ™ä¼šå¤åˆ¶Xã€‚ solver: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šæ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜çš„ç®—æ³•ã€‚ auto: æ ¹æ®æ•°æ®é›†è‡ªåŠ¨é€‰æ‹©ç®—æ³• svd: ä½¿ç”¨å¥‡å¼‚å€¼åˆ†è§£æ¥è®¡ç®—å›žå½’ç³»æ•° cholesky: ä½¿ç”¨scipy.linalg.solveå‡½æ•°æ¥æ±‚è§£ sparse_cg: ä½¿ç”¨scipy.sparse.linalg.cgå‡½æ•°æ¥æ±‚è§£ lsqr: ä½¿ç”¨scipy.sparse.linalg.lsqrå‡½æ•°æ¥æ±‚è§£ï¼Œè¿ç®—é€Ÿåº¦æœ€å¿« sag: ä½¿ç”¨Stochastic Average Gradient descentç®—æ³•æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜ tol: ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ŒæŒ‡å®šåˆ¤æ–­è¿­ä»£æ”¶æ•›ä¸Žå¦çš„é˜ˆå€¼ã€‚ random_state: ä¸€ä¸ªæ•´æ•°æˆ–è€…ä¸€ä¸ªRandomStateå®žä¾‹ï¼Œæˆ–è€…Noneï¼›åœ¨solver=sagæ—¶ä½¿ç”¨ å¦‚æžœä¸ºæ•´æ•°ï¼Œåˆ™å®ƒæŒ‡å®šäº†éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ å¦‚æžœä¸ºRandomStateå®žä¾‹ï¼Œåˆ™æŒ‡å®šä¾‹éšæœºæ•°ç”Ÿæˆå™¨ å¦‚æžœä¸ºNoneï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„éšæœºæ•°ç”Ÿæˆå™¨ å±žæ€§ coef_: æƒé‡å‘é‡ intercept_: bå€¼ n_iter_: å®žé™…è¿­ä»£æ¬¡æ•° æ–¹æ³• fit(X, y[, sample_weight]): è®­ç»ƒæ¨¡åž‹ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ score(X, y[, sample_weight]): è¿”å›žé¢„æµ‹æ€§èƒ½å¾—åˆ† è®¾é¢„æµ‹é›†ä¸º\(T_{test}\)ï¼ŒçœŸå®žå€¼ä¸º\(y_i\)ï¼ŒçœŸå®žå€¼çš„å‡å€¼ä¸º\(\overline{y}\)ï¼Œé¢„æµ‹å€¼ä¸º\(\hat{y}_i\)ï¼Œåˆ™ï¼š\[score=1-\frac{\sum_{T_{test}}(y_i-\hat{y}_i)^2}{(y_i-\overline{y})^2}\] scoreä¸è¶…è¿‡1ï¼Œä½†æ˜¯å¯èƒ½ä¸ºè´Ÿå€¼ï¼ˆé¢„æµ‹æ•ˆæžœå¤ªå·®ï¼‰ã€‚ scoreè¶Šå¤§ï¼Œé¢„æµ‹æ€§èƒ½è¶Šå¥½ã€‚ 12345678910111213def demo_Ridge(*data): &quot;&quot;&quot; ä½¿ç”¨Ridgeå‡½æ•° :param data: è®­ç»ƒæ ·æœ¬é›†ã€æµ‹è¯•æ ·æœ¬é›†ã€è®­ç»ƒæ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ã€æµ‹è¯•æ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ :return: æƒé‡å‘é‡ã€bå€¼ï¼Œé¢„æµ‹ç»“æžœçš„å‡æ–¹è¯¯å·®ï¼Œé¢„æµ‹æ€§èƒ½å¾—åˆ† &quot;&quot;&quot; X_train, X_test, y_train, y_test = data regr = linear_model.Ridge() regr.fit(X_train, y_train) print(&apos;Coefficients: %s&apos; % regr.coef_) print(&apos;Intercept: %.2f&apos; % regr.intercept_) print(&apos;Residual sum of squares: %.2f&apos; % np.mean((regr.predict(X_test) - y_test) ** 2)) print(&apos;Score: %.2f&apos; % regr.score(X_test, y_test)) è¯¥å‡½æ•°ç®€å•åœ°ä»Žè®­ç»ƒæ•°æ®é›†ä¸­å­¦ä¹ ï¼Œç„¶åŽä»Žæµ‹è¯•æ•°æ®é›†ä¸­é¢„æµ‹ã€‚è¿™é‡Œçš„Ridgeçš„æ‰€æœ‰å‚æ•°éƒ½é‡‡ç”¨é»˜è®¤å€¼ã€‚è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_Ridge(X_train, X_test, y_train, y_test) è¾“å‡ºç»“æžœå¦‚ä¸‹ï¼š 12345Coefficients: [ 21.19927911 -60.47711393 302.87575204 179.41206395 8.90911449 -28.8080548 -149.30722541 112.67185758 250.53760873 99.57749017]Intercept: 152.45Residual sum of squares: 3192.33Score: 0.36 å¯ä»¥çœ‹åˆ°æµ‹è¯•é›†ä¸­é¢„æµ‹ç»“æžœçš„å‡æ–¹è¯¯å·®ä¸º3192.33ï¼Œé¢„æµ‹æ€§èƒ½å¾—åˆ†ä»…ä¸º0.36ã€‚ ä¸‹é¢æ£€éªŒä¸åŒçš„\(\alpha\)å€¼å¯¹äºŽé¢„æµ‹æ€§èƒ½çš„å½±å“ï¼Œç»™å‡ºæµ‹è¯•å‡½æ•°ï¼š 1234567891011121314151617def demo_Ridge_alpha(*data): X_train, X_test, y_train, y_test = data alphas = [0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1, 2, 5, 10, 20, 50, 100, 200, 500, 1000] scores = [] for i, alpha in enumerate(alphas): regr = linear_model.Ridge(alpha=alpha) regr.fit(X_train, y_train) scores.append(regr.score(X_test, y_test)) ## ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) ax.plot(alphas, scores) ax.set_xlabel(r&quot;$\alpha$&quot;) ax.set_ylabel(r&quot;score&quot;) ax.set_xscale(&apos;log&apos;) ax.set_title(&quot;Ridge&quot;) plt.show() ä¸ºäº†ä¾¿äºŽè§‚å¯Ÿç»“æžœï¼Œå°†\(x\)è½´è®¾ç½®ä¸ºäº†å¯¹æ•°åæ ‡ã€‚è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_Ridge_alpha(X_train, X_test, y_train, y_test) è¾“å‡ºç»“æžœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¯ä»¥çœ‹åˆ°ï¼Œå½“\(\alpha\)è¶…è¿‡1ä¹‹åŽï¼Œéšç€\(\alpha\)çš„å¢žé•¿ï¼Œé¢„æµ‹æ€§èƒ½æ€¥å‰§ä¸‹é™ã€‚è¿™æ˜¯å› ä¸º\(\alpha\)è¾ƒå¤§æ—¶ï¼Œæ­£åˆ™åŒ–é¡¹å½±å“è¾ƒå¤§ï¼Œæ¨¡åž‹è¶‹äºŽç®€å•ã€‚ Lassoå›žå½’ Lassoå›žå½’å’Œå²­å›žå½’çš„åŒºåˆ«å°±åœ¨äºŽå®ƒçš„æƒ©ç½šé¡¹æ˜¯åŸºäºŽL1èŒƒæ•°ï¼Œå› æ­¤å®ƒå¯ä»¥å°†ç³»æ•°æŽ§åˆ¶æ”¶ç¼©åˆ°0ï¼Œä»Žè€Œè¾¾åˆ°å˜é‡é€‰æ‹©çš„æ•ˆæžœã€‚Lassoç±»å®žçŽ°äº†Lassoå›žå½’æ¨¡åž‹ï¼š 1234class sklearn.linear_model.Lasso(alpha=1.0, fit_intercept=True, normalize=False, precompute=False, copy_X=True, max_iter=1000, tol=1e-4, warm_start=False, positive=False, random_state=None, selection=&apos;cyclic&apos;) å‚æ•° alpha: \(\alpha\)å€¼ï¼Œå…¶å€¼è¶Šå¤§åˆ™æ­£åˆ™åŒ–é¡¹çš„å æ¯”è¶Šå¤§ã€‚ fit_intercept: booleanï¼ŒæŒ‡å®šæ˜¯å¦éœ€è¦è®¡ç®—bå€¼ã€‚ max_iter: ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šæœ€å¤§è¿­ä»£æ¬¡æ•°ã€‚å¦‚æžœä¸ºNoneåˆ™ä¸ºé»˜è®¤å€¼ï¼Œä¸åŒsolverçš„é»˜è®¤å€¼ä¸åŒã€‚ normalize: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œé‚£ä¹ˆè®­ç»ƒæ ·æœ¬ä¼šåœ¨å›žå½’ä¹‹å‰è¢«å½’ä¸€åŒ–ã€‚ copy_X: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œåˆ™ä¼šå¤åˆ¶Xã€‚ precompute: boolean/åºåˆ—ã€‚å†³å®šæ˜¯å¦æå‰è®¡ç®—GramçŸ©é˜µæ¥åŠ é€Ÿè®¡ç®—ã€‚ tol: ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ŒæŒ‡å®šåˆ¤æ–­è¿­ä»£æ”¶æ•›ä¸Žå¦çš„é˜ˆå€¼ã€‚ warm_start: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œé‚£ä¹ˆä½¿ç”¨å‰ä¸€æ¬¡è®­ç»ƒç»“æžœç»§ç»­è®­ç»ƒã€‚å¦åˆ™ä»Žå¤´å¼€å§‹è®­ç»ƒã€‚ positive: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œé‚£ä¹ˆå¼ºåˆ¶è¦æ±‚æƒé‡å‘é‡çš„åˆ†é‡éƒ½ä¸ºæ­£æ•°ã€‚ selection: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šäº†æ¯è½®è¿­ä»£æ—¶é€‰æ‹©æƒé‡å‘é‡çš„å“ªä¸ªåˆ†é‡æ¥æ›´æ–°ã€‚ random: éšæœºé€‰æ‹©æƒé‡å‘é‡çš„ä¸€ä¸ªåˆ†é‡æ¥æ›´æ–° cyclic: ä»Žå‰å‘åŽä¾æ¬¡é€‰æ‹©æƒé‡å‘é‡çš„ä¸€ä¸ªåˆ†é‡æ¥æ›´æ–° random_state: ä¸€ä¸ªæ•´æ•°æˆ–è€…ä¸€ä¸ªRandomStateå®žä¾‹ï¼Œæˆ–è€…Noneï¼›åœ¨solver=sagæ—¶ä½¿ç”¨ å¦‚æžœä¸ºæ•´æ•°ï¼Œåˆ™å®ƒæŒ‡å®šäº†éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ å¦‚æžœä¸ºRandomStateå®žä¾‹ï¼Œåˆ™æŒ‡å®šä¾‹éšæœºæ•°ç”Ÿæˆå™¨ å¦‚æžœä¸ºNoneï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„éšæœºæ•°ç”Ÿæˆå™¨ å±žæ€§ coef_: æƒé‡å‘é‡ intercept_: bå€¼ n_iter_: å®žé™…è¿­ä»£æ¬¡æ•° æ–¹æ³• fit(X, y[, sample_weight]): è®­ç»ƒæ¨¡åž‹ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ score(X, y[, sample_weight]): è¿”å›žé¢„æµ‹æ€§èƒ½å¾—åˆ† è®¾é¢„æµ‹é›†ä¸º\(T_{test}\)ï¼ŒçœŸå®žå€¼ä¸º\(y_i\)ï¼ŒçœŸå®žå€¼çš„å‡å€¼ä¸º\(\overline{y}\)ï¼Œé¢„æµ‹å€¼ä¸º\(\hat{y}_i\)ï¼Œåˆ™ï¼š\[score=1-\frac{\sum_{T_{test}}(y_i-\hat{y}_i)^2}{(y_i-\overline{y})^2}\] scoreä¸è¶…è¿‡1ï¼Œä½†æ˜¯å¯èƒ½ä¸ºè´Ÿå€¼ï¼ˆé¢„æµ‹æ•ˆæžœå¤ªå·®ï¼‰ã€‚ scoreè¶Šå¤§ï¼Œé¢„æµ‹æ€§èƒ½è¶Šå¥½ã€‚ 12345678910111213def demo_Lasso(*data): &quot;&quot;&quot; ä½¿ç”¨Lassoå‡½æ•° :param data: è®­ç»ƒæ ·æœ¬é›†ã€æµ‹è¯•æ ·æœ¬é›†ã€è®­ç»ƒæ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ã€æµ‹è¯•æ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ :return: æƒé‡å‘é‡ã€bå€¼ï¼Œé¢„æµ‹ç»“æžœçš„å‡æ–¹è¯¯å·®ï¼Œé¢„æµ‹æ€§èƒ½å¾—åˆ† &quot;&quot;&quot; X_train, X_test, y_train, y_test = data regr = linear_model.Lasso() regr.fit(X_train, y_train) print(&apos;Coefficients: %s&apos; % regr.coef_) print(&apos;Intercept: %.2f&apos; % regr.intercept_) print(&apos;Residual sum of squares: %.2f&apos; % np.mean((regr.predict(X_test) - y_test) ** 2)) print(&apos;Score: %.2f&apos; % regr.score(X_test, y_test)) è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_Lasso(X_train, X_test, y_train, y_test) è¾“å‡ºç»“æžœï¼š 12345Coefficients: [ 0. -0. 442.67992538 0. 0. 0. -0. 0. 330.76014648 0. ]Intercept: 152.52Residual sum of squares: 3583.42Score: 0.28 ä¸‹é¢æ£€éªŒä¸åŒçš„\(\alpha\)å€¼å¯¹äºŽé¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 1234567891011121314151617def demo_Lasso_alpha(*data): X_train, X_test, y_train, y_test = data alphas = [0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1, 2, 5, 10, 20, 50, 100, 200, 500, 1000] scores = [] for i, alpha in enumerate(alphas): regr = linear_model.Lasso(alpha=alpha) regr.fit(X_train, y_train) scores.append(regr.score(X_test, y_test)) ## ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) ax.plot(alphas, scores) ax.set_xlabel(r&quot;$\alpha$&quot;) ax.set_ylabel(r&quot;score&quot;) ax.set_xscale(&apos;log&apos;) ax.set_title(&quot;Lasso&quot;) plt.show() è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_Lasso_alpha(X_train, X_test, y_train, y_test) è¾“å‡ºç»“æžœå¦‚ä¸‹ï¼š å¯ä»¥çœ‹å‡ºï¼Œå½“\(\alpha\)è¶…è¿‡1ä¹‹åŽï¼Œéšç€\(\alpha\)çš„å¢žé•¿ï¼Œé¢„æµ‹æ€§èƒ½æ€¥å‰§ä¸‹é™ã€‚ ElasticNetå›žå½’ ElasticNetå›žå½’æ˜¯å¯¹Lassoå›žå½’å’Œå²­å›žå½’çš„èžåˆï¼Œå…¶æƒ©ç½šé¡¹æ˜¯L1èŒƒæ•°å’ŒL2èŒƒæ•°çš„ä¸€ä¸ªæƒè¡¡ã€‚ElasticNetç±»å®žçŽ°äº†ElasticNetå›žå½’ï¼š 1234class sklearn.linear_model.ElasticNet(alpha=1.0, l1_ratio=0.5, fit_intercept=True, normalize=False, precompute=False, max_iter=1000, copy_X=True, tol=1e-4, warm_start=False, positive=False, random_state=None, selection=&apos;cyclic&apos;) å‚æ•° alpha: \(\alpha\)å€¼ã€‚ l1_ratio: \(\rho\)å€¼ã€‚ fit_intercept: booleanï¼ŒæŒ‡å®šæ˜¯å¦éœ€è¦è®¡ç®—bå€¼ã€‚ max_iter: ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šæœ€å¤§è¿­ä»£æ¬¡æ•°ã€‚å¦‚æžœä¸ºNoneåˆ™ä¸ºé»˜è®¤å€¼ï¼Œä¸åŒsolverçš„é»˜è®¤å€¼ä¸åŒã€‚ normalize: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œé‚£ä¹ˆè®­ç»ƒæ ·æœ¬ä¼šåœ¨å›žå½’ä¹‹å‰è¢«å½’ä¸€åŒ–ã€‚ copy_X: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œåˆ™ä¼šå¤åˆ¶Xã€‚ precompute: boolean/åºåˆ—ã€‚å†³å®šæ˜¯å¦æå‰è®¡ç®—GramçŸ©é˜µæ¥åŠ é€Ÿè®¡ç®—ã€‚ tol: ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ŒæŒ‡å®šåˆ¤æ–­è¿­ä»£æ”¶æ•›ä¸Žå¦çš„é˜ˆå€¼ã€‚ warm_start: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œé‚£ä¹ˆä½¿ç”¨å‰ä¸€æ¬¡è®­ç»ƒç»“æžœç»§ç»­è®­ç»ƒã€‚å¦åˆ™ä»Žå¤´å¼€å§‹è®­ç»ƒã€‚ positive: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œé‚£ä¹ˆå¼ºåˆ¶è¦æ±‚æƒé‡å‘é‡çš„åˆ†é‡éƒ½ä¸ºæ­£æ•°ã€‚ selection: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šäº†æ¯è½®è¿­ä»£æ—¶é€‰æ‹©æƒé‡å‘é‡çš„å“ªä¸ªåˆ†é‡æ¥æ›´æ–°ã€‚ random: éšæœºé€‰æ‹©æƒé‡å‘é‡çš„ä¸€ä¸ªåˆ†é‡æ¥æ›´æ–° cyclic: ä»Žå‰å‘åŽä¾æ¬¡é€‰æ‹©æƒé‡å‘é‡çš„ä¸€ä¸ªåˆ†é‡æ¥æ›´æ–° random_state: ä¸€ä¸ªæ•´æ•°æˆ–è€…ä¸€ä¸ªRandomStateå®žä¾‹ï¼Œæˆ–è€…Noneï¼›åœ¨solver=sagæ—¶ä½¿ç”¨ å¦‚æžœä¸ºæ•´æ•°ï¼Œåˆ™å®ƒæŒ‡å®šäº†éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ å¦‚æžœä¸ºRandomStateå®žä¾‹ï¼Œåˆ™æŒ‡å®šä¾‹éšæœºæ•°ç”Ÿæˆå™¨ å¦‚æžœä¸ºNoneï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„éšæœºæ•°ç”Ÿæˆå™¨ å±žæ€§ coef_: æƒé‡å‘é‡ intercept_: bå€¼ n_iter_: å®žé™…è¿­ä»£æ¬¡æ•° æ–¹æ³• fit(X, y[, sample_weight]): è®­ç»ƒæ¨¡åž‹ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ score(X, y[, sample_weight]): è¿”å›žé¢„æµ‹æ€§èƒ½å¾—åˆ† è®¾é¢„æµ‹é›†ä¸º\(T_{test}\)ï¼ŒçœŸå®žå€¼ä¸º\(y_i\)ï¼ŒçœŸå®žå€¼çš„å‡å€¼ä¸º\(\overline{y}\)ï¼Œé¢„æµ‹å€¼ä¸º\(\hat{y}_i\)ï¼Œåˆ™ï¼š\[score=1-\frac{\sum_{T_{test}}(y_i-\hat{y}_i)^2}{(y_i-\overline{y})^2}\] scoreä¸è¶…è¿‡1ï¼Œä½†æ˜¯å¯èƒ½ä¸ºè´Ÿå€¼ï¼ˆé¢„æµ‹æ•ˆæžœå¤ªå·®ï¼‰ã€‚ scoreè¶Šå¤§ï¼Œé¢„æµ‹æ€§èƒ½è¶Šå¥½ã€‚ 12345678910111213def demo_ElasticNet(*data): &quot;&quot;&quot; ä½¿ç”¨ElasticNetå‡½æ•° :param data: è®­ç»ƒæ ·æœ¬é›†ã€æµ‹è¯•æ ·æœ¬é›†ã€è®­ç»ƒæ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ã€æµ‹è¯•æ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ :return: æƒé‡å‘é‡ã€bå€¼ï¼Œé¢„æµ‹ç»“æžœçš„å‡æ–¹è¯¯å·®ï¼Œé¢„æµ‹æ€§èƒ½å¾—åˆ† &quot;&quot;&quot; X_train, X_test, y_train, y_test = data regr = linear_model.ElasticNet() regr.fit(X_train, y_train) print(&apos;Coefficients: %s&apos; % regr.coef_) print(&apos;Intercept: %.2f&apos; % regr.intercept_) print(&apos;Residual sum of squares: %.2f&apos; % np.mean((regr.predict(X_test) - y_test) ** 2)) print(&apos;Score: %.2f&apos; % regr.score(X_test, y_test)) è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_ElasticNet(X_train, X_test, y_train, y_test) è¾“å‡ºç»“æžœå¦‚ä¸‹ï¼š 12345Coefficients: [ 0.40560736 0. 3.76542456 2.38531508 0.58677945 0.22891647 -2.15858149 2.33867566 3.49846121 1.98299707]Intercept: 151.93Residual sum of squares: 4922.36Score: 0.01 ä¸‹é¢æ£€éªŒä¸åŒ$,$å€¼å¯¹é¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 12from mpl_toolkits.mplot3d import Axes3Dfrom matplotlib import cm 12345678910111213141516171819202122def demo_ElasticNet_alpha_rho(*data): X_train, X_test, y_train, y_test = data alphas = np.logspace(-2, 2) rhos = np.linspace(0.01, 1) scores = [] for alpha in alphas: for rho in rhos: regr = linear_model.ElasticNet(alpha=alpha, l1_ratio=rho) regr.fit(X_train, y_train) scores.append(regr.score(X_test, y_test)) ## ç»˜å›¾ alphas, rhos = np.meshgrid(alphas, rhos) scores = np.array(scores).reshape(alphas.shape) fig = plt.figure() ax = Axes3D(fig) surf = ax.plot_surface(alphas, rhos, scores, rstride=1, cstride=1, cmap=cm.jet, linewidth=0, antialiased=False) fig.colorbar(surf, shrink=0.5, aspect=5) ax.set_xlabel(r&quot;$\alpha$&quot;) ax.set_ylabel(r&quot;$\rho$&quot;) ax.set_zlabel(&quot;score&quot;) ax.set_title(&quot;ElasticNet&quot;) plt.show() è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_ElasticNet_alpha_rho(X_train, X_test, y_train, y_test) è¾“å‡ºç»“æžœå¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°éšç€\(\alpha\)çš„å¢žå¤§ï¼Œé¢„æµ‹æ€§èƒ½ä¸‹é™ï¼Œè€Œ\(\rho\)å½±å“çš„æ˜¯æ€§èƒ½ä¸‹é™çš„é€Ÿåº¦ã€‚ é€»è¾‘å›žå½’ åœ¨scikit-learnä¸­ï¼ŒLogisticRegressionå®žçŽ°äº†é€»è¾‘å›žå½’åŠŸèƒ½ï¼š 12345class sklearn.linear_model.LogisticRegression(penalty=&apos;l2&apos;, dual=False, tol=0.0001, C=1.0, fit_intercept=True, intercept_scaling=1, class_weight=None, random_state=None, solver=&apos;warn&apos;, max_iter=100, multi_class=&apos;warn&apos;, verbose=0, warm_start=False, n_jobs=None, l1_ratio=None) å‚æ•° penalty: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šäº†æ­£åˆ™åŒ–ç­–ç•¥ l2: åˆ™ä¼˜åŒ–ç›®æ ‡å‡½æ•°ä¸ºï¼š\(\frac{1}{2}||\vec{w}||_2^2+CL(\vec{w}),C&gt;0\)ï¼Œ\(L(\vec{w})\)ä¸ºæžå¤§ä¼¼ç„¶å‡½æ•° l1: åˆ™ä¼˜åŒ–ç›®æ ‡å‡½æ•°ä¸ºï¼š\(||\vec{w}||_1 +CL(\vec{w}),C&gt;0\)ï¼Œ\(L(\vec{w})\)ä¸ºæžå¤§ä¼¼ç„¶å‡½æ•° dual: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œåˆ™æ±‚è§£å¯¹å¶å½¢å¼ï¼ˆåªåœ¨penalty='l2'ä¸”solver='liblinear'æœ‰å¯¹å¶å½¢å¼ï¼‰ï¼›å¦‚æžœä¸ºFalseï¼Œåˆ™æ±‚è§£åŽŸå§‹å½¢å¼ã€‚ C: ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ŒæŒ‡å®šäº†ç½šé¡¹ç³»æ•°çš„å€’æ•°ï¼Œå€¼è¶Šå°æ­£åˆ™åŒ–é¡¹è¶Šå¤§ã€‚ fit_intercept: booleanï¼ŒæŒ‡å®šæ˜¯å¦éœ€è¦è®¡ç®—bå€¼ã€‚ intercept_scaling: ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œåªå½“solver='liblinear'æ—¶æœ‰æ„ä¹‰ã€‚å½“é‡‡ç”¨fit_interceptæ—¶ï¼Œç›¸å½“äºŽäººé€ ä¸€ä¸ªç‰¹å¾å‡ºæ¥ï¼Œè¯¥ç‰¹å¾æ’ä¸º1ï¼Œå…¶æƒé‡ä¸ºbã€‚åœ¨è®¡ç®—æ­£åˆ™åŒ–é¡¹æ—¶ï¼Œè¯¥äººé€ ç‰¹å¾ä¹Ÿè¢«è€ƒè™‘äº†ï¼Œå› æ­¤ä¸ºäº†é™ä½Žè¿™ä¸ªäººé€ ç‰¹å¾çš„å½±å“ï¼Œéœ€è¦æä¾›intercept_scalingã€‚ class_weight: ä¸€ä¸ªå­—å…¸æˆ–è€…å­—ç¬¦ä¸² å­—å…¸ï¼šå­—å…¸ç»™å‡ºæ¯ä¸ªåˆ†ç±»çš„æƒé‡ï¼Œå¦‚{class_label: weight} â€˜balanced'ï¼šæ¯ä¸ªåˆ†ç±»çš„æƒé‡ä¸Žè¯¥åˆ†ç±»åœ¨æ ·æœ¬é›†ä¸­å‡ºçŽ°çš„é¢‘çŽ‡æˆåæ¯” æœªæŒ‡å®šï¼šæ¯ä¸ªåˆ†ç±»çš„æƒé‡éƒ½ä¸º1 max_iter: ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šæœ€å¤§è¿­ä»£æ¬¡æ•°ã€‚ random_state: ä¸€ä¸ªæ•´æ•°æˆ–è€…ä¸€ä¸ªRandomStateå®žä¾‹ï¼Œæˆ–è€…Noneï¼›åœ¨solver=sagæ—¶ä½¿ç”¨ å¦‚æžœä¸ºæ•´æ•°ï¼Œåˆ™å®ƒæŒ‡å®šäº†éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ å¦‚æžœä¸ºRandomStateå®žä¾‹ï¼Œåˆ™æŒ‡å®šä¾‹éšæœºæ•°ç”Ÿæˆå™¨ å¦‚æžœä¸ºNoneï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„éšæœºæ•°ç”Ÿæˆå™¨ solver: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šäº†æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜çš„ç®—æ³• newton-cg: ä½¿ç”¨ç‰›é¡¿æ³•ï¼Œåªå¤„ç†penalty='l2'çš„æƒ…å†µ lbfgs: ä½¿ç”¨L-BFGSæ‹Ÿç‰›é¡¿æ³•ï¼Œåªå¤„ç†penalty='l2'çš„æƒ…å†µ liblinear: ä½¿ç”¨liblinearï¼Œé€‚ç”¨è§„æ¨¡å°çš„æ•°æ®é›† sag: ä½¿ç”¨Stochastic Average Gradient descentç®—æ³•ï¼Œé€‚ç”¨è§„æ¨¡å¤§çš„æ•°æ®é›†ï¼Œåªå¤„ç†penalty='l2'çš„æƒ…å†µ tol: ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ŒæŒ‡å®šåˆ¤æ–­è¿­ä»£æ”¶æ•›ä¸Žå¦çš„é˜ˆå€¼ã€‚ multi_class: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šå¯¹äºŽå¤šåˆ†ç±»é—®é¢˜çš„ç­–ç•¥ ovr: é‡‡ç”¨one-vs-restç­–ç•¥ multinomial: ç›´æŽ¥é‡‡ç”¨å¤šåˆ†ç±»é€»è¾‘å›žå½’ç­–ç•¥ verbose: ä¸€ä¸ªæ­£æ•°ï¼Œç”¨äºŽå¼€å¯/å…³é—­è¿­ä»£ä¸­é—´è¾“å‡ºæ—¥å¿—åŠŸèƒ½ã€‚ warm_start: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œé‚£ä¹ˆä½¿ç”¨å‰ä¸€æ¬¡è®­ç»ƒç»“æžœç»§ç»­è®­ç»ƒã€‚å¦åˆ™ä»Žå¤´å¼€å§‹è®­ç»ƒã€‚ n_jobs: ä¸€ä¸ªæ­£æ•°ï¼ŒæŒ‡å®šä»»åŠ¡å¹¶è¡Œæ—¶çš„CPUæ•°é‡ã€‚å¦‚æžœä¸º-1åˆ™ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„CPUã€‚ å±žæ€§ coef_: æƒé‡å‘é‡ intercept_: bå€¼ n_iter_: å®žé™…è¿­ä»£æ¬¡æ•° æ–¹æ³• fit(X, y[, sample_weight]): è®­ç»ƒæ¨¡åž‹ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ predict_log_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡çš„å¯¹æ•°å€¼ predict_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡å€¼ score(X, y[, sample_weight]): è¿”å›žåœ¨(X, y)ä¸Šé¢„æµ‹çš„å‡†ç¡®çŽ‡ ä¸ºäº†ä½¿ç”¨é€»è¾‘å›žå½’æ¨¡åž‹ï¼Œæˆ‘ä»¬å¯¹é¸¢å°¾èŠ±è¿›è¡Œåˆ†ç±»ã€‚è¯¥æ•°æ®é›†ä¸€å…±æœ‰150ä¸ªæ•°æ®ï¼Œè¿™äº›æ•°æ®åˆ†ä¸º3ç±»(setosa, versicolor, virginica)ï¼Œæ¯ç±»50ä¸ªæ•°æ®ã€‚æ¯ä¸ªæ•°æ®åŒ…å«4ä¸ªå±žæ€§ï¼šsepalé•¿åº¦ã€sepalå®½åº¦ã€petalé•¿åº¦ã€petalå®½åº¦ é¦–å…ˆåŠ è½½æ•°æ®ï¼š 123456789def load_data(): &quot;&quot;&quot; é‡‡ç”¨åˆ†å±‚é‡‡æ · :return: &quot;&quot;&quot; iris = datasets.load_iris() X_train = iris.data y_train = iris.target return model_selection.train_test_split(X_train, y_train, test_size=0.25, random_state=0, stratify=y_train) 123456789101112def demo_LogisticRegression(*data): &quot;&quot;&quot; ä½¿ç”¨LogisticRegressionå‡½æ•° :param data: è®­ç»ƒæ ·æœ¬é›†ã€æµ‹è¯•æ ·æœ¬é›†ã€è®­ç»ƒæ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ã€æµ‹è¯•æ ·æœ¬é›†å¯¹åº”çš„æ ‡ç­¾å€¼ :return: æƒé‡å‘é‡ã€bå€¼ï¼Œé¢„æµ‹æ€§èƒ½å¾—åˆ† &quot;&quot;&quot; X_train, X_test, y_train, y_test = data regr = linear_model.LogisticRegression() regr.fit(X_train, y_train) print(&apos;Coefficients: %s&apos; % regr.coef_) print(&apos;Intercept: %s&apos; % regr.intercept_) print(&apos;Score: %.2f&apos; % regr.score(X_test, y_test)) è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_LogisticRegression(X_train, X_test, y_train, y_test) è¾“å‡ºç»“æžœï¼š 12345Coefficients: [[ 0.38705175 1.35839989 -2.12059692 -0.95444452] [ 0.23787852 -1.36235758 0.5982662 -1.26506299] [-1.50915807 -1.29436243 2.14148142 2.29611791]]Intercept: [ 0.23950369 1.14559506 -1.0941717 ]Score: 0.97 å¯ä»¥çœ‹åˆ°æµ‹è¯•é›†ä¸­çš„é¢„æµ‹ç»“æžœæ€§èƒ½å¾—åˆ†ä¸º0.97ï¼ˆå³é¢„æµ‹å‡†ç¡®çŽ‡ä¸º97%ï¼‰ã€‚ ä¸‹é¢è€ƒå¯Ÿmulti_classå‚æ•°å¯¹åˆ†ç±»ç»“æžœçš„å½±å“ã€‚é»˜è®¤é‡‡ç”¨çš„æ˜¯one-vs-restç­–ç•¥ï¼Œä½†æ˜¯é€»è¾‘å›žå½’æ¨¡åž‹åŽŸç”Ÿå°±æ”¯æŒå¤šç±»åˆ†ç±»ï¼š 1234567def demo_LogisticRegression_multinomial(*data): X_train, X_test, y_train, y_test = data regr = linear_model.LogisticRegression(multi_class=&apos;multinomial&apos;, solver=&apos;lbfgs&apos;) regr.fit(X_train, y_train) print(&apos;Coefficients: %s&apos; % regr.coef_) print(&apos;Intercept: %s&apos; % regr.intercept_) print(&apos;Score: %.2f&apos; % regr.score(X_test, y_test)) åªæœ‰solverä¸ºç‰›é¡¿æ³•æˆ–è€…æ‹Ÿç‰›é¡¿æ³•æ‰èƒ½é…åˆmulti_class='multinomial' è°ƒç”¨è¯¥å‡½æ•°ï¼š 12X_train, X_test, y_train, y_test = load_data()demo_LogisticRegression_multinomial(X_train, X_test, y_train, y_test) ç»“æžœå¦‚ä¸‹ï¼š 12345Coefficients: [[-0.38350833 0.86199769 -2.26970401 -0.97473472] [ 0.34381965 -0.37903699 -0.03117965 -0.86837866] [ 0.03968868 -0.4829607 2.30088366 1.84311338]]Intercept: [ 8.75772577 2.49369071 -11.25141648]Score: 1.00 å¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œå¤šåˆ†ç±»ç­–ç•¥è¿›ä¸€æ­¥æå‡äº†é¢„æµ‹å‡†ç¡®çŽ‡ã€‚ æœ€åŽï¼Œè€ƒå¯Ÿå‚æ•°Cå¯¹åˆ†ç±»æ¨¡åž‹çš„é¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 1234567891011121314151617def demo_LogisticRegression_C(*data): X_train, X_test, y_train, y_test = data Cs = np.logspace(-2, 4, num=100) scores = [] for C in Cs: regr = linear_model.LogisticRegression(C=C) regr.fit(X_train, y_train) scores.append(regr.score(X_test, y_test)) # ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) ax.plot(Cs, scores) ax.set_xlabel(r&quot;C&quot;) ax.set_ylabel(r&quot;score&quot;) ax.set_xscale(&apos;log&apos;) ax.set_title(&quot;LogisticRegression&quot;) plt.show() æµ‹è¯•ç»“æžœå¦‚ä¸‹å›¾ï¼š å¯ä»¥çœ‹åˆ°éšç€Cçš„å¢žå¤§ï¼ˆå³æ­£åˆ™åŒ–é¡¹çš„å‡å°ï¼‰ï¼Œé¢„æµ‹å‡†ç¡®çŽ‡ä¸Šå‡ã€‚å½“Cå¢žå¤§åˆ°ä¸€å®šç¨‹åº¦ï¼Œé¢„æµ‹å‡†ç¡®çŽ‡ç»´æŒåœ¨è¾ƒé«˜çš„æ°´å‡†ä¸å˜ã€‚ çº¿æ€§åˆ¤åˆ«åˆ†æž åœ¨scikit-learnä¸­ï¼ŒLinearDiscriminantAnalysiså®žçŽ°äº†çº¿æ€§åˆ¤åˆ«åˆ†æžæ¨¡åž‹ï¼š 123class sklearn.discriminant_analysis.LinearDiscriminantAnalysis( solver=&apos;svd&apos;, shrinkage=None, priors=None, n_components=None, store_covariance=False, tol=0.0001) å‚æ•° solver: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šæ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜çš„ç®—æ³• svd: å¥‡å¼‚å€¼åˆ†è§£ï¼Œå¯¹äºŽæœ‰å¤§è§„æ¨¡ç‰¹å¾çš„æ•°æ®ï¼ŒæŽ¨èä½¿ç”¨ lsqr: æœ€å°å¹³æ–¹å·®ç®—æ³•ï¼Œå¯ä»¥ç»“åˆshrinkageå‚æ•° eigen: ç‰¹å¾å€¼åˆ†è§£ç®—æ³•ï¼Œå¯ä»¥ç»“åˆshrinkageå‚æ•° shrinkage: é€šå¸¸åœ¨è®­ç»ƒæ ·æœ¬æ•°é‡å°äºŽç‰¹å¾æ•°é‡åœºåˆä¸‹ä½¿ç”¨ï¼Œåªæœ‰åœ¨solver=lsqræˆ–è€…eigenä¸‹æœ‰æ„ä¹‰ 'auto': æ ¹æ®Ledoit-Wolfå¼•ç†æ¥è‡ªåŠ¨å†³å®šshrinkageå‚æ•°å¤§å° None: ä¸ä½¿ç”¨è¯¥å‚æ•° æµ®ç‚¹æ•°(0~1): æŒ‡å®šå‚æ•° priors: ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­å…ƒç´ ä¾æ¬¡æŒ‡å®šäº†æ¯ä¸ªç±»åˆ«çš„å…ˆéªŒæ¦‚çŽ‡ã€‚å¦‚æžœä¸ºNoneï¼Œåˆ™è®¤ä¸ºæ¯ä¸ªç±»çš„å…ˆéªŒæ¦‚çŽ‡éƒ½æ˜¯ç­‰å¯èƒ½çš„ã€‚ n_components: ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šäº†æ•°æ®é™ç»´åŽçš„ç»´åº¦(å¿…é¡»å°äºŽn_classes-1)ã€‚ store_covariance: booleanï¼Œå¦‚æžœä¸ºTrueï¼Œåˆ™éœ€è¦é¢å¤–è®¡ç®—æ¯ä¸ªç±»åˆ«çš„åæ–¹å·®çŸ©é˜µ\(\sum_i\)ã€‚ tol: ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ŒæŒ‡å®šäº†ç”¨äºŽSVDç®—æ³•ä¸­åˆ¤æ–­è¿­ä»£æ”¶æ•›çš„é˜ˆå€¼ã€‚ å±žæ€§ coef_: æƒé‡å‘é‡ intercept_: bå€¼ covariance_: ä¸€ä¸ªæ•°ç»„ï¼Œä¾æ¬¡ç»™å‡ºäº†æ¯ä¸ªç±»åˆ«çš„åæ–¹å·®çŸ©é˜µ means_: ä¸€ä¸ªæ•°ç»„ï¼Œä¾æ¬¡ç»™å‡ºäº†æ¯ä¸ªç±»åˆ«çš„å‡å€¼å‘é‡ xbar_: ç»™å‡ºæ•´ä½“æ ·æœ¬çš„å‡å€¼å‘é‡ n_iter_: å®žé™…è¿­ä»£æ¬¡æ•° æ–¹æ³• fit(X, y): è®­ç»ƒæ¨¡åž‹ predict(X): ç”¨æ¨¡åž‹è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›žé¢„æµ‹å€¼ predict_log_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡çš„å¯¹æ•°å€¼ predict_proba(X): è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ˜¯Xé¢„æµ‹ä¸ºå„ä¸ªç±»åˆ«çš„æ¦‚çŽ‡å€¼ score(X, y[, sample_weight]): è¿”å›žåœ¨(X, y)ä¸Šé¢„æµ‹çš„å‡†ç¡®çŽ‡ ä¾æ—§ä½¿ç”¨é¸¢å°¾èŠ±æ•°æ®é›†ï¼š 1234567def demo_LinearDiscriminantAnalysis(*data): X_train, X_test, y_train, y_test = data lda = discriminant_analysis.LinearDiscriminantAnalysis() lda.fit(X_train, y_train) print(&apos;Coefficients: %s&apos; % lda.coef_) print(&apos;Intercept: %s&apos; % lda.intercept_) print(&apos;Score: %.2f&apos; % lda.score(X_test, y_test)) ç»“æžœå¦‚ä¸‹ï¼š 12345Coefficients: [[ 6.66775427 9.63817442 -14.4828516 -20.9501241 ] [ -2.00416487 -3.51569814 4.27687513 2.44146469] [ -4.54086336 -5.96135848 9.93739814 18.02158943]]Intercept: [-15.46769144 0.60345075 -30.41543234]Score: 1.00 çŽ°åœ¨æ¥æ£€æŸ¥ä¸€ä¸‹åŽŸå§‹æ•°æ®é›†åœ¨ç»è¿‡çº¿æ€§åˆ¤åˆ«åˆ†æžLDAä¹‹åŽçš„æ•°æ®é›†æƒ…å†µï¼Œç»˜åˆ¶LDAé™ç»´ä¹‹åŽçš„æ•°æ®é›†ï¼š 123456789101112def plot_LDA(converted_X, y): fig = plt.figure() ax = Axes3D(fig) colors = &apos;rgb&apos; markers = &apos;o*s&apos; for target, color, marker in zip([0, 1, 2], colors, markers): pos = (y == target).ravel() X = converted_X[pos, :] ax.scatter(X[:, 0], X[:, 1], X[:, 2], color=color, marker=marker, label=&quot;Label %d&quot; % target) ax.legend(loc=&quot;best&quot;) fig.suptitle(&quot;Iris After LDA&quot;) plt.show() è°ƒç”¨ï¼š 1234567X_train, X_test, y_train, y_test = load_data()X = np.vstack((X_train, X_test))Y = np.vstack((y_train.reshape(y_train.size, 1), y_test.reshape(y_test.size, 1)))lda = discriminant_analysis.LinearDiscriminantAnalysis()lda.fit(X, Y)converted_X = np.dot(X, np.transpose(lda.coef_)) + lda.intercept_plot_LDA(converted_X, Y) ç»“æžœå¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°ç»è¿‡çº¿æ€§åˆ¤åˆ«åˆ†æžåŽï¼Œä¸åŒç§ç±»çš„é¸¢å°¾èŠ±ä¹‹é—´çš„é—´éš”è¾ƒè¿œï¼Œç›¸åŒç§ç±»çš„é¸¢å°¾èŠ±ä¹‹é—´å·²ç»ç›¸äº’èšé›†ã€‚ æŽ¥ä¸‹æ¥è€ƒå¯Ÿä¸åŒçš„solverå¯¹é¢„æµ‹æ€§èƒ½çš„å½±å“ï¼š 12345678910def demo_LinearDiscriminantAnalysis_solver(*data): X_train, X_test, y_train, y_test = data solvers = [&apos;svd&apos;, &apos;lsqr&apos;, &apos;eigen&apos;] for solver in solvers: if solver == &apos;svd&apos;: lda = discriminant_analysis.LinearDiscriminantAnalysis(solver=solver) else: lda = discriminant_analysis.LinearDiscriminantAnalysis(solver=solver, shrinkage=None) lda.fit(X_train, y_train) print(&apos;Score at solver = %s: %.2f&apos; % (solver, lda.score(X_test, y_test))) ç»“æžœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºä¸‰è€…æ²¡æœ‰å·®åˆ«ï¼š 1234runfile(&apos;/Users/rian/Evil/LEARN/AI/blog/linear model/LinearDiscriminantAnalysis.py&apos;, wdir=&apos;/Users/rian/Evil/LEARN/AI/blog/linear model&apos;)Score at solver = svd: 1.00Score at solver = lsqr: 1.00Score at solver = eigen: 1.00 æœ€åŽè€ƒå¯Ÿä¸­solver=lsqrä¸­å¼•å…¥æŠ–åŠ¨(ç›¸å½“äºŽå¼•å…¥æ­£åˆ™åŒ–é¡¹)ï¼š 1234567891011121314151617def demo_LinearDiscriminantAnalysis_shrinkage(*data): X_train, X_test, y_train, y_test = data shrinkages = np.linspace(0.0, 1.0, num=20) scores = [] for shrinkage in shrinkages: lda = discriminant_analysis.LinearDiscriminantAnalysis(solver=&apos;lsqr&apos;, shrinkage=shrinkage) lda.fit(X_train, y_train) scores.append(lda.score(X_test, y_test)) # ç»˜å›¾ fig = plt.figure() ax = fig.add_subplot(1, 1, 1) ax.plot(shrinkages, scores) ax.set_xlabel(r&quot;shrinkage&quot;) ax.set_ylabel(r&quot;score&quot;) ax.set_ylim(0, 1.05) ax.set_title(&quot;LinearDiscriminantAnalysis&quot;) plt.show() ç»“æžœï¼š å¯ä»¥å‘çŽ°éšç€shrinkageçš„å¢žå¤§ï¼Œæ¨¡åž‹çš„å‡†ç¡®çŽ‡ä¼šéšä¹‹ä¸‹é™]]></content>
      <categories>
        <category>Machine Learning</category>
      </categories>
      <tags>
        <tag>machine learning</tag>
        <tag>linear model</tag>
        <tag>python</tag>
        <tag>sklearn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[My blog building experience]]></title>
    <url>%2F2019%2F07%2F19%2FMy-blog-building-experience%2F</url>
    <content type="text"><![CDATA[It's my first time to build a blog, maybe my experience can help the green hands. Operation System: macOS 2019.7.19 update, Github+hexo preparatory work install git download URL: https://git-scm.com/download After installing git successfully, we need to bind git and our Github account. open iTerm set the configuration information 12git config --global user.name &quot;name&quot;git config --global user.email &quot;email&quot; create ssh key file (the email should be the same as one above), copy the content of id_rsa.pub 1ssh-keygen -t rsa -C &quot;email&quot; open https://github.com/settings/keys, new ssh key. Paste the content of id_rsa.pub into the key, and then click "add ssh key". check Github public key, open iTerm 1ssh git@github.com install node.js download url: https://nodejs.org/en/download/ install hexo Hexo is the framework of our blog site. 1npm install -g hexo-cli build a blog build locally create a new folder named "blog" generate a hexo template 12cd bloghexo init run hexo server, we can see the blog have been built successfully through localhost:4000 link blog to Github create a new project named "github_name.github.io" open _config.yml, update deploy 1234deploy: type: git repository: https://github.com/github_name/github_name.github.io.git branch: master install plugin npm install hexo-deployer-git --save generate static files locally hexo g push to Github 1hexo d now we can visit https://github_name.github.io update blog content update article run hexo new "my first blog", then we can find a .md file in the source/_posts folder edit the file (Markdown) push to Github 123hexo cleanhexo ghexo d add menu edit /theme/XXX/_config.yml, find "menu:", add the menu you want add pages 1hexo new pages &quot;menu_name&quot; add pictures in the article create a folder, "/theme/XXX/source/upload_image", and save the pictures here 1![](/upload_image/a.jpg)]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>hexo</tag>
        <tag>Github</tag>
      </tags>
  </entry>
</search>
